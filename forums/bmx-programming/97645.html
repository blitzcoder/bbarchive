<!DOCTYPE html><html lang="en" ><head ><title >D3D11Max2DDriver() - Part II</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >D3D11Max2DDriver() - Part II</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >D3D11Max2DDriver() - Part II</a><br><br>
<a name="1135783"></a>

<a name="1135788"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzSupport</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Continued from <a href="/posts.php?topic=96014" target="_blank">here</a>.<br><br><div class="quote"> <br>From <a href="/Account/showuser.php?id=2227" target="_blank">col</a>:<br><i>Presenting a Direct3D11 driver for Max2D.</i><br> <br></div><br><br>From last thread...<br><br><div class="quote"> <br><i><br>It may be a quirk with Intel cards being really fussy with Dx initialisation. In this update I've also exposed a new function for testing only that should not be NULL after SetGraphicsDriver command even if the driver isn't initialised you should still get some value returned...<br><br>D3D11GetFeatureLevel()<br><br>If you have problems the values return by that command relate to consts defined in d3dcommon.bmx :-<br><br>Const D3D_FEATURE_LEVEL_9_1	= $9100<br>Const D3D_FEATURE_LEVEL_9_2	= $9200<br>Const D3D_FEATURE_LEVEL_9_3	= $9300<br>Const D3D_FEATURE_LEVEL_10_0	= $a000<br>Const D3D_FEATURE_LEVEL_10_1	= $a100<br>Const D3D_FEATURE_LEVEL_11_0	= $b000<br><br>The driver will only initialise if the value of D3D11FeatureLevel() is the value of D3D_FEATURE_LEVEL_10_0 or greater. The same process was used in previous versions except I've just exposed this function to help bug hunting.<br></i><br> <br></div><br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1136166"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Richard Betson</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Part two. . . the saga continues. :) D3D11Max2DDriver()!!! <br><br></td></tr></table><br>
<a name="1136429"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey Rich,<br><br>How did you get on with that testing of the Intel GPU - Dx10.1?? <br><br></td></tr></table><br>
<a name="1136440"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Richard Betson</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Dave,<br><br>No, I have not been able to reach the guy with the system. But I am planing on releasing a new version of my game Sunday and the D3D11Max2DDriver() (newest version) should get tested on several types of systems then. <br><br>I will let you know.<br><br>BTW, Thanks for this great driver! And so anyone searching who finds this thread first the D3D11Max2DDriver() is available here:<br><br><a href="https://github.com/SRSSoftware/d3d11max2d.mod" target="_blank">https://github.com/SRSSoftware/d3d11max2d.mod</a><br><br>- Rich - <br><br></td></tr></table><br>
<a name="1136752"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Richard Betson</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Dave,<br><br>It will be another week (maybe sooner) before I get the next version of my game out. I am coding a server (using client prediction model) and aside from the math/physics is quite challenging.<br><br>I let ya know as soon as it's up and report the D3D11Max2DDriver()'s performance among users.<br><br>- Rich - <br><br></td></tr></table><br>
<a name="1136801"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Cool :-)<br><br>Looking forward to seeing the newer version. <br><br></td></tr></table><br>
<a name="1138173"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Richard Betson</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Dave,<br><br>I have a working server up and a new client posted using your driver. No complaints so far. :) <br><br>Phoenix SS client:<br><a href="http://www.subspace.co/topic/26399-server-up-download-the-new-phoenix-ss-client-and-come-test/" target="_blank">http://www.subspace.co/topic/26399-server-up-download-the-new-phoenix-ss-client-and-come-test/</a><br><br>- Rich - <br><br></td></tr></table><br>
<a name="1138687"></a>

<a name="1138688"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Richard Betson</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Dave,<br><br>Looks good. I did not have any complaints about graphics drivers or related problems. Which is good for both of us. :D<br><br>BTW, to be clear I am using your latest driver. ;)<br><br>Thanks,<br><br>- Rich -<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1138733"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hiya Rich,<br><br>That's cool its working out great :-)<br>I posted in your other thread about trying out the newer version of your game.<br><br>All great so far :D <br><br></td></tr></table><br>
<a name="1140666"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Richard Betson</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Dave,<br><br>Do you have any example code on using shadows and the other features in your D3D11Max2DDriver()?<br><br>Thanks,<br>- Rich - <br><br></td></tr></table><br>
<a name="1140737"></a>

<a name="1140739"></a>

<a name="1140742"></a>

<a name="1140743"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hiya Rich!<br><br>Lights and shadows are still very much in an alpha experimental stage. However, I do have a small example, a tech demo, that you can play with. But I won't be able to iron out the bugs just yet as I'm working hard on a GUI, but hey, feel free to have a play! :D<br><br><br>Some setup:-<br>In the d3d11max2D.bmx file, uncomment lines 19,20,21 then Rebuild Modules.<br>Download <a href="http://i1176.photobucket.com/albums/x339/automagician01/test.png" target="_blank"><b>this .png test pic</b></a> and place it the same folder as this code :-<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Strict
Import SRS.D3D11Max2D
AppTitle = "BlitzMax Dx11 Dynamic 2D Shadows"

SetGraphicsDriver D3D11Max2DDriver()

Graphics 800,600

HideMouse

Global Image:TImage = LoadImage("test.png")

Global SImage:TShadowImage = CreateShadowImage(600,600) 'Shadow image dimensions

Global fps
Global fpscounter
Global time = MilliSecs()
Global DebugImage

Global ang#
While Not KeyDown(KEY_ESCAPE)
	Cls
	
	fpscounter :+ 1
	If  MilliSecs()-time &gt; 1000
		fps = fpscounter
		fpscounter = 0
		time = MilliSecs()
	EndIf
	
	SetBlend alphablend
	
	'Clear the shadow image
	ClearShadowImage(SImage)
	
	'Position the centre of the shadow to the mouse
	SetShadowImage(SImage,MouseX()-300,MouseY()-300)
	
	'Any non alpha pixels from the standard TImage will be shadow castors
	DrawShadowCaster(SImage,Image,0,0)
	BuildShadowImage(SImage)
	
	'Set drawing to standard max2d backbuffer
	UnSetShadowImage(SImage)
	
	'Set the light colour
	SetBlend lightblend
	SetColor 255,0,0
	DrawShadowImage(SImage)

	'Draw the shadow image
	SetColor 255,255,255
	DrawImage Image,0,0		
	DrawText fps,0,0

	Flip 0
Wend

DestroyShadowImage(SImage)

End
</textarea><br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1140751"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Richard Betson</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Dave,<br><br>Great. Will play around with it. GUI? :)<br><br>Thanks,<br>- Rich - <br><br></td></tr></table><br>
<a name="1140752"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>GUI? :)<br> <br></div><br><br>Uh huh ;-)<br><br>It can co-exist with MaxGUI so you can either mix them or use one or the other. Its a native alternative for Vista-sp2 / Win7.<br><br>I've also started working on a multi-thread version of the D3D11 driver that will remain 100% compatible with existing code, a complete rewrite, tidier code, introduction of new bugs :D<br><br>GUI first though ;-) <br><br></td></tr></table><br>
<a name="1140754"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Richard Betson</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wow,<br><br>All good stuff, can't wait. :)<br><br>- Rich - <br><br></td></tr></table><br>
<a name="1147356"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br><br>Does the D3D11Max2DDriver fully support alpha transparency yet?<br>When using the driver along with maxgui it doesn't seem to work.<br><br>Have uploaded a small example code and exe files that show the issue.<br><a href="http://193.218.154.87/~knot/prp/dx11.zip" target="_blank">http://193.218.154.87/~knot/prp/dx11.zip</a><br><br>Would be great if someone could look into this.<br><br>Grisu <br><br></td></tr></table><br>
<a name="1147357"></a>

<a name="1147358"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey Dave, just noticed your sig: -- Get your BMax DirectX10/11 Max2DDriver here! -- <br><br>And that link goes to the github for d2d11max2d... so I guess that includes DX10 too?<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1147361"></a>

<a name="1147362"></a>

<a name="1147364"></a>

<a name="1147365"></a>

<a name="1147366"></a>

<a name="1147379"></a>

<a name="1147707"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hiya,<br><br>Thanks for finding this bug.<br>I've fixed this 2 hours ago, getting seriously p***** off with git and GitHub :(<br><br>Its now deleted the files I've uploaded, so I'm off for an hour to cool off, and try again in a while.<br><br>@therevills<br>Hiya, yes, Dx10 support is built into the same driver. It automatically picks up if Dx11 isnt available and will fallback to Dx10 while still using the Dx11 drivers.<br><br>EDITED EDIT:-<br>Removed source code. Please use the link in my sig. Thanks.<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1147368"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Getting a new error when compiling the latest version:<br><img src="http://s12.postimage.org/8kr9cevvx/bug_dx.png"><br><br>Modules rebuild fine though. OS Win7 64 Bit, ATI 6850 card.<br><br>In addition could you add a fallback to dx 9 as well? <br>Means dx11 -&gt; dx10 -&gt; dx9 (last stand :) ).<br><br>Grisu<br><br>P.S. The two file posted above are not included when you download the module from the main site. <br><br></td></tr></table><br>
<a name="1147375"></a>

<a name="1147378"></a>

<a name="1147380"></a>

<a name="1147571"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm going to find an alternative to Git. I just don't get the concept of how it works, and I up getting annoyed at the extreme UN-intuitiveness behind it all. The slightest update just causes nothing but aggravation for me every single time.<br><br>For the time being the complete working D3D11Max2DDriver module can be downloaded from :-<br><br>*Please use the link in my sig*<br><br><div class="quote"> <br>In addition could you add a fallback to dx 9 as well? <br>Means dx11 -&gt; dx10 -&gt; dx9 (last stand :) ).<br> <br></div><br>Blizmax already has a Dx9 driver ;-)<br><br><div class="quote"> <br>P.S. The two file posted above are not included when you download the module from the main site.<br> <br></div><br>Yes, that's why I posted them here.<br><br>I'm just not dancing in step with Git/Github. I don't understand the methodologies behind it all. I don't understand how the files get deleted when they are supposed to be updated. Also the error you have with 'Return' doesn't even exist in the copy of the exact same file i had posted ( now removed ) above. So clearly I'm missing the boat when it comes to using Git :/<br><br><font class="tiny">Last edited 2012</font><br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1147394"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks a lot, Dave! Works perfecty now.<br><br>For the fallback: Is there a more elegant way to use the newest dx version available on the system?<br> <br><pre class=code>
If D3D11Max2DDriver() Then
    SetGraphicsDriver D3D11Max2DDriver()
    DebugLog "Using DX 11/10!"
Else 
   SetGraphicsDriver D3D9Max2DDriver()
   DebugLog "Using DX 9"
End If
</pre> <br><br></td></tr></table><br>
<a name="1147402"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hiya,<br><br>You could do something along the lines of<br><br><pre class=code>
Strict

Import SRS.D3D11Max2D

Global D3DDriver:TGraphicsDriver

D3DDriver = D3D11Max2DDriver()
If Not D3DDriver D3DDriver = D3D9Max2DDriver()

SetGraphicsDriver D3DDriver

DebugLog GetGraphicsDriver().ToString()
</pre> <br><br></td></tr></table><br>
<a name="1147451"></a>

<a name="1147544"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> So that code above checks DX11, then DX10 and if neither are found it sets it to DX9?<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1147466"></a>

<a name="1147470"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hiya therevills,<br><br>Yes it does exactly that.<br><br>Just to clarify with some details :-<br><br>The D3D11Max2DDriver MUST have DirectX11 installed on the system if you want to support Dx11 or Dx10 cards.<br><br>Internally, in the D3D11Max2DDriver initialization stage, it checks if DirectX11 is installed and checks if its up to date. If that check passes it then checks if the gpu card is Dx11 compatible, if not, it then checks to see if the gpu card is Dx10 compatible. So, providing that DirectX11 is installed, and either the card is first Dx11 then Dx10 compatible, then it will complete the initialization and return a valid TGraphicsDriver from the D3D11Max2DDriver() function ( using either Dx11 or Dx10 as appropriate ), otherwise Null is returned from the D3D11Max2DDriver() function.<br><br><br>So bearing in mind the previous paragraph...<br><br>The code above sets our own D3DDriver:TGraphicsDriver variable to the result of the D3D11Max2DDriver() function. If the variable is Null ( which means either Dx11 isnt installed or the gpu card doesnt support Dx11 or Dx10 ), then it sets the D3DDriver variable to the result of D3D9Max2DDriver() function, which nowadays on a windows pc will usually return valid anyway ( but never take anything for granted ). It then uses the D3DDriver variable with SetGraphicsDriver.<br><br>Hope this helps :-)<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1147478"></a>

<a name="1147484"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> How can one determine which dx driver (11 or 10) is actually in use?<br>Can I read out that somewhere?<br><br>Your code states "DirectX11 - Using DirectX 10.1" on my system, but it should be dx11?<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1147483"></a>

<a name="1147485"></a>

<a name="1147486"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes,<br><br>You can use <b>GetGraphicsDriver.ToString()</b><br><br>The D3D11Max2DDriver will output one of the following :-<br><br><b>DirectX11 - Using DirectX 10.0<br>DirectX11 - Using DirectX 10.1<br>DirectX11 - Using DirectX 11.0<br>DirectX11 - 11.1</b><br><br>depending on the capabilities of the gpu card.<br><br>EDIT :- Or you can use a debugging function that will tell you the capabilities of the gpu, bear in mind only level 10_0 upwards is supported by this driver:-<br><br><b>D3D11GetFeatureLevel()</b><br><br>to get a return value which will equate to the following :-<br><br><b>$9100 = D3D_FEATURE_LEVEL_9_1<br>$9200 = D3D_FEATURE_LEVEL_9_2<br>$9300 = D3D_FEATURE_LEVEL_9_3<br>$a000 = D3D_FEATURE_LEVEL_10_0<br>$a100 = D3D_FEATURE_LEVEL_10_1<br>$b000 = D3D_FEATURE_LEVEL_11_0<br>$b100 = D3D_FEATURE_LEVEL_11_1</b><br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1147488"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>Your code states "DirectX11 - Using DirectX 10.1" on my system, but it should be dx11? <br></div><br><br>What gpu card and gpu drivers are you using? <br><br></td></tr></table><br>
<a name="1147489"></a>

<a name="1149054"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> AMD Sapphire 6850 Toxic with the latest stable drivers, i.e 12.6.<br><br>Dx 11 is properly installed:<br>(deleted)<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1147490"></a>

<a name="1147491"></a>

<a name="1147492"></a>

<a name="1147494"></a>

<a name="1147495"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> On DxDiag, click on the 'Display' tab, the gpu details are in the 'Device' panel, top left. Could you post those please? and also the driver details at the top right.<br><br>Cheers.<br><br>no worries, just saw the data in your post.<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1147493"></a>

<a name="1149053"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here ya go:<br>(deleted)<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1147496"></a>

<a name="1147497"></a>

<a name="1147498"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yep, it should be initializing to Dx11.<br><br>I'll look into this. What value do you get returned using the D3DFeatureLevel() function after using SetGraphicsDriver? Do you have an on-motherboard gpu?<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1147499"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#31">[#31]</a></td></tr></table></td></tr><tr ><td class="posttext"> "$a100", no motherboard or cpu with gpu only the one mentioned above. <br><br></td></tr></table><br>
<a name="1147509"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#32">[#32]</a></td></tr></table></td></tr><tr ><td class="posttext"> Would you mind to post the output from this basic test code? :-<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Import SRS.D3D11Max2D


Global pD3DDevice:ID3D11Device
Global pD3DDeviceContext:ID3D11DeviceContext
Global FeatureLevel
Global hr

hr = D3D11CreateDevice(	Null,..
						D3D_DRIVER_TYPE_HARDWARE,..
						Null,..
						D3D11_CREATE_DEVICE_SINGLETHREADED,..
						Null,..
						0,..
						D3D11_SDK_VERSION,..
						pD3DDevice,..
						Varptr FeatureLevel,..
						pD3DDeviceContext)

Print "HRESULT: ("+Hex(hr)+")"
Print "D3D Level: ("+Hex(FeatureLevel)+")"
Print "D3D11Device: ("+Hex(Int Byte Ptr pD3DDevice)+")"
Print "D3D11DevCon: ("+Hex(Int Byte Ptr pD3DDeviceContext)+")"

If pD3DDevice pD3DDevice.Release_
If pD3DDeviceContext pD3DDeviceContext.Release_
</textarea><br><br>Cheers. <br><br></td></tr></table><br>
<a name="1147513"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#33">[#33]</a></td></tr></table></td></tr><tr ><td class="posttext"> <pre class=code>
HRESULT: (00000000)
D3D Level: (0000B000)
D3D11Device: (00AFBB68)
D3D11DevCon: (009F29A0)
Process complete
</pre> <br><br></td></tr></table><br>
<a name="1147517"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#34">[#34]</a></td></tr></table></td></tr><tr ><td class="posttext"> Cool,<br><br>Thanks for the testing, it helped a lot! I'll release an update soon. <br><br></td></tr></table><br>
<a name="1147569"></a>

<a name="1147570"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#35">[#35]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hiya,<br><br>It appears there's a bug in one of the DirectX11 functions which will incorrectly return that some valid Dx11 gpus don't support Dx11.<br><br>The bug is bypassed in the latest version.<br>The latest version will always be in my sig.<br><br>EDIT:-<br>@Forum mods, would you mind to remove the reference to the GitHub webpage in the very first post please as I won't be keeping that reference up to date, and the latest version will always be available from my sig. Thanks.<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1147664"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#36">[#36]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for fixing this stuff so quickly! <br><br></td></tr></table><br>
<a name="1147679"></a>

<a name="1147681"></a>

<a name="1148094"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#37">[#37]</a></td></tr></table></td></tr><tr ><td class="posttext"> You're welcome.<br><br>We can't have a broken driver eh.<br><br>Before we consider this as a permanent fix could you post the result of this little piece of code please :-<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Strict

Import SRS.D3D11Max2D

Global Factory:IDXGIFactory
Global Adapter:IDXGIAdapter
Global AdapterList:TList
Global Index

Type TAdapter
	Field _Index
	Field _Adapter:IDXGIAdapter
	Field _D3DLevel$
	Field _Desc:DXGI_ADAPTER_DESC
	
	Method Create:TAdapter(Index,Adapter:IDXGIAdapter)
		_Index = Index
		_Adapter = Adapter
		
		_D3DLevel = "D3D_FEATURE_LEVEL_11_0"
		If _Adapter.CheckInterfaceSupport(IID_ID3D11DEVICE,Null)&lt;0
			_D3DLevel = "D3D_FEATURE_LEVEL_10_1"
			If _Adapter.CheckInterfaceSupport(IID_ID3D10DEVICE1,Null)&lt;0
				_D3DLevel = "D3D_FEATURE_LEVEL_10_0"
				If _Adapter.CheckInterfaceSupport(IID_ID3D10DEVICE,Null)&lt;0
					_D3DLevel = "0"
				EndIf
			EndIf
		EndIf
		
		_Desc = New DXGI_ADAPTER_DESC
		_Adapter.GetDesc( _Desc )
		
		Return Self
	EndMethod
	
	Method DisplayDetails()
		Print "Adapter Index : " + _Index
		Print "~tName : " + _Desc.Description()
		Print "~tLevel : " + _D3DLevel
	EndMethod
	
	Method Destroy()
		_Adapter.Release_
		_Adapter = Null
	EndMethod
EndType


'Start
AdapterList = CreateList()

WriteStdout "~nCreateDXGIFactory() : "	
If CreateDXGIFactory(IID_IDXGIFactory,Factory)&lt;0
	WriteStdout "Error creating IDXGIFactory!~n"; End
Else
	WriteStdout "Factory created OK~n"
EndIf

WriteStdout "Querying all adapters : "
While Factory.EnumAdapters(Index,Adapter) &gt;= 0
	ListAddLast(AdapterList,New TAdapter.Create(Index,Adapter))
	Index :+ 1
Wend
WriteStdout " Found " + Index + " Adapter(s)~n~n"

For Local Adapters:TAdapter = EachIn AdapterList
	Adapters.DisplayDetails
	Adapters.Destroy
Next

If Factory Factory.Release_
</textarea><br><br>Thanks.<br><br><font class="tiny">Last edited 2012</font><br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1147682"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#38">[#38]</a></td></tr></table></td></tr><tr ><td class="posttext"> <pre class=code>
CreateDXGIFactory() : Factory created OK
Querying all adapters :  Found 1 Adapter(s)

Adapter Index : 1
	Name : AMD Radeon HD 6800 Series
	Level : D3D_FEATURE_LEVEL_10_1
Process complete
</pre><br><br>Awk, still stating Dx10.1, my card may be broken... :) <br><br></td></tr></table><br>
<a name="1147684"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#39">[#39]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>Awk, still stating Dx10.1, my card may be broken... :)<br> <br></div><br><br>Nah, but you have proved its a bug within DirectX11. Maybe a driver issue but it doubt it very much.<br><br>It reports ok when using the code in <a href="/posts.php?topic=97645#1147402" target="_blank">Post #21</a> with the latest version yes? <br><br></td></tr></table><br>
<a name="1147689"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#40">[#40]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, it does. <br><br></td></tr></table><br>
<a name="1147690"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#41">[#41]</a></td></tr></table></td></tr><tr ><td class="posttext"> Excellent stuff.<br><br>Thats the one that really matters.<br><br>Thankyou for your help :) <br><br></td></tr></table><br>
<a name="1147812"></a>

<a name="1147813"></a>

<a name="1147814"></a>

<a name="1147841"></a>

<a name="1147844"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#42">[#42]</a></td></tr></table></td></tr><tr ><td class="posttext"> D3Dcommon.bmx lacks the CONST "D3D_FEATURE_LEVEL_11_1=$b100". Did u miss that?<br><br>Could you please add a function to return a simple string/int for which gfx driver is currently in use, like:<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Global D3DDriverString:String=""
Global D3DDriver:TGraphicsDriver

D3DDriver = D3D11Max2DDriver()
If Not D3DDriver Then D3DDriver = D3D9Max2DDriver()
If Not D3DDriver Then D3DDriver = GLMax2DDriver()

SetGraphicsDriver D3DDriver

D3DDriverString=GetGraphicsDriver().ToString()
Select D3DDriverString
Case "DirectX11 - Using DirectX 10.0"
	D3DDriverString="Dx10.0"
Case "DirectX11 - Using DirectX 10.1"
	D3DDriverString="Dx10.1"
Case "DirectX11 - Using DirectX 11.0"
	D3DDriverString="Dx11.0"
Case "DirectX11 - 11.1"
	D3DDriverString="Dx11.1"
Case "DirectX9"
	D3DDriverString="Dx9.0"
Case "OpenGL"
	D3DDriverString="OpenGL"
End Select 

Print D3DDriverString 
</textarea><br><br>It would help quite a bit. As the code above seems not to be very efficient.<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1147816"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hotshot2005</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#43">[#43]</a></td></tr></table></td></tr><tr ><td class="posttext"> What does this really mean when person have Direct x 11 code in Blitz Max?<br><br>Does it mean open graphics direct x 11 possibly? <br><br></td></tr></table><br>
<a name="1147865"></a>

<a name="1147888"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#44">[#44]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>D3Dcommon.bmx lacks the CONST "D3D_FEATURE_LEVEL_11_1=$b100". Did u miss that?<br> <br></div><br>Oops :D Yes, I didn't bother with it at the time of writing the driver as Win8 wasn't quite out and I forgot all about it once Win8 was released. Just for record Dx11.1 is Win8 only at the moment and I can't see MS updating Win7 support just yet. Thanks for the heads up and they will be included for the next release.<br><br><div class="quote"> <br>Could you please add a function to return a simple string/int for which gfx driver is currently in use<br> <br></div><br>Due to the nature of how Max2D works, which is to allow easy swap in and out of the graphics drivers, it's not feasible for me to write that. You could modify the Max2D source to suit your own needs, but bear in mind that any updates that BRL release will overwrite your modifications.<br><br><div class="quote"> <br>Does it mean open graphics direct x 11 possibly?<br> <br></div><br>Yep . Certainly does. You have full access to the 3D interface, but there is only 95% of Dx11 ported - I didn't port over the D3D11Effects framework and there are a few structures and constants that I didn't need to write that wouldn't take no more than 20mins at most. The Effects code would take a lot longer and you don't really need it anyway, its a convenience framework thats wrapped around the native code. I only did that amount as it is already way more than enough to support Max2D.<br><br>What were you thinking of doing with it? I've written the Dx11 code so that you can pretty much use the MSDN for reference. If you'd like some help understanding how to use it separately from Max2D, maybe for 3D work, I'd gladly help out, however it may be better to start another thread as it would be off topic for this one.<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1148156"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#45">[#45]</a></td></tr></table></td></tr><tr ><td class="posttext"> So far your driver works fine under Dx11 (Win7) and Dx9 (XP).<br>Just testing it for a new relase of my app: <a href="http://193.218.154.87/~knot/prp/prp_tech.zip" target="_blank">http://193.218.154.87/~knot/prp/prp_tech.zip</a><br><br>I'm sure I will find more bugs somewhere... ;) <br><br></td></tr></table><br>
<a name="1148869"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Doc Holliday</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#46">[#46]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi folks,<br><br>it's a while ago, that I did my last Bmax project (about a year ago or so). Now I have a new idea for a Bmax project and I read the forum to come into Bmax again. And I found this interesting thread here about this D3D11Max2DDriver.<br><br>So I downloaded the latest release from Daves sig, put it into my mod-folder. Then I rebuilded all modules. All worked fine.<br><br>To play around with it and look how it works I copied the code from the fireworks example further above in this thread to a clear bmx-file. I added the import statement for D3D11Max2DDriver at the very top of the file and tried to compile.<br><br>Then the compiler stopped me with the following error:<br><br><i>Compile Error: Can't find interface for module 'srs.d3d11max2d'<br>Build Error: failed to compile D:/D3D11Max2D Fireworks/D3D11Max2D Fireworks/fireworks.bmx</i><br><br>I thought a while about this, but I can't figure out, what is wrong, or what I'm doing wrong ...<br><br>Maybe, someone out there can help - thank you very much :-)<br><br>Doc Holliday <br><br></td></tr></table><br>
<a name="1148880"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#47">[#47]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hiya,<br><br>First things first - making sure the file hierarchy is correct.<br><br>Does your BlitzMax/mod folder look like this -<br><br>BlitzMax/mod/srs.mod/d3d11graphics.mod/[various files]<br>BlitzMax/mod/srs.mod/d3d11max2d.mod/[various files]<br>BlitzMax/mod/srs.mod/directx11.mod/[various files] <br><br></td></tr></table><br>
<a name="1148902"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Doc Holliday</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#48">[#48]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Dave,<br><br>Thanks for the fast reply. Yes, the file hierarchy matches exactly with that in your post above. :-)<br><br>Doc Holliday <br><br></td></tr></table><br>
<a name="1148906"></a>

<a name="1148921"></a>

<a name="1148922"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#49">[#49]</a></td></tr></table></td></tr><tr ><td class="posttext"> Maybe you could  try deleting all of the .bmx folder, .i, and .a files in each of the 3 new module folders, then try rebuilding the modules again. When you get the error you have it's BlitzMax not finding the mentioned .i file, usually associated with the modules not building correctly.<br><br>I've just tried it using<br><br>MaxIDE 1.42<br>BCC 1.48<br>FASM 1.69.14<br>GCC/G++ 4.6.2<br><br>and it builds and works ok.<br><br>Due to slight changes in the driver as time has progressed the Fireworks demo needs just one line changing to account for the newer updates. There's only one line different ( the parameters for the CreateBatchImage have changed ) but I'll post the complete working source here to make it easier.<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Strict

Import SRS.D3D11Max2D

AppTitle = "D3D11Max2DDriver : DrawBatchImage"

' Fireworks originally coded by simonh (&lt;a href=\"mailto:si@si-design.co.uk\"&gt;si@...;)
' Adapted to use BatchImage rendering coded by DaveC aka Col ( &lt;a href=\"mailto:auto.magician@yahoo.co.uk\"&gt;auto.magician@...; )

Type TSpark
	Field x#,y#,z#,vy#,xd#,yd#,zd#,r#,g#,b#,alpha#	
EndType

Type TSparkBatch
	Field Batch:TBatchImage
	Field SparkList:TList
	
	Field Vert#[]
	Field Col#[]
	Field Rot#[]
	Field Sca#[]
	
	Method Create:TSparkBatch(Image:TImage)		
		'Create New BatchImage and associated data structure
		Vert = Vert[..NumSparks*2]	'X,Y
		Col = Col[..NumSparks*4]	'R,G,B,A
		Rot = Rot[..NumSparks]		'Angle in Radians!!
		Sca = Sca[..NumSparks*2]	'X Scale,Y Scale
		
		'Batch = CreateBatchImage(Image)
		Batch = CreateBatchImage(Image,True,True,True)
	
		Local x#=Rand(-100,100)
		Local y#=Rand(-100,100)
		Local z#=200

		Local r#=Rand(255)
		Local g#=Rand(255)
		Local b#=Rand(255)
		
		SparkList = New TList
		
		For Local i=0 Until NumSparks

			Local speed# = 0.1

			Local ang1# = Rnd!(360)
			Local ang2# = Rnd!(360)

			Local sp:TSpark=New TSpark
			SparkList.AddLast sp

			sp.x=x#
			sp.y=y#
			sp.z=z#

			sp.xd=Cos(ang1#)*Cos(ang2#)*speed#
			sp.yd=Cos(ang1#)*Sin(ang2#)*speed#
			sp.zd=Sin(ang1#)*speed#
	
			sp.r=r
			sp.g=g
			sp.b=b
	
			sp.alpha=1
		Next

		Return Self
	EndMethod
	
	Method Update()
		Local index
		For Local sp:TSpark=EachIn SparkList
		
			' If spark alpha is above 0 then draw it...
			If sp.alpha&gt;0

				sp.x=sp.x+sp.xd*10.0
				sp.y=sp.y+sp.yd*10.0
				sp.z=sp.z+sp.zd*10.0
				sp.y=sp.y+sp.vy#
				sp.vy=sp.vy+0.02

				' Calculate x and y draw values based on x,y,z co-ordinates
				Local x#=(width/2.0)+((sp.x/sp.z)*500)
				Local y#=(height/2.0)+((sp.y/sp.z)*500)

				sp.alpha=sp.alpha-0.01
			
				'Store spark data into the batch data
				Vert[index*2+0] = x
				Vert[index*2+1] = y
				
				Col[index*4+0] = sp.r
				Col[index*4+1] = sp.g
				Col[index*4+2] = sp.b
				Col[index*4+3] = sp.alpha
				
				If RotateSparks
					Rot[index] = Rnd(0,2*Pi)	'In Radians!!!
				EndIf
			
				Sca[index*2+0] = 20.0/sp.z
				Sca[index*2+1] = 20.0/sp.z
				
			'...else remove spark from spark list
			Else
				'As spark alpha becomes 0 we wont see it even if it goes through the render pipeline!
				'Sorry, but thats the joys of batching ;-)
				SparkList.Remove sp
			EndIf
			
			index :+ 1
		Next
		
		UpdateBatchImage(Batch,Vert,Col,Rot,Sca)
	EndMethod
	
	Method Draw()
		SetBlend LIGHTBLEND
		DrawBatchImage(Batch)
	EndMethod
	
	Method ActiveSparks()
		Return SparkList.Count()
	EndMethod
	
	Method Destroy()
		DestroyBatchImage(Batch)
		SparkList.Clear
		Vert = Null
		Col = Null
		Rot = Null
		Sca = Null
	EndMethod
EndType

''''''''''''''''''''''''''''''''''''''''''''''''''''''''
SetGraphicsDriver D3D11Max2DDriver()
Global Width = 800
Global Height = 600
Graphics Width,Height

Global NumSparks = 500
Global RotateSparks

Global SparkImage:TImage = LoadImage("spark.png")
Global SparkBatchList:TList = New TList

While Not ( KeyDown(KEY_ESCAPE) Or AppTerminate() )	
	Cls
	Local time = MilliSecs()
	If KeyHit(KEY_R)
		RotateSparks = 1 - RotateSparks
	EndIf

	If KeyDown(KEY_SPACE) And SparkBatchList.Count() &lt; 200
		For Local i=0 To 3
			Local SPB:TSparkBatch = New TSparkBatch.Create(SparkImage)
			SparkBatchList.AddLast SPB
		Next
	EndIf
	
	For Local SPB:TSparkBatch = EachIn SparkBatchList
		SPB.Update
		SPB.Draw
		
		If SPB.ActiveSparks() = 0
			SPB.Destroy
			SparkBatchList.Remove SPB
		EndIf
	Next
	
	DrawText "Hold space to ignite fireworks",0,0
	DrawText "Number of fireworks : "+SparkBatchList.Count(),0,16
	DrawText "Press R to rotate the sparks",0,32
	Flip
Wend

'MUST clean up properly when batching data!!!
For Local SPB:TSparkBatch = EachIn SparkBatchList
	SPB.Destroy
Next
</textarea><br><br>This also exposed a bug in one of the helper functions, In d3d11max2d.bmx, the function 'VerifyD3D11Max2DDriver()'. All fixed in the latest version.<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1148935"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Doc Holliday</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#50">[#50]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Dave,<br><br>I followed your advice, deleted all .bmx-folders, all .i and .a files. Then I rebuilded all modules again.<br><br>And it works! I copied the changed fireworks-code to an empty bmx-file. It compiles with no errors. Yeahhh! :-)<br><br>But now I ran into next trouble: The programm executes and pressing space counts the number of fireworks up, and a few secounds later it counts down. That's ok - but I can't see any visual fireworks in the window like in the original fireworks.exe I downloaded yesterday from this thread.<br><br>My first thought was, that the particle-image was not in the right place, but it is (it's in the same folder like the exe).<br><br>My gfx-card is a NVIDIA GTX460 - full DirectX11 compliant.<br><br>I compiled with the latest BCC 1.48<br><br>Maybe you want to test MY compiled exe on your system - you can download it here:<br><br><a href="http://www.jeknet.de/downloads/fireworks.zip" target="_blank">http://www.jeknet.de/downloads/fireworks.zip</a><br><br>Thanks a lot ...<br><br>Doc Holliday <br><br></td></tr></table><br>
<a name="1148937"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#51">[#51]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hiya,<br><br>As bugs are found, I fix them pretty much immediately and release an updated version. Try the latest version from my sig, I updated it this morning :-) <br><br></td></tr></table><br>
<a name="1148943"></a>

<a name="1148945"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#52">[#52]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br><br>same problem here: the code compiles fine, but I don't see fireworks at all.<br><br>-&gt; LoadImage("spark.png") is missing!<br><br>Grisu<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1148962"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Doc Holliday</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#53">[#53]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Dave,<br><br>whatever caused the problem - with your latest release from this morning all works fine!<br><br>Thank you very much for your great work and for the very fast help.<br><br>Have a nice day :-)<br><br>Doc Holliday <br><br></td></tr></table><br>
<a name="1148974"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#54">[#54]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Doc Holiday<br>Have fun :)<br><br>@grisu<br>This TBatchImage fireworks example is an adaption of 'simonh' original example of the same name that can be found in<br><br>BlitzMax/samples/simonh/fireworks/<br><br>It uses the media from his example. You'll find the 'spark.png' in that folder. <br><br></td></tr></table><br>
<a name="1149070"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Doc Holliday</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#55">[#55]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Dave,<br><br>it's me again. Sorry for bothering you with one more question that appears while im playing around with your gfx-driver.<br><br>When I switch to fullscreen, is it right that your driver switches to the highest available resolution and if necessary centers the screen output?<br><br>For example, I switched to 800x600 fullscreen with this lines of code:<br><br><pre class=code>SetGraphicsDriver D3D11Max2DDriver()
Graphics 800, 600, 32</pre><br><br>I see, that my 24 inch display switches to the resolution of 1920x1080 and centers the output.<br><br>Is it possible with your driver to switch to the really native resolution of for example 800x600? How to do this, if it's possible?<br><br>Thank you in advance and<br><br>have a nice day :-)<br><br>Doc Holliday <br><br></td></tr></table><br>
<a name="1149084"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TaskMaster</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#56">[#56]</a></td></tr></table></td></tr><tr ><td class="posttext"> Doc,<br><br>That is most likely your monitor doing that, and not the BlitzMax program.  Many LCDs will only go to actual modes that are direct ratios of their native resolution. <br><br></td></tr></table><br>
<a name="1149097"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Doc Holliday</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#57">[#57]</a></td></tr></table></td></tr><tr ><td class="posttext"> @TaskMaster<br><br>I had this idea too. But when I use the original max2d-driver it switches really to the native resolution (for example 800x600) and not to the max resolution the monitor is capable of.<br><br>A mystery thing? Maybe Dave can explain what happens?<br><br>Doc Holliday <br><br></td></tr></table><br>
<a name="1149105"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#58">[#58]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hiya,<br><br>I've had the same issues, after updating the gpu drivers and monitor driver it was ok. <br><br></td></tr></table><br>
<a name="1149124"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Doc Holliday</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#59">[#59]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Dave,<br><br>you are so right. I noticed that I didn't update my gpu drivers for a long while. I'am such a bad boy ;-)<br><br>Now it works right with the native resolution.<br><br>Thanks again and ...<br><br>... have a nice day :-)<br><br>Doc Holliday <br><br></td></tr></table><br>
<a name="1149130"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#60">[#60]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Dave!<br>I downloaded the latest files from your link and get a "Access Null error" with "SetBlend SolidBLEND". Did you change anything regarding this?<br><br>Grisu <br><br></td></tr></table><br>
<a name="1149134"></a>

<a name="1149138"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#61">[#61]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hiya Grisu,<br><br>No - nothing has changed in that respect for the longest time.<br>Do you have an example that reproduces it? Does it happen with other blend modes or Max2D commands?<br><br>EDIT:-<br>Oops! I left the driver in testing mode! Sorry, I've re-upped it to GitHub, but its a simple fix :<br><br>In d3d11graphics.bmx, comment out Line 114 !! and rebuild the modules.<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1149143"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#62">[#62]</a></td></tr></table></td></tr><tr ><td class="posttext"> I see everything ;) - Thanks that did it. <br><br>Could you please add some kind of overal changelog, so it's easier to track what fixes / adjustments you have made to the modules? <br><br></td></tr></table><br>
<a name="1149149"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#63">[#63]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hiya,<br><br>I've pushed the module back onto github, it keeps track of all changes there. <br><br></td></tr></table><br>
<a name="1154616"></a>

<a name="1154773"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#64">[#64]</a></td></tr></table></td></tr><tr ><td class="posttext"> Moved <a href="/posts.php?topic=98675" target="_blank">here</a>.<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1154654"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#65">[#65]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hiya,<br><br>Is that a typo with you saying Dx9 and you meant the Dx11 driver?<br>Either way, if you post or send a working example with the offending media, then I'm sure I and/or others can take a look for you.<br><br>Just to keep things all fun and equal, if it is Dx9 you meant then you would be better to start a new thread so more people will see it. <br><br></td></tr></table><br>
<a name="1154774"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#66">[#66]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have moved the topic to the bmx bug forum. It is a dx9 issue but looks the same as the one you fixed with the dx11 driver (using blend modes). So I thought you might know where to dig. <br><br></td></tr></table><br>
<a name="1156080"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Richard Betson</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#67">[#67]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Dave,<br><br>Been busy as you know. I'll get a copy of the latest DX11 driver and use it with the next release of my project. Let ya know. :) <br><br></td></tr></table><br>
<a name="1173168"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Richard Betson</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#68">[#68]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Dave,<br><br>I have not forgot about you. ;)<br><br>Going to be releasing a beta version of my project soon. Anything new? <br><br></td></tr></table><br>
<a name="1173209"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#69">[#69]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hiya Rich,<br><br>Good to hear that you're getting closer! I guess as far as the driver goes - no news is good news :)<br><br>Nothing new to 'show' just yet for the latest MT version. I'm working on the ribbon editor whenever I get free time, which is disappointingly scarce these passed couple of months. Funny thing is that I prefer coding rather than my day job :P <br><br></td></tr></table><br>
<a name="1173264"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Richard Betson</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#70">[#70]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Funny thing is that I prefer coding rather than my day job :P  <br></div><br>Don't we all. ;) <br><br></td></tr></table><br>
<a name="1182927"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#71">[#71]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've updated the driver to use the WindowsAPI so as to get all available display modes, particularly for HDTVs. Any duplicate modes are also removed. Because some TVs report some strange frequencies to be available it may be a good idea to filter them to 50/60hz. I've left that for the programmer to decide whether to filter or not. <br><br></td></tr></table><br>
<a name="1182973"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#72">[#72]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the update! <br><br></td></tr></table><br>
<a name="1183903"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Richard Betson</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#73">[#73]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Dave,<br><br>I'll have a new version of my project out to soon. I'll report back as I  have a few beta testers that have the HD TV setup. Thank's for the fix. So cool of you to update this. :D<br><br>You Rock,<br>- Rich - <br><br></td></tr></table><br>
<a name="1187245"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Richard Betson</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#74">[#74]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Dave,<br><br>All good so far. The one users I have with an HD display and DX11 has gone MIA for the moment. So as soon as he gets back I let you know how it works. But all good so far. ;)<br><br>Thanks, <br><br></td></tr></table><br>
<a name="1187298"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#75">[#75]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Rich,<br><br>For me... no news is good news ;)<br><br>The game is starting to look really cool and polished with the light effects. Excellent! <br><br></td></tr></table><br>
<a name="1202880"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#76">[#76]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wil you add some stuff to support DX 11.2 features as well? <br><br></td></tr></table><br>
<a name="1203157"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#77">[#77]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hiya Grisu,<br><br>What features from 1.2 would you like? <br><br></td></tr></table><br>
<a name="1203262"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#78">[#78]</a></td></tr></table></td></tr><tr ><td class="posttext"> It would be nice if the module could detect future Dx 11.2 cards via GetGraphicsDriver() and make use of any speed improvements that might have been done to the normal functions.<br><br>I'm no Dx guru, the functions added with Dx 11.2 should be overkill for the average bmx user: <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/dn312084%28v=vs.85%29.aspx" target="_blank">http://msdn.microsoft.com/en-us/library/windows/desktop/dn312084%28v=vs.85%29.aspx</a> <br><br></td></tr></table><br>
<a name="1203816"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Richard Betson</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#79">[#79]</a></td></tr></table></td></tr><tr ><td class="posttext"> I so love this module :D<br><br><div class="quote"> make use of any speed improvements that might have been done to the normal functions <br></div><br><br>Tiled resources looks interesting especially if it can handle rotation. Speed improvement?<br><br>- Rich - <br><br></td></tr></table><br>
<a name="1205254"></a>

<a name="1205255"></a>

<a name="1205256"></a>

<a name="1205257"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#80">[#80]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hello Dave,<br><br>I think that I found glitch with your module. Recently my AMD gfx-card (6850) died and I had to replace it via my old NVidia one (8800gts).<br> <br>When running my radio player app, I get different results from Dx 10 (=maximum the old card supports).<br><br>The left screenshot shows, that the logo is misplaced by 1,1 pixels (Black border line missing). When I force OpenGL it looks normal again, like you see on the right screenshot:<br><img src="http://s24.postimg.org/xo66bxmol/error.png"><br><br>Do you have any idea what might cause this? <br>Can someone else please confirm this issue by testing it on an AMD or NV card please?<br><br>Cheers!<br>Grisu <br><br></td></tr></table><br>
<a name="1205258"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#81">[#81]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Can someone else please confirm this issue by testing it on an AMD or NV card please? <br></div><br><br>When I run pocket radio player 310313 on my PC (Radeon HD 6750) the screen looks like your right-hand screenshot.<br>(No idea what graphics drivers it's using, though) <br><br></td></tr></table><br>
<a name="1205264"></a>

<a name="1205265"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#82">[#82]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the report. So this seems to be NVidia related.<br><br>You can check the driver used via the about window. PRP will use the latest directx drivers supported on windows systems. In the screenshot below "Dx 10" stands for "DirectX 10". Apart from that you can force the usage of OpenGL via the options menu (restart needed!).  <br><br><img src="http://s14.postimg.org/ocauolx29/KTam_instr.png"><br><br>P.S.: The internal updater only checks for new radio stations and not app updates. The Frankenstein build is the current Halloween release... :) <br><br></td></tr></table><br>
<a name="1205276"></a>

<a name="1205277"></a>

<a name="1205278"></a>

<a name="1205279"></a>

<a name="1205280"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#83">[#83]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hiya Grisu,xlsior<br><br>I can also confirm that the image is correctly placed on a Radeon card, but it's 1 pixel right and 1 down on an NVidia card. I've just tested it on 2 laptops with appropriate gpus running the exact same version of your player.<br><br>Tested with Radeon 3400 and Geforce GT650.<br><br>Edit: On the newer laptop with the Geforce - it has 2 gpus inside - a basic Radeon and the NVidia, I can select which gpu I want the app to use and the same problems still exists. Weirdest bug ever! <br><br></td></tr></table><br>
<a name="1205284"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#84">[#84]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is a pic of your app using the 2 different gpus on the one laptop at the same time.<br><br>The left image is using the NVidia gpu, the right hand side is using the Radeon gpu.<br><img src="http://s14.postimg.org/8l6zg6ftt/pic.jpg"> <br><br></td></tr></table><br>
<a name="1205289"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#85">[#85]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Grisu...<br><br>How are you creating/display the image/pixmap? I'm trying to reproduce the same effect on this machine and I can't do it at all. <br><br></td></tr></table><br>
<a name="1205297"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#86">[#86]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's just a simple Drawimage command. If I use -1,-1 as coordinates it works fine.<br><br>Some code snippets.<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
...
  pix:TPixmap=LockImage(Spec_BackgroundIMG)
  pix=ResizePixmap(pix,274,87)
  UnlockImage(Spec_BackgroundIMG)		
  Spec_BackgroundIMG = LoadImage(pix , Null)
     
If Spec_BackgroundIMG &lt;&gt; Null Then 
         SetGraphics CanvasGraphics( RadioStationCanvas ) ' refresh main station canvas                                                
           SetBlend SOLIDBLEND
           SetColor 255,255,255  
           DrawImage Spec_BackgroundIMG , 0 , 0
	   Flip 0
'Else
'Print "NO LOGO HERE???!"	
EndIf
...
</textarea><br><br>When needed, I will try to dig up a complete example code later.<br><br>Thanks a lot for looking into this. <br><br></td></tr></table><br>
<a name="1205300"></a>

<a name="1205301"></a>

<a name="1205302"></a>

<a name="1205303"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#87">[#87]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is a full example code. It reproduces the glitch for me:<br><br><b>Bug Example:</b><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
SuperStrict 

Framework Maxgui.Drivers
Import MaxGui.Drivers
Import Maxgui.ProxyGadgets
Import Brl.EventQueue
Import Brl.Timer     
Import Brl.Pixmap  
Import Brl.Pngloader
Import Brl.Jpgloader

Import SRS.D3D11Max2D
Import BRL.D3D9Max2D
Import BRL.GLGraphics
Import BRL.GLMax2D
	
Const MAINWINDOW_W:Int = 278 
Const MAINWINDOW_H:Int = 154
Const Buttonsize: Int = 32
Const BUTTON_ACTION:Int = EVENT_GADGETACTION

Global ini_force_opengl:int=0

Init_DX_Driver() ' Set Up the GFX driver

Global SpectrumTimer:TTimer=CreateTimer(30) ' Used for the spectrum analyser!
Global Spec_BackgroundIMG:TImage=LoadImage("data/prp_noico.png",Null)

Local Style:Int = WINDOW_TITLEBAR | WINDOW_CLIENTCOORDS | WINDOW_CENTER | WINDOW_ACCEPTFILES | WINDOW_RESIZABLE
Global MainWindow:TGadget  = CreateWindow("Logo Image Test Code" , 0 , 0 , MAINWINDOW_W , MAINWINDOW_H , Null , Style)
SetMinWindowSize(MainWindow,MAINWINDOW_W,MAINWINDOW_H)
SetMaxWindowSize(MainWindow,MAINWINDOW_W,DesktopHeight())

Global MainPanel:TGadget = CreatePanel(0 , 0 , MAINWINDOW_W , MAINWINDOW_H , MainWindow )
SetGadgetLayout MainPanel , EDGE_ALIGNED , EDGE_ALIGNED , EDGE_ALIGNED , EDGE_ALIGNED

Global RadioStationCanvas:TGadget = CreateCanvas(2, MAINWINDOW_H - 100-19 , 274 , 87 , MainPanel )', PANEL_ACTIVE) '110
SetGadgetLayout RadioStationCanvas, Null, Null, EDGE_ALIGNED, Null

SetGraphics( CanvasGraphics( RadioStationCanvas ) )
SetColor 0 , 0 , 0
Flip 0

SetColor 255,255,255
SetBlend SolidBLEND 
If Spec_BackgroundIMG &lt;&gt; Null Then DrawImage Spec_BackgroundIMG , 0 , 0
Flip 0

Repeat ' Main Loop
	Select WaitEvent()
	Case EVENT_WINDOWCLOSE, EVENT_APPTERMINATE
			End

	Case EVENT_TIMERTICK
		Select EventSource()
				
		Case SpectrumTimer
	          	SetGraphics( CanvasGraphics( RadioStationCanvas ) )
           		SetColor 255,255,255
           		SetBlend SolidBLEND 
      		If Spec_BackgroundIMG &lt;&gt; Null Then DrawImage Spec_BackgroundIMG , 0 , 0
	           Flip 0

	     End Select 
     End Select 

Forever
End

Function Init_Dx_Driver()
Global D3DDriverString:String=""
Global D3DDriver:TGraphicsDriver

?Not win32
	SetGraphicsDriver GLMax2DDriver()
	'GLShareContexts()
	ini_force_opengl=1
?

?Win32
If ini_force_opengl=0 Then 
	D3DDriver = D3D11Max2DDriver()
	If Not D3DDriver Then D3DDriver = D3D9Max2DDriver()
	If Not D3DDriver Then 
		D3DDriver = GLMax2DDriver()
		'GLShareContexts()
	EndIf 
Else 
	D3DDriver = GLMax2DDriver()
	'GLShareContexts()
EndIf

	SetGraphicsDriver D3DDriver
	D3DDriverString=GetGraphicsDriver().ToString()
	Select D3DDriverString
	Case "DirectX11 - Using DirectX 10.0"
		D3DDriverString="Dx 10.0"
	Case "DirectX11 - Using DirectX 10.1"
		D3DDriverString="Dx 10.1"
	Case "DirectX11 - Using DirectX 11.0"
		D3DDriverString="Dx 11.0"
	Case "DirectX11 - 11.1"
		D3DDriverString="Dx 11.1"
	Case "DirectX9"
		D3DDriverString="Dx 9.0"
	Case "OpenGL"
		D3DDriverString="OpenGL"
	End Select 
?

DebugLog "DEBUGLOG: DX Driver used: "+D3DDriverString
Print "DEBUGLOG: DX Driver used: "+D3DDriverString
End Function
</textarea><br><br><b>Image used inside code:</b> (i.e. prp_noico.png)<br><img src="http://s14.postimg.org/tswtloq01/prp_noico.png"><br><br>Hope that helps you. <br><br></td></tr></table><br>
<a name="1205308"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#88">[#88]</a></td></tr></table></td></tr><tr ><td class="posttext"> Grisu: Just re-checkesd mine, it was using DX 11.0 by default, and looks OK. (Radeon). Still looks OK after switching to OpenGL as well. <br><br></td></tr></table><br>
<a name="1205309"></a>

<a name="1205310"></a>

<a name="1205311"></a>

<a name="1205317"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#89">[#89]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hiya,<br><br>THanks for the working example - worked a treat!<br><br><b>This a *fix candidate*.</b><br>If there are no reported issues with this fix after a couple of weeks then I'll upload it to GitHub.<br><br>It now displays as expected on my machine using the Radeon and the NVidia.<br><br>In d3d11max2d.bmx -&gt; TD3D11Max2DDriver -&gt; SetResolution :-<br><br><pre class=code>
Method SetResolution( w#,h# )
	_matrixproj = [2.0/w,0.0,0.0,-1-(1.0/w),..
			0.0,-2.0/h,0.0,1+(1.0/h),..
			0.0,0.0,1.0,0.0,..
			0.0,0.0,0.0,1.0]
	MapBuffer (_projbuffer,0,D3D11_MAP_WRITE_DISCARD,0,_matrixproj,SizeOf(_matrixproj))
EndMethod
</pre><br><br><br>Cheers :) <br><br></td></tr></table><br>
<a name="1205314"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#90">[#90]</a></td></tr></table></td></tr><tr ><td class="posttext"> Seems to work so far. Need to test it further.<br><br>Make sure you add the missing "(" at the MapBuffer part, else it won't compile. 8)<br><br>Thanks for the ber fast response time. <br><br></td></tr></table><br>
<a name="1205318"></a>

<a name="1205319"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#91">[#91]</a></td></tr></table></td></tr><tr ><td class="posttext"> Added the '('.<br><br>Lol.<br><br>Thanks!<br><br>Awesome awesome music player! It truly is a great app. <br><br></td></tr></table><br>
<a name="1205325"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#92">[#92]</a></td></tr></table></td></tr><tr ><td class="posttext"> Glad that you like the app.<br><br>I'm going to add you to the Credits window for this module. Without it, my app would still depend on ancient DirectX9. What Name or Nick would you like to see there? <br><br></td></tr></table><br>
<a name="1205332"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#93">[#93]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wow. Thats really cool :)<br><br>It would be ok to use my real name - Dave Camp.<br><br>Thanks!!!! <br><br></td></tr></table><br>
<a name="1205799"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#94">[#94]</a></td></tr></table></td></tr><tr ><td class="posttext"> Replaced my Geforce 8800gts with a GTX 650Ti. <br>So far everything displays as it should. :)<br><br>You can grab the Halloween build from the PRP website. I used your real name for the credits. <br><br></td></tr></table><br>
<a name="1205839"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#95">[#95]</a></td></tr></table></td></tr><tr ><td class="posttext"> Cool!!<br><br>It really is a cool player. I use it all the time.<br>Thanks for sharing this! <br><br></td></tr></table><br>
<a name="1256354"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#96">[#96]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Dave!<br>Please make sure that your download link includes the latest fix for the resolution problem. - It currently doesn't.<br>Grisu <br><br></td></tr></table><br>
<a name="1256365"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#97">[#97]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Grisu!<br><br>Updated, thanks for noting! <br><br></td></tr></table><br>
<a name="1259420"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Richard Betson</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#98">[#98]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> fix for the resolution problem. <br></div><br>What was the issue? <br><br></td></tr></table><br>
<a name="1259511"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Richard Betson</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#99">[#99]</a></td></tr></table></td></tr><tr ><td class="posttext"> BTW,<br><br>This driver works on DX12 with no problems as reported to me by beta team. Also my BlitzMax game runs on Windows 10.<br><br>All good news. :) <br><br></td></tr></table><br>
<a name="1259581"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#100">[#100]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>What was the issue? <br> <br></div><br><br>Hey Rich!<br><br>on some select gpu cards... pixmaps/images would display 1 pixel off of vertical and 1 off of horizontal as in post #84. A simple matrix issue.<br><br>Thanks for the update. Good news with everything running sound on Win10 eh. Thats cool.<br><br>Also congratulations for the demo release tomorrow! I hope everything goes well. If there are any issues with the driver, don't worry. I pass by here most days so I'll pick up your feedback pretty quickly. The game is sure to be a big hit in its genre. Awesome game and the dev work that you show is truly inspiring stuff. <br><br></td></tr></table><br>
<a name="1275285"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#101">[#101]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Dave!<br><br>Now with Win 10 out of the door. Do you have any plans on extending the module to DX 12? It would be nice to be able to detect DX 12 and benefit a bit from the lesser API overhead.<br><br>Stefan <br><br></td></tr></table><br>
<a name="1275513"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#102">[#102]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey Grisu,<br><br>I'm working on something else at the mo but Dx12 is looking good. I think to take advantage of this lower level infrastructure is to use a scene graph or multiple scene graphs which would be a better system for a multi-thread environment than the current unoptimised state mechanism that max2d drivers are currently using. In fact max2d current system isnt suited at all for multithreading. This would also be better written in c++ rather than bmax so as to take advantage of a more advanced compiler. This would mean a completely new module rather than extending the existing one. One important factor though would be to keep the existing max2d api so that you don't have to change any your existing code  to use it - same as the existing graphics drivers work, that is: being able to change driver on the fly with a couple of commands - to pull that off could be a whole ton of work, but its all doable :-)<br><br>One day I'll probably find time to get it done for max2d but probably not within the next couple of months though. <br><br></td></tr></table><br>
<a name="1287396"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#103">[#103]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Dave, <br><br>could you try to make your module compatible with Brucey's 64 Bit version of BMX: <a href="http://www.blitzbasic.com/Community/posts.php?topic=105537" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=105537</a> ?<br><br><pre class=code>
[ 86%] Processing:dxgi.bmx
Compile Error: Unable to convert from Byte Ptr to Int.
[C:/BlitzMax/mod/srs.mod/directx11.mod/DXGI.bmx;350;0]
Compile Error: Unable to convert from Byte Ptr to Int.
[C:/BlitzMax/mod/srs.mod/directx11.mod/dxgi.bmx;350;0]
Compile Error: Unable to convert from Byte Ptr to Int.
[C:/BlitzMax/mod/srs.mod/directx11.mod/d3dcompiler.bmx;31;0]
Build Error: failed to compile (-1) C:/BlitzMax/mod/srs.mod/directx11.mod/dxgi.bmxBuild Error: failed to compile (-1) C:/BlitzMax/mod/srs.mod/directx11.mod/DXGI.bmx
Process complete
</pre> <br><br></td></tr></table><br>
<a name="1287605"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#104">[#104]</a></td></tr></table></td></tr><tr ><td class="posttext"> Will do, as soon as I can get the latest updates to build :-) <br><br></td></tr></table><br>
<a name="1287653"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#105">[#105]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks! <br><br></td></tr></table><br>
<a name="1289630"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#106">[#106]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just a heads up as I haven't forgotten about this, still working on the low level interface mechanism for NG with Brucey - which is turning out to be much better than originally thought ;-) <br><br></td></tr></table><br>
<a name="1292858"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#107">[#107]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey Dave!<br><br>Just a quick thank you for creating this driver :)<br><br>Also in you signature you name it " Get your BMax DirectX10/11 Max2DDriver here!"... so does it support DX10 as well as DX11 (even though all the code talks about DX11)?<br><br>Cheers,<br>Steve <br><br></td></tr></table><br>
<a name="1292882"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#108">[#108]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey therevills!<br><br>What that means is that it will also work for Dx10 only gpus. As long as Dx11 is installed, even though the gpu is Dx10 only, then the D3D11Max2DDriver will use DirectX11 interfaces to make the Dx10 only gpu work as expected.<br><br>Hope it helps! <br><br></td></tr></table><br>
<a name="1292895"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#109">[#109]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ah cool - thanks Dave :)<br><br>My memory might be wrong, but didnt you also create a DX10 wrapper too? <br><br></td></tr></table><br>
<a name="1292896"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#110">[#110]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> didnt you also create a DX10 wrapper too?  <br></div><br>Nah, there was never a Dx10 only wrapper for 'Max by anyone.<br><br><br><div class="quote"> My memory might be wrong <br></div><br>No worries, as we progress though life we should expect it more often :D <br><br></td></tr></table><br>
<a name="1294643"></a>

<a name="1294645"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#111">[#111]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hiya all,<br><br>The D3D11Max2DDriver is now also compatible with Bruceys NG version of BlitzMax.<br>Simply download and use as normal. This is a 'drop-in replacement' for the older driver ie swap out the complete older driver and put this one in its place, rebuild the module and your existing code *should* just work.<br><br>This version supports the original BlitzMax and NG.<br><br>Have fun! <br><br></td></tr></table><br>
<a name="1294649"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#112">[#112]</a></td></tr></table></td></tr><tr ><td class="posttext"> Awesome job! :-) <br><br></td></tr></table><br>
<a name="1294695"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#113">[#113]</a></td></tr></table></td></tr><tr ><td class="posttext"> Cool! <br><br></td></tr></table><br>
<a name="1294701"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzSupport</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#114">[#114]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wow, well done, Col. <br><br></td></tr></table><br>
<a name="1294702"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#115">[#115]</a></td></tr></table></td></tr><tr ><td class="posttext"> Awesome +64! <br><br></td></tr></table><br>
<a name="1294752"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#116">[#116]</a></td></tr></table></td></tr><tr ><td class="posttext"> Very, very, very nice! <br><br></td></tr></table><br>
<a name="1294766"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#117">[#117]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> This is a 'drop-in replacement' for the older driver ie swap out the complete older driver and put this one in its place, rebuild the module and your existing code *should* just work. <br></div><br><br>Hmm... Probably not related, but I noticed that doing a force recompile of my entire NG install, it's bombing out on the pub.directx now: (gcc version 5.1.0 (tdm64-1)<br><pre class=code>
[ 92%] Processing:d3d7.bmx
[ 92%] Processing:d3d9x.bmx
[ 93%] Processing:dd.bmx
[ 93%] Processing:dsound.bmx
[ 93%] Archiving:freetype.release.win32.x86.a
c:/Code/BlitzMaxNG510/MinGW32/bin/ar.exe: creating c:/Code/BlitzMaxNG510/mod/pub.mod/freetype.mod/freetype.release.win32.x86.a
[ 94%] Compiling:d3d7.bmx.release.win32.x86.c
[ 94%] Compiling:d3d9x.bmx.release.win32.x86.c
[ 95%] Compiling:dd.bmx.release.win32.x86.c
[ 95%] Compiling:dsound.bmx.release.win32.x86.c
[ 97%] Processing:d3d9.bmx
[ 98%] Compiling:d3d9.bmx.release.win32.x86.c
[ 98%] Processing:directx.bmx
Compile Error: Syntax error - expecting identifier.
[c:/Code/BlitzMaxNG510/mod/pub.mod/directx.mod/.bmx/dd.bmx.release.win32.x86.i;543;0]
Build Error: failed to compile (-1) c:/Code/BlitzMaxNG510/mod/pub.mod/directx.mod/directx.bmx
</pre> <br><br></td></tr></table><br>
<a name="1294775"></a>

<a name="1294776"></a>

<a name="1294777"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#118">[#118]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hiya,<br><br>NG is being constantly updated, sometimes by the hour but definitely every few days/weeks.<br><br>I get the same error with the latest bcc but <a href="https://github.com/bmx-ng/bcc/tree/444595a6f9068b9a24b0b0026bc4548ab84ee70b" target="_blank">the previous commit</a> compiles everything ok as long as you also have the latest brl/pub modules too. <br><br></td></tr></table><br>
<a name="1294778"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#119">[#119]</a></td></tr></table></td></tr><tr ><td class="posttext"> Maybe it just needs another "elseif" in the current BCC ... let's wait for the next commit which surely fixes that issue.<br><br><br>bye<br>Ron <br><br></td></tr></table><br>
<a name="1294779"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#120">[#120]</a></td></tr></table></td></tr><tr ><td class="posttext"> After making the d3d11 driver SuperStrict and then also forcing a rebuild of all modules, NG also doesn't like it so for the moment if you could <a href="https://github.com/SRSSoftware/srs.mod/tree/d698ef4a9dd3bae55fd8384cf53230584b2ba925" target="_blank">use the previous commit</a> then everything works harmoniously. <br><br></td></tr></table><br>
<a name="1294780"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#121">[#121]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you are brave, add the suggested else-if and check if it compiles then, if so, feel free to PR it to Brucey. I am currently not able to try it out.<br><br>bye<br>Ron <br><br></td></tr></table><br>
<a name="1294913"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#122">[#122]</a></td></tr></table></td></tr><tr ><td class="posttext"> compile error with latest NG:<br><br><pre class=code>[ 64%] Compiling:common.bmx.debug.win32.x64.c
[ 64%] Compiling:common.bmx.debug.win32.x64.c
[ 64%] Compiling:common.bmx.debug.win32.x64.c
c:/code/BlitzmaxNG510/mod/srs.mod/d3d11max2d.mod/.bmx/d3d11max2d_ng.bmx.debug.win32.x64.c: In function 'srs_d3d11max2d_d3d11max2d_ng_CreateD3D11Max2DResources':
c:/code/BlitzmaxNG510/mod/srs.mod/d3d11max2d.mod/.bmx/d3d11max2d_ng.bmx.debug.win32.x64.c:5719:8: error: void value not ignored as it ought to be
  bbt_hr=srs_directx11_d3dcompiler_ng_D3DCompile(bbt_3,(srs_d3d11max2d_d3d11max2d_ng__max2dshaders-&gt;_srs_d3d11max2d_d3d11max2d_ng_td3d11max2dshaders__max2dvs -&gt;length),0,0,0,bbt_4,bbt_5,32768,0,&amp;bbt_vscode,&amp;bbt_pErrorMsg);
        ^
c:/code/BlitzmaxNG510/mod/srs.mod/d3d11max2d.mod/.bmx/d3d11max2d_ng.bmx.debug.win32.x64.c:5845:8: error: void value not ignored as it ought to be
  bbt_hr=srs_directx11_d3dcompiler_ng_D3DCompile(bbt_8,(srs_d3d11max2d_d3d11max2d_ng__max2dshaders-&gt;_srs_d3d11max2d_d3d11max2d_ng_td3d11max2dshaders__max2dps -&gt;length),0,0,0,bbt_9,bbt_10,32768,0,&amp;bbt_pscode,&amp;bbt_pErrorMsg);
        ^
c:/code/BlitzmaxNG510/mod/srs.mod/d3d11max2d.mod/.bmx/d3d11max2d_ng.bmx.debug.win32.x64.c:5919:8: error: void value not ignored as it ought to be
  bbt_hr=srs_directx11_d3dcompiler_ng_D3DCompile(bbt_11,(srs_d3d11max2d_d3d11max2d_ng__max2dshaders-&gt;_srs_d3d11max2d_d3d11max2d_ng_td3d11max2dshaders__max2dps -&gt;length),0,0,0,bbt_12,bbt_13,32768,0,&amp;bbt_pscode,&amp;bbt_pErrorMsg);
        ^
c:/code/BlitzmaxNG510/mod/srs.mod/d3d11max2d.mod/.bmx/d3d11max2d_ng.bmx.debug.win32.x64.c:5993:8: error: void value not ignored as it ought to be
  bbt_hr=srs_directx11_d3dcompiler_ng_D3DCompile(bbt_14,(srs_d3d11max2d_d3d11max2d_ng__max2dshaders-&gt;_srs_d3d11max2d_d3d11max2d_ng_td3d11max2dshaders__max2dps -&gt;length),0,0,0,bbt_15,bbt_16,32768,0,&amp;bbt_pscode,&amp;bbt_pErrorMsg);
        ^
Build Error: failed to compile (1) c:/code/BlitzmaxNG510/mod/srs.mod/d3d11max2d.mod/.bmx/d3d11max2d_ng.bmx.debug.win32.x64.c
</pre> <br><br></td></tr></table><br>
<a name="1294914"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#123">[#123]</a></td></tr></table></td></tr><tr ><td class="posttext"> Good point, D3DCompile return type hasn't been specified, whilst the module is SuperStrict :<br><pre class=code>
Global D3DCompile(pSrcData:Byte Ptr,SrcDa...
</pre><br><br>On NG, SuperStrict will assume you really aren't returning anything from a function if you don't specify a return type - as opposed to the legacy compiler, which adds :Int to *all* your functions. <br><br></td></tr></table><br>
<a name="1294924"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#124">[#124]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks guys, corrected. <br><br></td></tr></table><br>
<a name="1295036"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#125">[#125]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey Dave - any idea what is happening here:<br><br><a href="http://www.blitzmax.com/Community/posts.php?topic=105798" target="_blank">http://www.blitzmax.com/Community/posts.php?topic=105798</a><br><br>With the Steam Overlay?<br><br>Cheers,<br>Steve <br><br></td></tr></table><br>
<a name="1295060"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#126">[#126]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Dave, <br><br>Couple of issues I've found:<br><br>* DrawOval has an issue when switching between graphics drivers, it doesnt draw.<br>* Also when Alt-Tabbing, the "game" is displayed on the desktop in a windowless version<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">SuperStrict
Import SRS.D3D11Max2D

Global fullscreenwidth:Int = 1024
Global fullscreenheight:Int = 768
Global fullscreendepth:Int = 32

Global windowedwidth:Int = 640
Global windowedheight:Int = 400
Global windoweddepth:Int = 0

Const DIRECTX9_DRIVER:Int = 0
Const DIRECTX11_DRIVER:Int = 2
Const OPENGL_DRIVER:Int = 1
Global driver:Int = DIRECTX11_DRIVER

If driver = DIRECTX9_DRIVER Then
	SetGraphicsDriver D3D9Max2DDriver()
ElseIf driver = DIRECTX11_DRIVER Then
	SetGraphicsDriver D3D11Max2DDriver()
ElseIf driver =  OPENGL_DRIVER Then
	SetGraphicsDriver GLMax2DDriver()
End If

Graphics fullscreenwidth, fullscreenheight, fullscreendepth

SetClsColor 64, 96, 128
SetMaskColor 255, 0, 255

Local d:Int = driver 

Repeat
	If KeyHit(KEY_G)
		d:+1
		If d&gt;2 Then d = 0
		SetDriver(d)
	End If

	Cls()
	SetColor 255, 255, 255
	If driver = DIRECTX9_DRIVER 
		DrawText "G to change Graphics Driver: DIRECTX9", 20, 100
	ElseIf driver =DIRECTX11_DRIVER 
		DrawText "G to change Graphics Driver: DIRECTX11", 20, 100
	ElseIf driver =OPENGL_DRIVER 
		DrawText "G to change Graphics Driver: OPENGL", 20, 100
	End If
	DrawText "Mouse : " + MouseX() +","+MouseY(), 20, 160	
	SetColor 0, 0, 255
	DrawOval MouseX () - 32, MouseY () - 32, 64, 64
	SetColor 255, 0, 255
	DrawRect MouseX () - 32, MouseY () + 50, 64, 64
	
	Flip
	
Until KeyHit (KEY_ESCAPE)

Function SetDriver:Int(mode:Int)
	'0 = DirectX9, 1=DX11, 2 = OpenGL
	If mode = 0 Then
		'Don't do anything if Driver is already 0
		If Driver = 0 Then Return 0
		Driver = 0
	EndIf
	
	If mode = 1 Then
		'Don't do anything if Driver is already 0
		If Driver = 1 Then Return 0
		Driver = 1
	EndIf
	
	If mode = 2
		'Don't do anything if Driver is already 0
		If Driver = 2 Then Return 0
		Driver = 2
	EndIf
	EndGraphics() 'safety
	
		
	If driver = DIRECTX9_DRIVER Then
		SetGraphicsDriver D3D9Max2DDriver()
	ElseIf driver = DIRECTX11_DRIVER Then
		SetGraphicsDriver D3D11Max2DDriver()
	ElseIf driver = OPENGL_DRIVER Then
		SetGraphicsDriver GLMax2DDriver()
	End If
	
	Graphics fullscreenwidth, fullscreenheight, fullscreendepth	
	' These get reset when exiting graphics mode...
	
	SetClsColor 64, 96, 128
	SetMaskColor 255, 0, 255
	Return 1
End Function
</textarea> <br><br></td></tr></table><br>
<a name="1295326"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#127">[#127]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Steve,<br><br>The oval issue and alt-tab issues should be fixed now in both version.<br>There was also a full screen infinite loop bug in NG that's also fixed. <br><br></td></tr></table><br>
<a name="1295344"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#128">[#128]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Dave - Just downloaded the latest master and tested.<br><br>The oval has been fixed, but not the alt-tab bug from full screen, here you can see that the "windowless" screen has been displayed behind MaxIDE after alt-tabbing:<br><br><img src="https://dl.dropboxusercontent.com/u/35103024/mx/dx11_alt_tab.JPG"><br><br>With the virtual resolution, here is a screenshot of the DX11 issue:<br><br><img src="https://dl.dropboxusercontent.com/u/35103024/mx/dx11_aspect_ratio.jpg"><br><br>As you can see we dont get the black vertical bars and we can still see the rects &amp; oval passed the "virtual" display.<br><br>Cheers,<br>Steve <br><br></td></tr></table><br>
<a name="1295351"></a>

<a name="1295353"></a>

<a name="1295355"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#129">[#129]</a></td></tr></table></td></tr><tr ><td class="posttext"> The vertical bars is because of the way DirectX  10+ now clear the back buffer(s).<br><br>From <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ff476388(v=vs.85).aspx" target="_blank">MSDN</a><br><div class="quote"> <br>Differences between Direct3D 9 and Direct3D 11/10:<br>Unlike Direct3D 9, the full extent of the resource view is always cleared. Viewport and scissor settings are not applied.<br> <br></div><br><br>I don't actually get that 'after effect' at all of my machine. I do get the same colour borders though. I do have a solution in mind. I'll implement it and put it out for testing.<br><br><br>I see what you mean about the window becoming a standard borderless window. I'm not sure on the best way to handle this. Here's why... When you're in fullscreen and you alt-tab then the OS has no choice but to come out of fullscreen so that it can display the desktop. DXGI, which the window handling of DirectX, intercepts the OS message and automatically handles bringing your app out of fullscreen and displays it as a regular window.<br><br>I think most other games now ignore exclusive fullscreen altogether and do a regular borderless full desktop sized window that simply covers the whole desktop giving the illusion of the exclusive fullscreen mode, or I could just minimize the window? <br><br></td></tr></table><br>
<a name="1295359"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#130">[#130]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I do have a solution in mind. I'll implement it and put it out for testing. <br></div><br>Ready and willing :)<br><br><div class="quote"> or I could just minimize the window?  <br></div><br>That sounds like a good fix.<br><br>Cheers,<br>Steve <br><br></td></tr></table><br>
<a name="1300551"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#131">[#131]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi!<br><br>A user reported that the graphics canvas is no longer updated properly when the window is coming back from the background. Or if you bring up the window from the trayicon.<br><br>See screenshot:<br><img src="http://s17.postimg.org/ci2xyg3wb/prp.jpg"><br><br>OS: WinXP Pro (32 Bit)<br>GFX: Nvidia GeForce 6600GT, DirectX 9c<br>Res: 1152x864 @ 32 Bit colour<br><br>Not sure, if this has to do with your module. But I thought to better report it. It also exists when using OpenGL as driver.<br><br>Stefan <br><br></td></tr></table><br>
<a name="1303331"></a>

<a name="1303332"></a>

<a name="1303336"></a>

<a name="1303344"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#132">[#132]</a></td></tr></table></td></tr><tr ><td class="posttext"> Jeez!<br>Been away for a while - fixed the alt-tab issue.<br><br>@therevills<br>The SetViewport hack should be implemented yourself as opposed to it being a standard part of the D3D11Max2D code, otherwise it runs the risk of breaking other peoples code. It's a Steam fault for not resetting the direct3d state to what it was before they changed it.<br><br>I'll take a look Grisu...<br>[edit]You're not using the 'SetViewport' hack above are you? I did include the hack in the previous commit by mistake and have removed it in the latest commit. <br><br></td></tr></table><br>
<a name="1303359"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#133">[#133]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Jeez!<br>Been away for a while - fixed the alt-tab issue. <br></div><br><br>FWIW, it is throwing some warnings compiling in Blitzmax-NG:<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
[ 90%] Processing:directx11.bmx
[ 91%] Compiling:directx11.bmx.release.win32.x86.c
[ 92%] Archiving:directx11.release.win32.x86.a
c:/code/blitzmaxNG510/MinGW32/bin/ar.exe: creating c:/code/blitzmaxNG510/mod/srs.mod/directx11.mod/directx11.release.win32.x86.a
[ 93%] Processing:d3d11graphics_ng.bmx
Compile Warning: In call to Function DefWindowProcW:Byte Ptr(hWnd:Byte Ptr,MSG:UInt,wParam:Byte Ptr,lParam:Byte Ptr). Argument #2 is "Int" but declaration is "UInt".
[c:/code/blitzmaxNG510/mod/srs.mod/d3d11graphics.mod/d3d11graphics_ng.bmx;52;0]

[ 94%] Compiling:d3d11graphics_ng.bmx.release.win32.x86.c
[ 95%] Processing:d3d11graphics.bmx
[ 96%] Compiling:d3d11graphics.bmx.release.win32.x86.c
[ 97%] Archiving:d3d11graphics.release.win32.x86.a
c:/code/blitzmaxNG510/MinGW32/bin/ar.exe: creating c:/code/blitzmaxNG510/mod/srs.mod/d3d11graphics.mod/d3d11graphics.release.win32.x86.a
[ 98%] Processing:d3d11max2d_ng.bmx
Compile Warning: In call to Method ID3D11DeviceContext.Draw:Int(VertexCount:Int,StartVertexLocation:Int). Argument #1 is "Float" but declaration is "Int".
[c:/code/blitzmaxNG510/mod/srs.mod/d3d11max2d.mod/d3d11max2d_ng.bmx;1353;0]

Compile Warning: In call to Method ID3D11DeviceContext.Draw:Int(VertexCount:Int,StartVertexLocation:Int). Argument #1 is "Float" but declaration is "Int".
[c:/code/blitzmaxNG510/mod/srs.mod/d3d11max2d.mod/d3d11max2d_ng.bmx;1402;0]

[ 98%] Compiling:d3d11max2d_ng.bmx.release.win32.x86.c
[ 99%] Processing:d3d11max2d.bmx
[ 99%] Compiling:d3d11max2d.bmx.release.win32.x86.c
[100%] Archiving:d3d11max2d.release.win32.x86.a
c:/code/blitzmaxNG510/MinGW32/bin/ar.exe: creating c:/code/blitzmaxNG510/mod/srs.mod/d3d11max2d.mod/d3d11max2d.release.win32.x86.a
</textarea> <br><br></td></tr></table><br>
<a name="1303364"></a>

<a name="1303365"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#134">[#134]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Jeez!<br>Been away for a while - fixed the alt-tab issue. <br></div><br><br>Did you go anywhere nice?<br><br>Thanks for the fix... I looked at the code but didnt know where or how to implement it! I'll test it soon :)<br><br><div class="quote"> @therevills<br>The SetViewport hack should be implemented yourself as opposed to it being a standard part of the D3D11Max2D code, otherwise it runs the risk of breaking other peoples code. It's a Steam fault for not resetting the direct3d state to what it was before they changed it. <br></div><br><br>Yeah that's fine, could you let me know what I have to do? Is it just commenting out the _d3d11devcon.RSSetScissorRects(1,[x,y,x+width,y+height]) command in SetViewport? <br><br></td></tr></table><br>
<a name="1303369"></a>

<a name="1303370"></a>

<a name="1303371"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#135">[#135]</a></td></tr></table></td></tr><tr ><td class="posttext"> @xlsior<br>Cheers! I'll be updating to the latest ng today.<br><br>@therevills<br>Yep, you're correct... just comment out that one line while using your black border fix :-)<br><br><div class="quote"> <br>Did you go anywhere nice?<br> <br></div><br>Nah, life is full of twists and turns, highs and lows ;-) <br><br></td></tr></table><br>
<a name="1303451"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#136">[#136]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Dave!<br><br>I'm currently on holiday and haven't got access to my pc. Will report back asap. I get your latest changes via the link in your signature, right?<br><br>Btw: Could you look into the fmod encoding issue, if you have some time to spare?<br><br>Stefan <br><br></td></tr></table><br>
<a name="1303620"></a>

<a name="1303621"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#137">[#137]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Grisu<br>Yep, the repo will always be the best place for the latest version.<br><br><div class="quote"> <br>Could you look into the fmod encoding issue, if you have some time to spare?<br> <br></div><br>Yeah sure. The whole encoder process, except the gui, will need to be written in c/cpp. I'll have a play over the next few days for ya.<br><br>Enjoy your vacation!! <br><br></td></tr></table><br>
<a name="1305365"></a>

<a name="1305367"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#138">[#138]</a></td></tr></table></td></tr><tr ><td class="posttext"> When using this code:<br><br><pre class=code>
SuperStrict

Import SRS.D3D11Max2D

SetGraphicsDriver D3D11Max2DDriver()

Global g:TGraphics = Graphics(400,400,0,0)

If not g Then print "fail"
</pre><br><br><br>I get an EAV in release, and in Debug the error of a null access (thrown by brl.graphics)<br><br><pre class=code>CreateGraphics failed:Attempt to access field or mehtod of Null object</pre><br><br><br>Tried this on a fresh Windows 10 installation (as a user uses this OS and reported crashs of my game when selecting DX11).<br><br><br>What could be the culprit there? Why is it failing that hard (no check within the SRS-modules) <br><br><br>Edit: <br>D3D11GetFeatureLevel() returns "0"<br><br>So could I skip to DX9 in that case (of a returned 0) ?<br><br><br>Ron <br><br></td></tr></table><br>
<a name="1305368"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#139">[#139]</a></td></tr></table></td></tr><tr ><td class="posttext"> Edit 2:<br>Think I just missed to read thread part 1 ... first check "if D3D11GraphicsDriver()", then set graphics (if driver was valid)...<br><br><br><br><strike><br>When using this code:<br><br><pre class=code>
SuperStrict

Import SRS.D3D11Max2D

SetGraphicsDriver D3D11Max2DDriver()

Global g:TGraphics = Graphics(400,400,0,0)

If not g Then print "fail"
</pre><br><br><br>I get an EAV in release, and in Debug the error of a null access (thrown by brl.graphics)<br><br><pre class=code>CreateGraphics failed:Attempt to access field or mehtod of Null object</pre><br><br><br>Tried this on a fresh Windows 10 installation (as a user uses this OS and reported crashs of my game when selecting DX11).<br><br><br>What could be the culprit there? Why is it failing that hard (no check within the SRS-modules) <br><br><br>Edit: <br>D3D11GetFeatureLevel() returns "0"<br><br>So could I skip to DX9 in that case (of a returned 0) ?<br></strike><br><br>Ron <br><br></td></tr></table><br>
<a name="1305377"></a>

<a name="1305379"></a>

<a name="1305380"></a>

<a name="1305381"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#140">[#140]</a></td></tr></table></td></tr><tr ><td class="posttext"> . <br><br></td></tr></table><br>
<a name="1305382"></a>

<a name="1305383"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#141">[#141]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey Derron,<br><br>Updated to load the default shader compiler thats installed with Win10.<br><br><div class="quote"> <br>So could I skip to DX9 in that case (of a returned 0) ?<br> <br></div><br>You could do yes. <a href="/post.php?topic=97645&amp;post=1147402" target="_blank">And/or you could also check if the driver is valid too</a> <br><br></td></tr></table><br>
<a name="1305386"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#142">[#142]</a></td></tr></table></td></tr><tr ><td class="posttext"> For now I adjusted my Code to:<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">

Function SetRendererWin32:TGraphics(_g:TGraphics, renderer:Int var, realWidth:Int, realHeight:Int, colorDepth:Int, fullScreen:Int, hertz:Int, flags:Int)
	Local RENDERER_OPENGL:Int   		= 0
	Local RENDERER_DIRECTX7:Int 		= 1
	Local RENDERER_DIRECTX9:Int 		= 2
	Local RENDERER_DIRECTX11:Int 		= 3
	Local RENDERER_BUFFEREDOPENGL:Int   = 4
	Local RENDERER_GL2SDL:int           = 5


	?Not bmxng
	'try DX11, DX9, then DX7 and if all fail, fall back to OGL
	if renderer = RENDERER_DIRECTX11 and not D3D11Max2DDriver()
		print "SetRenderer: Directx 11 not available or not a DX11 compatible GPU."
		renderer = RENDERER_DIRECTX9
	endif
	if renderer = RENDERER_DIRECTX9 and not D3D9Max2DDriver()
		print "SetRenderer: Directx 9 not available or not a DX9 compatible GPU."
		renderer = RENDERER_DIRECTX7
	endif
	if renderer = RENDERER_DIRECTX7 and not D3D7Max2DDriver()
		print "SetRenderer: Directx 9 not available or not a DX9 compatible GPU."
		renderer = RENDERER_OPENGL
	endif
	?

	Select renderer
		?Not bmxng
		Case RENDERER_DIRECTX7
			SetGraphicsDriver D3D7Max2DDriver()
		Case RENDERER_DIRECTX9
			SetGraphicsDriver D3D9Max2DDriver()
		Case RENDERER_DIRECTX11
			SetGraphicsDriver D3D11Max2DDriver()
		?
		Default
			SetGraphicsDriver GLMax2DDriver()
	EndSelect

	_g = Graphics(realWidth, realHeight, colorDepth*fullScreen, hertz, flags)

	?Not bmxng
	If Not _g And renderer &lt;&gt; RENDERER_DIRECTX11 and D3D11Max2DDriver()&lt;&gt;Null
		Notify "Graphics initiation error! The game will try to open in DirectX 11 mode."
		SetGraphicsDriver D3D11Max2DDriver()
		_g = Graphics(realWidth, realHeight, colorDepth*fullScreen, hertz, flags)
	EndIf
	If Not _g And renderer &lt;&gt; RENDERER_DIRECTX9 and D3D9Max2DDriver()&lt;&gt;Null
		Notify "Graphics initiation error! The game will try to open in DirectX 9 mode."
		SetGraphicsDriver D3D9Max2DDriver()
		_g = Graphics(realWidth, realHeight, colorDepth*fullScreen, hertz, flags)
	EndIf
	If Not _g And renderer &lt;&gt; RENDERER_DIRECTX7 and D3D7Max2DDriver()&lt;&gt;Null
		Notify "Graphics initiation error! The game will try to open in DirectX 7 mode."
		SetGraphicsDriver D3D7Max2DDriver()
		_g = Graphics(realWidth, realHeight, colorDepth*fullScreen, hertz, flags)
	EndIf
	'or to OpenGL
	If Not _g And renderer &lt;&gt; RENDERER_OPENGL
		Notify "Graphics initiation error! The game will try to open in OpenGL mode."
		SetGraphicsDriver GLMax2DDriver()
		_g = Graphics(realWidth, realHeight, colorDepth*fullScreen, hertz, flags)
	EndIf
	?
	return _g
End Function
</textarea><br><br>It tries to use DX11, DX9, DX7 and finally OGL. It is wrapped in an external file so I could use the NG flags (which wont be possible within a "?win32"-conditional). The external file is only used within code wrapped with "?win32".<br><br><br>bye<br>Ron <br><br></td></tr></table><br>
<a name="1316571"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#143">[#143]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the Win10 fix :) <br><br></td></tr></table><br>
<a name="1318661"></a>

<a name="1318662"></a>

<a name="1318663"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#144">[#144]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm doing some performance tuning on my game and noticed that when using the DX11 driver on my Win 8.1 machine, it is quite a bit slower than DX9... I would have thought that DX11 would be faster?<br><br>A little extreme test case:<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">SuperStrict
Import srs.D3D11Max2D

Global ScreenWidth:Int = 1366
Global ScreenHeight:Int = 768

Const DX11:Int = 0
Const DX9:Int = 1
Const OPG:Int = 2

Global driver% = DX11

Function SetDriver(d%)
	EndGraphics
	Select d
		Case DX11
			driver = d
			SetGraphicsDriver D3D11Max2DDriver()
		Case DX9
			driver = d
			SetGraphicsDriver D3D9Max2DDriver()
		Case OPG
			driver = d
			SetGraphicsDriver GLMax2DDriver()
		Default
			driver = 0
			SetGraphicsDriver D3D11Max2DDriver()
	EndSelect
	Graphics ScreenWidth, ScreenHeight, 0, 60
End Function

Function GetDriver:String()
	Local rv:String
	Select driver
		Case DX11
			rv = "DX11"
		Case DX9
			rv = "DX9"
		Case OPG
			rv = "OPG"
	EndSelect
	Return rv
End Function

SetDriver(driver)

Type TSprite
	Field x#, y#
	Field dx#, dy#
	Field gravity#
	Field w%, h%
	Field w2#, h2#
	Field alpha#=1
	Field scaleX:Float = 1
	Field scaleY:Float = 1
	
	Method Update()
		x :+ dx
		y :+ dy
		If gravity &lt;&gt; 0 Then dy :+ gravity	
	End Method
	
	Method Render()
		SetScale scaleX, scaley
		SetAlpha alpha
		DrawOval x, y, 2, 2
		SetAlpha 1
		SetScale 1,1
	EndMethod
End Type


Type TSnow Extends TSprite
	'Field snowList:TSnowList 'points to list it's part of	
	Field stopSnowing:Int
	
	Function CreateSnow:TSnow()
		Local b:TSnow = New TSnow
		b.gravity = 0.0005
		Return b
	End Function
	
	Method Update()
		Super.Update()
		BoundsCheck()
	End Method

	Method BoundsCheck()	
		If y &gt; ScreenHeight + h2 Then
			If Not stopSnowing Then Reset()
		EndIf
		If x &gt; ScreenWidth * 2 Or x &lt; - ScreenWidth
			If Not stopSnowing Then Reset()
		End If
	End Method
	
	Method Reset()
		dy = Rnd(0.1, 0.75)
		x = Rand(-ScreenWidth, ScreenWidth * 2)
		y = -h
		
		Local scale:Float = Rnd(1, 3)
		scaleX = scale
		scaleY = scale
		alpha = Rnd(0.5, 1)
	End Method
	
	Method Kill()
		'If snowList &lt;&gt; Null Then
		'	snowList.Remove(Self)
		'	snowList=Null
	'	EndIf
	End Method
End Type 

' -----------------------------------------------------------------------------
Type TSnowList 'Extends TList
	Field snowOn:Int = True
	Field windSpeed:Float
	Field timer:Float
	Field snowingTimer:Float
	Field snowing:Int = True
	Field alwaysSnow:Int = True
	
	Const MAX_SNOW:Int = 50000
	Field arr:TSnow[MAX_SNOW]
	Field noOfSnowFlakes:Int
	
	Field sx:Int, sy:Int
	Field bsx:Int
	
	Method CreateSnow(flakes:Int)
		windSpeed = Rnd(-1, 1)
		timer = Rand(5000, 10000)
		'For Local i:Int = 0 To 5000
		noOfSnowFlakes = flakes
		snowing = Rand(0, 1)
		snowingTimer = Rand(30000, 60000)
		If noOfSnowFlakes &gt; MAX_SNOW
			noOfSnowFlakes = MAX_SNOW
		End If
		alwaysSnow = True
		For Local i:Int = 0 Until noOfSnowFlakes
			Local r:TSnow = New TSnow.CreateSnow()
			r.Reset()
			r.dx = windSpeed / 4
		'	r.snowList = Self 
			r.y = Rand(0, ScreenHeight)
			r.dy:+r.gravity * r.y
			arr[i] = r
			'AddLast(r)
		Next
		
	End Method
	
	Method StopSnowing()
		DebugLog "Stopping snowing..."
		snowing = False
		For Local i:Int = 0 Until noOfSnowFlakes
			arr[i].stopSnowing = True
		Next
	End Method
	
	Method StartSnowing()
		DebugLog "Starting snowing..."
		snowing = True
		For Local i:Int = 0 Until noOfSnowFlakes
			arr[i].stopSnowing = False
			If arr[i].y &gt; ScreenHeight
				arr[i].Reset()
				arr[i].y = Rnd(-ScreenHeight, 0)
			EndIf
		Next
	End Method
	
	Method Draw()
		If snowOn
			'For Local b:TSnow = EachIn Self
			For Local i:Int = 0 Until noOfSnowFlakes
				If arr[i].x &gt; 0 - arr[i].w2 And arr[i].x &lt; ScreenWidth + arr[i].w2 And arr[i].y &gt; 0 - arr[i].h2 And arr[i].y &lt; ScreenHeight + arr[i].h2
					arr[i].Render()
				EndIf
			Next
		EndIf
	End Method
	
	Method Update()
		If snowOn
			If timer &lt;= 0
				windSpeed = Rnd(-1, 1)
				timer = Rand(5000, 10000)
			Else
				timer:-1
			End If
			If Not alwaysSnow
				If snowingTimer &lt;= 0
					snowingTimer = Rand(30000, 60000)
					snowing = -snowing
					If snowing
						StopSnowing()
					Else
						StartSnowing()
					End If
				Else
					snowingTimer:-1
				End If
			EndIf
			
			'For Local b:TSnow = EachIn Self
			For Local i:Int = 0 Until noOfSnowFlakes
				arr[i].Update()
				Local ss:Float = arr[i].scaleX / 1000
				If ss &lt; 0.001
					ss = 0.001
				End If
								
				If arr[i].dx &gt; windSpeed
					arr[i].dx:-ss
				End If
				If arr[i].dx &lt; windSpeed
					arr[i].dx:+ss
				End If
			Next
		EndIf
	End Method
	
	Method Kill()		
	'	For Local b:TSnow = EachIn Self
		For Local i:Int = 0 Until noOfSnowFlakes
			Local b:TSnow = arr[i]
			b.Kill()
		Next
	End Method
End Type

Local frame:Int
Local ticks:Int
Local fps:Int 
Local angle:Float = 0
Local lastTick:Int 

Local snowList:TSnowList
snowList = New TSnowList
snowList.CreateSnow(50000)

Repeat

	snowList.Update()
	If KeyHit(KEY_A)
		snowList.StopSnowing()
	
	End If
	If KeyHit(KEY_Z)
		snowList.StartSnowing()
	End If
	If KeyHit(KEY_G)
		driver:+1
		SetDriver(driver)
	EndIf
	

	lastTick = MilliSecs()
	Cls
	frame :+ 1
	If ( MilliSecs() &gt;= ticks + 1000 )
		ticks = MilliSecs()
		fps = frame
		frame = 0
	End If 
	SetBlend SOLIDBLEND
	SetColor (255, 255, 255)
	SetBlend ALPHABLEND
	snowList.Draw()
	DrawText( "FPS: " + fps, 0, 0 )
	DrawText( "Driver: " + GetDriver(), 0, 20 )	
	Flip 1
Until AppTerminate()</textarea><br><br>In release mode:<br><pre class=code>
DX11: 16FPS
DX9: 31FPS
OpenGL: 38FPS
</pre> <br><br></td></tr></table><br>
<a name="1318665"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#145">[#145]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry, cannot help that much, but there is a minor:<br><pre class=code>
	SetBlend SOLIDBLEND
	SetColor (255, 255, 255)
	SetBlend ALPHABLEND
</pre><br><br>The solidblend isn't needed at all.  "SetBlend" seems to do a bit more in the DX11 driver than it has to do with DX9. But it happens only once per tick ... so that should be neglectable.<br><br>But similar "changes" happen to SetAlpha() and other calls. Maybe the pure "mass" of sprites (and their drawing/alpha/color/...calls) add up a bit?<br><br><br>bye<br>Ron <br><br></td></tr></table><br>
<a name="1318676"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#146">[#146]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hiya guys, I can't test anything for a month as im on vacation in Thailand but I just checked in for a flying visit o see what was happening in blitzmax land :-)<br><br>Dx11 is geared around batching and instancing but it obviously does allow for single operations. On top of which you can multitask to a certain fashion to squeeze some more out out it. After working with vulkan for a good few months i want to at least add some additions to the dx11 driver to take advantage of its features.<br><br>If you guys wouldn't mind to think up some things that you'd like to have included then we can plan on getting them in. I can either add to existing driver or if features clash with existing driver code then I'll make a new v2 . I've already seen significant speed gains for a quad renderer that uses the geometry shader to create the vertices etc. <br><br></td></tr></table><br>
<a name="1318698"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#147">[#147]</a></td></tr></table></td></tr><tr ><td class="posttext"> I would like to see things being backported to DX9 as much as possible ... as most of my devices here lack on DX11 support (IGP of ancient laptops).<br><br>What people would surely like to see too , is some kind of cross platform shader support (at least post processing) and or cross-engine (DX + OGL) render2texture.<br><br><br>Dunno what could be "useable" for others ... but that's are things I would surely see benefits for "casual game/prototype" developers.<br><br><br>bye<br>Ron <br><br></td></tr></table><br>
<a name="1318745"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#148">[#148]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> The solidblend isn't needed at all.  <br></div><br>Thanks for looking Ron, I know the SOLID_BLEND isnt needed in this case but I was trying to mirror what was happening in my proper game code.<br><br><div class="quote"> But similar "changes" happen to SetAlpha() and other calls. Maybe the pure "mass" of sprites (and their drawing/alpha/color/...calls) add up a bit? <br></div><br><br>On this PC at work (Core i5 650, 8GB, 64Bit Win7, Intel HD graphics) I get the following:<br><pre class=code>DX11: 4FPS
DX9: 18FPS
OpenGL: 21FPS</pre><br><br>If I remove the alpha calls in the render:<br><pre class=code>DX11: 6-7FPS
DX9: 19FPS
OpenGL: 18FPS</pre><br><br>So remove all the alpha calls do help a tiny bit.<br><br><div class="quote"> Dx11 is geared around batching and instancing  <br></div><br>I think this may be the issue - Thanks for replying Dave, hope you are enjoying your holiday! (Keep safe too!)<br><br>Also the game is using fixed rate logic at 200Hz, so it is going thru the update loop quite a few times! In the game I have "only" 1000 snow flakes but I can still see performance issues. <br><br></td></tr></table><br>
<a name="1318966"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#149">[#149]</a></td></tr></table></td></tr><tr ><td class="posttext"> Render to texture is easy enough for dx and gl, which can also make the virtual resolution feature of 'max redundant when you just render to a quad <br>what existing things are you referring to'to be back ported'? Or do you mean any newer features?<br><br>For dx11 there already exists a function to draw instanced / batched sprites, I can't remember the name of it but i remember demoing the fireworks example with it, maybe it's works investigating? <br><br></td></tr></table><br>
<a name="1319031"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#150">[#150]</a></td></tr></table></td></tr><tr ><td class="posttext"> @ backport<br><br>I was talking about eg. "render to texture". I would like to see such features  for the supported engines (DX 7 ...ok no must ;-), DX9, DX11, OGL - and maybe even GL2SDL from BMX-NGs SDL.mod - for android/IOS targets).<br><br>So you as BlitzMax developer are able to use it for all platforms ... just like "SetAlpha" or "DrawImage".<br><br>I think "render to texture" is one of the most "benefit providing" extension for casual game developers (just think of that "popping up" dialogues ... which are not that easily doable currently, with all that scaling GUI elements, text rendered on the dialogue ... ). It also makes "text caching" (1 texture instead of 5000 glyphs rendered each time) a breeze.<br><br><br><br>Shaders: I think together with "render to texture" it allows for "fade out background while modal dialogue is active" effects and other "simpler ones" (of course you could achieve way more ... eg. making a water-rendered-to-texture-surface get displaced a bit for wavyness). <br><br><br>I do not need 3D or so - just to make life for 2D-game/tool-devs easier on BlitzMax.<br><br><br>AND ... why am I "requesting" it here? If ONE dev writes that thing, it will be made similar for all engines - instead of one knowing about OGL and DX9 but not DX11 or only about DX9 and DX11 ... <br>I just want to avoid that it is a kludge out of multiple different solutions - not accepting the same params or having different meanings (0 - 1.0 VS 0-255) and so on.<br><br><br>@ virtual resolution<br>Hmm, yes, you then could get rid of that - IF that was as fast as using a scaling + offset (not sure about that "IF").<br><br><br><br>PS: have fun on your vacation.<br><br><br>bye<br>ron <br><br></td></tr></table><br>
<a name="1319053"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#151">[#151]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, no probs, what kind of api types/methods/funcitons do you think woud be best?<br><br>I think<br><br>Type TRenderTarget<br>    Method Create:TRenderTarget(Width, Height, [Depth])<br>    Method SetAsRenderTarget() <br><br></td></tr></table><br>
<a name="1319057"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#152">[#152]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, no probs, what kind of api types/methods/functions do you think would be best?<br><br>I think<br><br>Interface IRenderTarget<br>    Method Create:TRenderTarget(Width, Height)<br>    Method Destroy<br>    Method SetAsRenderTarget<br><br>Interface IGLRenderTarget Extends IRenderTarget<br><br>Interface ID3D11RenderTarget Extends IRenderTarget<br><br>Interface ID3D9RenderTarget Extends IRenderTarget<br>    Method OnD3DDeviceLost()<br>    Method OnD3DDeviceReset()<br><br><br><br>Type TGLRenderTarget Implements IGLRenderTarget<br>Type TD3DRenderTarget Implements ID3DRenderTarget<br><br>For Dx9, as you can see we need to handle device lost/reset scenarios because the resource needs to be destroyed and recreated. We'll need a callback function for freeing up the resources when the device is lost - via fullscreen changes for eg. GL/D3D11 doesn't need that. That's not so difficult but will need a small change in a BRL/D3D9 module.<br><br>Any thoughts? <br><br></td></tr></table><br>
<a name="1319103"></a>

<a name="1319104"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#153">[#153]</a></td></tr></table></td></tr><tr ><td class="posttext"> I am fine with changes in the "BRL/D3D9-Module" - if the changes are acceptable by Brucey for "maxmods" (as long as "backwards compatibility" is there, I think it is ok).<br><br><br>@ Interface<br>Remember that "vanilla" does not have interfaces, so you surely will stay with types. Your code does not really need interfaces as it does not mix in things from different "parentS"... does it?<br><br><br>@ functions<br>Yes, and as people do not like to do "img.draw()" but "DrawImage()" you need "SetRenderTarget(img:Timage)" as convenience function.<br><br>So your sample code would look like that:<br><br><br><pre class=code>
'graphics initialization ...
'... done

global rtt:TImage = CreateImage(DeviceWidth(), DeviceHeight())
global rttPix:TPixmap = LockImage(rtt)
rttPix.Clear(0)

SetRenderTarget(rtt)
For local i :int = 0 to 1000
  SetColor rand(0,255), rand(0,255), rand(0,255) 
  DrawText("Hey there", rand(0, rtt.width-1), rand(0, rtt.height-1))
Next
SetColor 255,255,255
SetRenderTarget(null)
'or ?
RemoveRenderTarget() 

Repeat
  cls
  DrawImage(rtt, MouseX(), MouseY())
  Flip
Until KeyHit(KEY_ESCAPE) or AppTerminate()
</pre><br><br>(code untested for syntax errors, just a "sketch")<br><br><br>bye<br>Ron <br><br></td></tr></table><br>
<a name="1319658"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#154">[#154]</a></td></tr></table></td></tr><tr ><td class="posttext"> Happy holidays Dave! :) <br><br></td></tr></table><br>
<a name="1320623"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#155">[#155]</a></td></tr></table></td></tr><tr ><td class="posttext"> Looks like the driver has a memory leak of some kind in Windows 10 at least...<br><br>Just testing my latest game and after about 20 mins in an automated mode (ie the computer clicks on the onscreen buttons), the screen rendering stops updating and I have to kill it via Task Manager.<br><br>Using the win32 extern GlobalMemoryStatus, after 20 mins, it states it has eaten 1300MB... when using OpenGL after an hour its only eaten 120MB and doesnt stop, and when using DX9 it has only used 260MB after an hour and a half. <br><br></td></tr></table><br>
<a name="1320627"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#156">[#156]</a></td></tr></table></td></tr><tr ><td class="posttext"> @ therevills<br>Are you able to reproduce this with a smaller example?<br>... just to also narrow it down to a specific function-constellation.<br><br><br>bye<br>Ron <br><br></td></tr></table><br>
<a name="1320702"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#157">[#157]</a></td></tr></table></td></tr><tr ><td class="posttext"> Once my current game is done, I'll look into trying to create a sample - good idea Ron. <br><br></td></tr></table><br>
<a name="1322065"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#158">[#158]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks guys! I had a great time in Thailand. What a beautiful place with beautiful people! Everyone is always smiling :-)<br><br>Back on topic...<br>I'm initially against the idea of having a TPixmap available from a 'rendered to' image. The whole point of being able to render to a texture/image is to be able to do it in the main loop 'on the fly'. 'Offline' rendering, ie rendering outside of the mainloop is already achievable with TPixmaps and TImages. The issue being that an image is loaded from disk as a TPixmap, then a TImage is created from it. That TImage is sent to the display when needed. To get a TPixmap from a 'rendered to' image would mean grabbing the backbuffer, and we all know how terribly slow that is. I'm open to change my mind though if you have a very good reason(s).<br><br>Your initial code also proposes that all TImages should have the capability of being rendered to, similar to b3d, is that what you envisage?<br><br>@therevills<br>Do you have an example to reproduce the memory leak? <br><br></td></tr></table><br>
<a name="1322191"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#159">[#159]</a></td></tr></table></td></tr><tr ><td class="posttext"> @ render to Timage<br>Yes i thought of using timage / pixmap for targets.<br>Couldnt you create a kind of extended types for "gpu images" rather "tpixmap images"?<br><br>I mean somethIng which grabs from the gpu if needed but else does everything on the gpu. so lockimage() would additionally fetch the image data from the gpu while drawing to the image would try to do that purly on the gpu.<br><br><br>Intention is to be able to create images without grabpixmap calls or to fall back to software rendering. And the less adjustments to code have to be done...the better. So I thought using TImage/Tpixmap would be a good thing.<br><br><br>Bye<br>Ron <br><br></td></tr></table><br>
<a name="1324150"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#160">[#160]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've not had a chance to get to this since I came back from vacation.<br>I have some free time this weekend so will get the render to texture feature up and running this weekend. <br><br></td></tr></table><br>
<a name="1324218"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#161">[#161]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've started a new thread for the render to texture addition over <a href="/posts.php?topic=107108" target="_blank">here</a> <br><br></td></tr></table><br>
<a name="1325054"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >seriouslee</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#162">[#162]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey Col, encountered a couple of errors using the latest in Git on the latest of NG. I put in an issue on github, not sure if that's what you'd like or not.<br><br>Thanks! <br><br></td></tr></table><br>
<a name="1325086"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#163">[#163]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hiya,<br><br>Yes, all comments/issues are welcome :O)<br><br>Thanks! <br><br></td></tr></table><br>
<a name="1325136"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#164">[#164]</a></td></tr></table></td></tr><tr ><td class="posttext"> Didn't compile anymore for me either using latest Blitzmax NG, don't remember the error but IIRC it was a duplicate identifier or something similar. <br><br></td></tr></table><br>
<a name="1325192"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#165">[#165]</a></td></tr></table></td></tr><tr ><td class="posttext"> Should be fixed now.<br><br>Thanks!! <br><br></td></tr></table><br>
<a name="1325297"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#166">[#166]</a></td></tr></table></td></tr><tr ><td class="posttext"> Still giving me an error: I checked out the latest NG pub.mod and NG brl.mod, as well as srs.mod, and compiling srs.mod  tells me the following:<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
[ 30%] Compiling:DeviceModeSettings.c
[ 46%] Processing:d3d11_common.bmx
[ 46%] Processing:d3d11shader.bmx
[ 46%] Processing:d3dcommon_common.bmx
[ 46%] Processing:dxgi_common.bmx
[ 46%] Processing:win32.bmx
[ 48%] Compiling:d3d11_common.bmx.release.win32.x86.c
[ 48%] Compiling:d3d11shader.bmx.release.win32.x86.c
[ 48%] Compiling:d3dcommon_common.bmx.release.win32.x86.c
[ 48%] Compiling:dxgi_common.bmx.release.win32.x86.c
[ 48%] Compiling:win32.bmx.release.win32.x86.c
[ 50%] Archiving:win32.release.win32.x86.a
c:/code/BlitzmaxNG510/MinGW32/bin/ar.exe: creating c:/code/BlitzmaxNG510/mod/srs.mod/win32.mod/win32.release.win32.x86.a
[ 50%] Processing:d3dcommon_ng.bmx
[ 51%] Compiling:d3dcommon_ng.bmx.release.win32.x86.c
[ 57%] Processing:d3dcompiler_ng.bmx
[ 57%] Processing:dxgi_ng.bmx
Compile Error: Duplicate identifier 'iunknown_' found in module 'pub.win32' and module 'srs.win32'.
[c:/code/BlitzmaxNG510/mod/srs.mod/directx11.mod/dxgi_ng.bmx;29;0]
Build Error: failed to compile (-1) c:/code/BlitzmaxNG510/mod/srs.mod/directx11.mod/dxgi_ng.bmx
</textarea> <br><br></td></tr></table><br>
<a name="1325302"></a>

<a name="1325303"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#167">[#167]</a></td></tr></table></td></tr><tr ><td class="posttext"> The srs.win32 code has been removed in the latest commit.<br>It was only home to a single interface that Brucey has now put into the pub.win32 code - hence the duplicate error.<br><br>I can only think that the error comes from not being rebuilt properly. Perhaps you hit compile as opposed to rebuild modules?<br><br>If so then it might be necessary to go in and delete the .bmx folders inside each of the folders inside the srs.mod folder.<br>Also, as I say the srs.mod/win32.mod folder can safely be deleted if it's still there. <br><br></td></tr></table><br>
<a name="1325382"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#168">[#168]</a></td></tr></table></td></tr><tr ><td class="posttext"> It looks like it's still in the github repository -- just now I deleted the srs.mod folder again, and after cloning <a href="https://github.com/SRSSoftware/srs.mod.git" target="_blank">https://github.com/SRSSoftware/srs.mod.git</a>  it did download srs.mod/win32.mod among others.<br><br>I tried to delete the win32.mod folder manually, but still can't compile it afterwards:<br><br><pre class=code>
[c:/code/BlitzmaxNG510/mod/srs.mod/directx11.mod/dxgi_ng.bmx;4;0]
Build Error: failed to compile (-1) c:/code/BlitzmaxNG510/mod/srs.mod/directx11.mod/dxgi_ng.bmx
c:\Code\BlitzMaxNG510\mod\srs.mod&gt;Compile Error: Can't find interface for module 'srs.win32'
[c:/code/BlitzmaxNG510/mod/srs.mod/directx11.mod/.bmx/d3dcommon_ng.bmx.release.win32.x86.i;3;0]
</pre> <br><br></td></tr></table><br>
<a name="1325393"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#169">[#169]</a></td></tr></table></td></tr><tr ><td class="posttext"> uugghhh I can see what's going on here.<br>Try again... <br><br></td></tr></table><br>
<a name="1325396"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#170">[#170]</a></td></tr></table></td></tr><tr ><td class="posttext"> That did the trick, thanks! <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
