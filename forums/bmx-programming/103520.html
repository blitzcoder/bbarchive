<!DOCTYPE html><html lang="en" ><head ><title >BlitzMax Printing</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >BlitzMax Printing</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >BlitzMax Printing</a><br><br>
<a name="1247095"></a>

<a name="1247386"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Scaremonger</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have put together a very early beta for a Blitzmax printing system which is currently Windows only.<br><br><a href="https://sourceforge.net/projects/itsprinting/files/?source=navbar" target="_blank">Download from here</a><br><br>Would this be something the community would be interested in seeing as a module? If so then I'd like to integrate with Max2D, does anyone have any experience in doing this?<br><br>Under Linux/MAC should I look at Bruceys Cairo module to create a PDF file and then use the CUPS API to print the file, or is there a better way to achieve this? <br><br></td></tr></table><br>
<a name="1247217"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >degac</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nice, something I need to try asap!<br>To be honest at the moment I'm using Brucey's solution (Cairo) to create PDF.<br>I discovered that - at the end of the story... - I need in the 95% of the situations a digital copy to keep/send/save... so PDF is mandatory. <br><br></td></tr></table><br>
<a name="1247288"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Henri</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm sure there is always room for a printing module as there isn't any solely for this purpose. I now there was a time I could have used one.<br><br>-Henri <br><br></td></tr></table><br>
<a name="1247294"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Likewise, definitely could come in handy from time to time. <br><br></td></tr></table><br>
<a name="1247296"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Scaremonger</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Cool. In that case I'll develop it for release as a module.<br><br>I've been looking at integrating into Max2d and using CreateGraphics() for the printer page.<br><br>If I use this approach I need to return the system state when I'm done printing so I need a way to SetGraphics() to the Printer Page and then SetGraphics() back to the screen when I'm done. brl.graphics contains a private variable _graphics containing this information but not a getGraphics() method to obtain it.<br><br>For the moment I'll create a set of page drawing functions.. <br><br></td></tr></table><br>
<a name="1247387"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Scaremonger</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <a href="https://sourceforge.net/projects/itsprinting/files/?" target="_blank">Version 0.0.2 BETA available on Sourceforge</a><br><br>Changelog:<br>* Converted into a module (Win32 Only)<br>* Added 12 new methods to TPrintPage<br>* Dimensions can be pixels, inches, centimeters or millimeters<br>* Amended arguments on drawText()<br>* Minor internal changes and bug fixes.<br><br>Additional methods include:<br>setColor(), width(), height(), xDPI(), yDPI(), drawRect(), Drawline(), moveTo(), LineTo(), drawImage(), drawPixmap() and setDimensions() <br><br></td></tr></table><br>
<a name="1247399"></a>

<a name="1247400"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> FYI, winspool.a appears to be missing from the win32 folder on the module download version.<br><br>I copied it from the other download, that let me compile the module.. The example (mostly) works on my PC, great work!<br><br>Couple of questions/observations:<br><br>1) Am I correct in that while it defaults to drawing coordinates in centimeters, you can also use pixels or inches? <br><br>2) noticed something odd: When I print to my real printer (Brother laserjet) it looks as expected, but when I print to a virtual printer (CutePDF, free download) which turns it into a PDF file, there's an extra line: It draws a black line with some aliasing artifacts from the upper left corner all the way down &amp; across the page at a 45 degree angle. It does not draw on top of the grey bar, so it's probably generated before that drawing command happens. I haven't seen those kind of artifacts happen with any other prints before.<br><br>3) Is there any way to do a "quick print" and go directly to your default printer instead of popping up the dialog box asking you what printer to use each time?<br><br>4) Is there any way to read the dimensions of a standard page before actually sending the print job to a device? <br><br></td></tr></table><br>
<a name="1247443"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Scaremonger</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> @xlsior<br><br>Many thanks; I've added winspool.a to the archive and uploaded version 0.0.2.1 to sourceforge.<br><br><div class="quote"> Am I correct in that while it defaults to drawing coordinates in centimeters, you can also use pixels or inches? <br></div><br>The X,Y values within the drawing functions, except Plot(), are based on the current Dimension (pixels, mm, cm or inches). You set the scaling factor you want through setDimensions(). It defaults to pixels.<br><br><div class="quote"> It draws a black line with some aliasing artifacts from the upper left corner all the way down &amp; across the page at a 45 degree angle. <br></div><br>This is generated by the following code, but I suspect the colour $001234 may be too feint to be printed. I've been using CutePDF too so I'll test it with my printer later.<br><pre class=code>
	For Local x%=0 To page.width( DIM_PIXEL )
		page.Plot( x, x, $1234 )
	Next
</pre><br><div class="quote"> Is there any way to do a "quick print" and go directly to your default printer instead of popping up the dialog box asking you what printer to use each time? <br></div><br>I can get the default printer so it should be possible. <i>Added to my to-do list</i><br><br><div class="quote"> Is there any way to read the dimensions of a standard page before actually sending the print job to a device? <br></div><br>The paper size is available immediately after the printer is selected, I currently expose this within the page as width() and height(). I will need to split up the printer selection and the actual page rendering. <i>Added to my to-do list</i><br><br>Incidentally width() and height() by default return the size in pixels which along with XDPI() and YDPI() can be used to identify the page size; however width() and height() also take an optional parameter to do this calculation for you. Just pass DIM_MM, DIM_CM or DIM_INCH and it will return the actual page size. <br><br></td></tr></table><br>
<a name="1247525"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Scaremonger</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> <a href="https://sourceforge.net/projects/itsprinting/files/?" target="_blank">Version 0.03</a> available on Sourceforge.<br><br>@xlsior<br><div class="quote"> Is there any way to do a "quick print" and go directly to your default printer instead of popping up the dialog box asking you what printer to use each time? <br></div><br>I have re-worked the library to include a constructor SelectDefaultPrinter() and added a new example to show it working.<br><br><div class="quote"> Is there any way to read the dimensions of a standard page before actually sending the print job to a device? <br></div><br>The page object is now available as long as the user has selected a printer (or the default printer has been used).<br><br>For example:<br><br><pre class=code>
Local prn:TPrinter = New TPrinter.selectDefaultPrinter()

If prn.selected() Then
	Local paper:TPrintPage = prn.page()
	Print "PRINTER:    "+ prn.printerName()
	Print "SIZE:       "+ paper.width( DIM_CM ) + " x " + paper.height( DIM_CM ) + " cm"
	Print "RESOLUTION: "+ paper.xdpi() + " x " + paper.ydpi() + " dpi"
	
	If prn.Print( "My First Print Job", PageRender ) Then Print "Success..."
End If
</pre> <br><br></td></tr></table><br>
<a name="1273825"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chalky</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Apologies for bumping a 9 month old thread, but this is really great - do you plan on developing it any further? <br><br></td></tr></table><br>
<a name="1273856"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Scaremonger</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Not with my current workload, was there anything in particular you were looking for? <br><br></td></tr></table><br>
<a name="1273920"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chalky</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have been trying to add more text functionality (change font; font size; text colour etc.) to your mod but have so far failed as your code is too clever for me and I am struggling to understand how it all fits together.<br><br>A while ago I wrote (and still have) a VB6 DLL which had the following:<br><pre class=code>
DrawArc, DrawCircle, DrawImage, DrawLine, DrawPoint, DrawRect, DrawText, EndDoc, FreeImage, GetCurrentX, GetCurrentY, GetDeviceName, GetDriverName, GetFonts,
GetImageHeight, GetImageWidth, GetPageHeight, GetPageWidth, GetPrinters, GetPort, LoadImage, NewPage, ShowPrinter, SetColorMode, SetCopies, SetDrawMode,
SetDrawStyle, SetDuplex, SetFillColor, SetFillStyle, SetFontBold, SetFontItalic, SetFontName, SetFontSize, SetFontStrikethru, SetFontTransparent, SetFontUnderline,
SetForeColor, SetOrientation, SetPaperSize, SetPrinter, SetPrintQuality, SetScaleMode, TextHeight, TextWidth
</pre><br>Unfortunately I never got the "ShowPrinter" method (which was meant to call/display PrintDlg) to work from within BlitzMax (programs MAV'd whenever it was invoked) due to VB6 needing to pass it a valid HDC, and I couldn't work out how to supply one since neither retrieving the desktop HDC or my program's window HDC solved the issue.<br><br>Your mod is much neater than my DLL as: a) PrintDlg actually works!; and b) no external DLL is required. However I totally understand about spare time vs workloads. What you've given us is great - I simply need to try harder when fathoming how you did it so that one day I might be able to expand it with my DLL functionality. <br><br></td></tr></table><br>
<a name="1282173"></a>

<a name="1282174"></a>

<a name="1282175"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Fielder</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm using right now the latest release (i think) the V0.03, it's working fine but when i print a page the spool size become 75 Mbytes  (???) i'm printing on a a4 paper.. and this enormous file needs 30 seconds to be processed...<br><br>there is a way to decrease DPIs or to speed up the rendering/spool ?<br><br>thank you to everyone that can help me :)<br><br>P.S. is the "SetPrintQuality"-similar command that i need? (i'm talking about "It's Printing") <br><br></td></tr></table><br>
<a name="1282364"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Scaremonger</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> <a href="https://sourceforge.net/projects/itsprinting/files/?" target="_blank">Version 0.04</a> available on Sourceforge.<br><br>I have Partially integrated Max2D functions into the page functionality, so you now have to call SetGraphics( Printer ) before using the drawing functions. When you have finished, you need to restore it back to your screen. I'm not sure if this is really an improvement or makes it more complex, so please let me know what you think.<br><br>Features:<br>* setcolor()	- Now using MAX2D<br>* plot()	- Now using MAX2D<br>* drawline()	- Now using MAX2D<br>* drawrect()	- Now using MAX2D<br><br>NEW in Version 0.04:<br>* setgraphics( Printer )<br>* drawoval( x, y, w, h )<br>* page.selectfont( face$, points, bold?, italic?, underline?, strikeout? )<br><br><b>@Fielder</b><br><div class="quote"> when i print a page the spool size become 75 Mbytes (???) i'm printing on a a4 paper.. and this enormous file needs 30 seconds to be processed <br></div><br>The Page Size and DPI used by the module are taken from the printer capabilities that you select when the dialog box appears. These are configured in your printer options, but they can be changed in the dialog box too (Click Properties | Advanced | Print-Quality to change DPI).<br><br>Looking through the API I can change these values, but the current structure of the module will need changing so that there is an extra function call between printer selection and the page print routine. I'll have a look over the next few days. <br><br></td></tr></table><br>
<a name="1282404"></a>

<a name="1282405"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Fielder</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thank you very much Scaremonger for your great MOD!<br><br>for the DPIs... the issue is that laser printers have 600 or 1200 dpi resolutions... and i've not the choice of value lower than 600 (i've tried 2 HP printers) and at 600 the spool is 75mb... <br><br></td></tr></table><br>
<a name="1282475"></a>

<a name="1282479"></a>

<a name="1282480"></a>

<a name="1282481"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Fielder</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Found my issue for long times and large Spool.... <br><br>IMAGES<br><br>if i place a 600x800 image (that is just 2.5x3.5 cm on paper) the rendering time become very huge...<br><br>and on images the coords on floating points doesn't works.. all rounded to INTs<br><br>for example:<br><br>	page.DrawImage( image, 2, 1 )<br><br>is equal that <br><br>	page.DrawImage( image, 2.3 , 1.5 )<br><br><br>by the way ,  great work Scaremonger! <br><br></td></tr></table><br>
<a name="1282561"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Scaremonger</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br><br>Thanks for identifying the issue, I had noticed in the examples that the Cactus size changed depending on what resolution I selected and I've added it to my bug-list, however I didn't associate the two until now.<br><br>INT's on the methods has been added to the buglist.<br><br>I'm working on several improvements to the module too. Watch this space... <br><br></td></tr></table><br>
<a name="1282563"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Takis76</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> I like it very much.<br>I would like to ask , if is it possible to print unicode fonts? or fonts in other languages. <br><br></td></tr></table><br>
<a name="1282588"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Fielder</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>I'm working on several improvements to the module too. Watch this space... <br> <br></div><br>Thank you again! <br><br></td></tr></table><br>
<a name="1282628"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chalky</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thank you Scaremonger - your continued work on this is much appreciated. <br><br></td></tr></table><br>
<a name="1282798"></a>

<a name="1282803"></a>

<a name="1282871"></a>

<a name="1282872"></a>

<a name="1282873"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Fielder</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> when i use a d3d9 graphics mode:<br><pre class=code>
					SetGraphicsDriver D3D9Max2DDriver()
					Graphics 300,200
</pre><br><br>i need to remove this :<br><pre class=code>
SetGraphics( Printer )
</pre><br>from the printing code... <br>when print is done.. i can't have again the window refresh... (image freezed)<br>i need to reinitialize the d3d9 driver again.. using again the code<br><pre class=code>
					SetGraphicsDriver D3D9Max2DDriver()
					Graphics 300,200
</pre><br><br>to do a multiple print is this the correct way?<br><pre class=code>
Global Printer:TPrinter = New TPrinter

If Printer.Print( "My First Print Job", PageRender ) Then Print "Success..."

Printer:TPrinter = New TPrinter     'reinit the Printer? whitout closing it? removing this line the 2nd print doesn't starts

If Printer.Print( "My second Print Job", PageRender ) Then Print "Success..."

Printer.close()	'# Cleans up Printer, Page and Fonts.
</pre><br><br><br>And also... seems that the "font name" is not working.. iif i select the Tahoma.. or Courier new , the font is the Arial. <br><br></td></tr></table><br>
<a name="1282801"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is very well done, Scaremonger!<br><br>The whole arrangement of Printer communication in Windows is unnecessarily complicated because it has been added to and built up over the years and of course, printers have been with computers for a long time. <br><br>I am curious as to whether it is capable to Print non-graphics windows, GUI objects (gadgets) / Canvases or Panels? Using this library? <br><br></td></tr></table><br>
<a name="1282922"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Scaremonger</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> <b>@Fielder:</b><br>If you save the TGraphics object when you create the graphics... <br><pre class=code>global Screen:TGraphics = Graphics 300,200</pre>You can then return to the screen again without re-initialising graphics like this:<br><pre class=code>SetGraphics( Screen )</pre>However; I am personally unhappy with some of the restrictions I have found when extending Max2D and I'm considering backtracking these methods to a previous Non-Max2D version.<br><br>You shouldn't need to re-initialise the printer; I've added this to my bug-list for the next release along with improvements to the Fonts library.<br><br><b>@_PJ_</b><br>At the moment printing is limited to Text, lines, rectangles, oval/circles, TImages and TPixmaps and there is basic functionality for Fonts and Colour. <br>I've added your request to the (rather long) list of things to do. <br><br></td></tr></table><br>
<a name="1282948"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Fielder</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thank you (again) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
