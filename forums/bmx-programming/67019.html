<!DOCTYPE html><html lang="en" ><head ><title >Can I store a list of method callback pointers?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Can I store a list of method callback pointers?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Can I store a list of method callback pointers?</a><br><br>
<a name="748286"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SofaKng</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'd like to store a list of method callback pointers and then iterate through them (at a later time) and call each one of them.<br><br>Is this possible?<br><br>Thanks...<br><br>- John<br><br>===&gt; UPDATE &lt;===<br><br>I figured it out...  I really didn't think BlitzMax was this powerful!<br><br>In case anybody is wondering, here is how I did it:<br><br><pre class=code>
  ' Delcare an array of callbacks functions...
  '
  ' Each callback function must be in format:
  '    Function xxxx : Int (Path : String)

  Field Funcs : Int (Path : String) [20]

  ' You can then access the array like any other array...

  ' Assuming Funcs[0] is assigned, then this will work:
  Funcs[0]("This is my path parameter.")
</pre> <br><br></td></tr></table><br>
<a name="748292"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SofaKng</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> The only thing I can't figure out is how to define a callback that takes no parameter and has no return type.<br><br>Is this possible?<br><br>I can just give the callback definition a return type of Int and then have the function not return anything, but this is sloppy... <br><br></td></tr></table><br>
<a name="748294"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> What's wrong with just..<br><br><pre class=code>
Field Func()
</pre><br><br>.. ? <br><br></td></tr></table><br>
<a name="748297"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SofaKng</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nice, thanks!<br><br>I was trying:<br><pre class=code>
  Field Funcs : () [20]
</pre><br><br>However, your code works just fine...<br><br><pre class=code>
  Field Funcs() [20]
</pre><br><br>I've read that actually all functions/methods default to an Int return type so I guess that's what is happening in the above examples.  That seems a little bit sloppy to me, but no big deal!<br><br>Once again, I really like the power of BlitzMax! <br><br></td></tr></table><br>
<a name="748304"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> The () defines it as a function type, like you would if you used `:int` or ':float', you just leave out the colon.<br><br>Funcs() is a function pointer<br><br>Function pointers are really cool. You can re-wire your app at runtime with them. <br><br></td></tr></table><br>
<a name="748523"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Stupid q: where is here a solution for method pointers?<br><br>Function pointers are no problem, but method pointers simply are impossible as they do not exist ... little missleading thread title. <br><br></td></tr></table><br>
<a name="748537"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here is my code idea from a previous thread about method pointers, which you might be happy to use for this purpose:<br><br><pre class=code>
Type MyType
   Field FieldA:Int
   Field FieldB:Float
   Field RedirectPrintIt(Value:Int,Who:MyType)

   Method New()
      RedirectPrintIt=ActuallyPrintIt 'default function
   End Function

   Method PrintIt(Value:Int)
      RedirectPrintIt(Value Var,Self)
   End Function

   Function ActuallyPrintIt(What:Int Var,Who:MyType Var)
      Print "Wow "+What
      Print Who.FieldA
      Print Who.FieldB
   End Function

   Function ActuallyDoSomethingElse(What:Int Var,Who:MyType Var)
      Print "Redirected! "+What
      Print Who.FieldA
      Print Who.FieldB
   End Function

End Type

Local Instance:MyType=New MyType
Instance.FieldA=10
Instance.FieldB=12.5
Instance.PrintIt(15)
Instance.RedirectPrintIt=MyType.ActuallyDoSomethingElse
Instance.PrintIt(15)
</pre><br>From here: <a href="http://www.blitzbasic.com/Community/posts.php?topic=65492#731769" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=65492#731769</a><br>"Since every instance of a type has the same methods, which are taken from the type definition itself, and there is no `custom method code` for each instance of the type, you might as well let functions within the type definition itself be the location of code. In that sense there isn't really any point using Methods at all. But then the only thing you're left with wanting to do is to to be able to access the instance's variables as if they are global within the instance and available across all the function calls within the instance. So then why not have some kind of lookup table of function pointers within the type, which would then be in the instance, which bundles together the `Self` as a parameter passed to the actual functions with code in them that are stored in the type definition ???? ie abstractify the function calls and insert scope changes before the real functions are called? Would that be sufficient to allow you to switch and change which functions are called from each instance, given that each instance now has its own indirect jump table with function pointers local to it?"<br><br>Does that work for you? <br><br></td></tr></table><br>
<a name="748541"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SofaKng</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Dreamore:  Good point.  In fact, I completely overlooked this and I actually DO want *METHOD* pointers and not function pointers.  In my testing I was using function pointers which is why it worked.<br><br>Is there any way to store method pointers?  If I understand correctly they are actually two pointers (one pointer to the object and another to the method).  A normal function pointer is simply one pointer.<br><br>Another question...<br><br>Can I store function pointers (and/or method pointers) in anything besides an array?  (eg. TList, TMap, etc...)  <br><br>Also, I'm a bit confused on multi-dimensional arrays in BlitzMax.<br><br>If I declare my array like this:<br><pre class=code>
Local Arr : Int[800, 600]
</pre><br><br>Wouldn't Arr[799, 599] be the last element?  I'm confused because BlitzMax allows you do this:<br><br><pre class=code>
  Arr[1000, 1000] = "Hello"
</pre><br><br>...without throwing an error!<br><br>Finally... (last question!)  Can you resize multi-dimensional arrays?  Is this slow to do?  (does it copy the entire array while copying it?)<br><br>Thanks again for all of your help!! <br><br></td></tr></table><br>
<a name="748543"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> See my post just above your message - you posted at the same time as me so maybe you didn't see it.<br><br>You can store function pointers wherever you like, in an array, a list, a type field, a local, a global, whatever.<br><br>I am not so sure on the array question. Did you compile with debug on, because I'd think you'd get an array bounds error.<br><br>Not sure about resizing multidimensional - look at `slices` in the documentation. <br><br></td></tr></table><br>
<a name="748556"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >grable</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> If I declare my array like this:<br><br>Local Arr : Int[800, 600]<br><br>Wouldn't Arr[799, 599] be the last element? I'm confused because BlitzMax allows you do this:<br><br>  Arr[1000, 1000] = "Hello"<br><br>...without throwing an error! <br></div><br><br>For speed reasons (i guess) indices are not checked at runtime in release mode.<br>But in debug mode they ARE checked. <br><br></td></tr></table><br>
<a name="748575"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Its more because the array debug part of the module is only imported in debug but not in release. If you need to test in in realtime because you didn't spend time on debugging state, then using Try - Catch - End Try should throw an exception in this case. <br><br></td></tr></table><br>
<a name="748755"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Memory Access Violations cause exceptions?<br><br>I was under the impression writing outside arrays in release mode would obliterate all your other variables and then perhaps cause a page fault which I'm pretty sure isn't going to be much help to anyone. <br><br></td></tr></table><br>
<a name="748963"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Erm in what way is using a Blitz Object a MAV thing if it is initialized?<br>Accessing a NULL object is a MAV, I agree.<br><br>Accessing a :Array with a not existing index thought is something which most languages see as reason to fire an Array Index out of Bound exception.<br><br>But I agree that it normally shouldn't happen. Correct code with ASSERT for preconditions, postconditions and invariants actually make sure that such a thing NEVER can happen at all. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
