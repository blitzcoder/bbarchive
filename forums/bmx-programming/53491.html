<!DOCTYPE html><html lang="en" ><head ><title >webcam linux</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >webcam linux</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >webcam linux</a><br><br>
<a name="597591"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >splinux</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> another topic related with the "serial port linux":<br>how could i grab pictures from a camera with Linux and BMax?<br>i have installed my quickcam clicksmart and works with gnome meeting.<br>now i have to grab images from BMax.<br>i know that camera is /dev/video0 and the module is spca5xx.<br><br>could anyone help me? <br><br></td></tr></table><br>
<a name="597594"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hummelpups</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> look at a C Forum for more information, google it!<br>can't be that difficult.<br>Is it USB? Or Com Port?<br><br>IMurDOOM <br><br></td></tr></table><br>
<a name="597687"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >splinux</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> it's usb.<br>logitech quickcam clicksmart 420.<br>module: SPCA5XX, the last. <br><br></td></tr></table><br>
<a name="597720"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chris C</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> check out video4linux, if your cam works with it there should be a library you can make a binding for.<br><br>I did see somthing about using libs on linux with max on the forum somewhere but I cant remember <br><br></td></tr></table><br>
<a name="597722"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >splinux</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> yes, but how could i dielogue with the module which controls the camera to grab images? <br><br></td></tr></table><br>
<a name="597974"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chris C</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> you need to read up on video4linux and research how to use a library (.a in linux) with blitzmax <br><br></td></tr></table><br>
<a name="600153"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >splinux</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> i found some sample code which i can compile(the code is c written).<br>i've tryied to import that file with bmx(that file has only the functions with a main to test them), make export for the main function and exec it.<br>now the problem is that to compile the c code i've used the -lSDL -lSDLmain params for gcc, but with bmax i can't, or not?<br>this is the question: could i set gcc params that bmk will use when compile?<br><br>PS: maybe i'll rewrite all the code using bmax or importing only a few commands<br>PS2: if it will work, i'll probably program a max mod for it, and public i under GPL. <br><br></td></tr></table><br>
<a name="601152"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >splinux</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> so? could i tell gcc to use lSDL and lSDLmain params? <br><br></td></tr></table><br>
<a name="601223"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chris C</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> you could but I wouldnt !!<br>I think import "-lSDL" used to work or somthing like but you should be looking at what the SDL portions actually *do* and writing max code for it... <br><br></td></tr></table><br>
<a name="601688"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >splinux</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> yes, but there is a function, creatergbsurfacefrom which i don't know what format use and transform into, so i need to experiment. <br><br></td></tr></table><br>
<a name="601700"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >splinux</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> ok. thanks.<br>i've tryied it and now it works.<br><br>i have no time to study all the video4linux api's docs, so i've searched for sample programs to learn from them.<br>there are a few very simple to save datas to *.pnm(so it has to be converted for bmax) and other ones which display the image on the video.<br>to display frames to the screen they use SDL libraries, and so there are a few other problems.<br>now that is resolved, it will be possible to do a program which will init-stop the cam and put it on the screen(with an update function).<br>probably i'll change it, however it could be fast.<br><br>maybe the next week i *could*(i have to see what i need to do) release a TEST version of the module, with just a few functions, but i don't know. <br><br></td></tr></table><br>
<a name="601705"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >splinux</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> ******************<br>PS: from a few days are appeared into the blitzshowcase section some topic about webcams, webcam programming and games with webcam, all using blitz3D.<br>i, for these reasons and other of mine, am interested into this project, a Linux Webcam Module for BMax, so i'll program it.<br>But, are there anyone other interested in it?<br>if other people is interested, i will search to speed up the things and release it as soon as possible, otherwise i'll be slower.<br>****************** <br><br></td></tr></table><br>
<a name="601709"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chris C</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> you could experiment replacing creatergbsurfacefrom with somthing that puts the pixels into an opengl texture, or if you poke about in the brl modules you might see a way to blat the pixles directly into the back buffer<br><br>Let me know how you get on, I have an old video4linux compatible tv card i might put back into my machine... <br><br></td></tr></table><br>
<a name="602003"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >splinux</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> i found other sources,..<br>i'm studying them. however there is one which uses opengl and svgalib.<br>it has that function with gl, so it will be simple to use with bmax.<br>i'm installing svgalib, but i don't think i'll use it, it's only to test that source.<br>maybe the piece of code gl written will be translated to max, so max will handle the camera's input.<br>all the help is welcome. <br><br></td></tr></table><br>
<a name="602048"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >splinux</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> after studyied the raw files formats, and some other c code, i found that every pixel is coded like this:<br>rgbrgbrgbrgbrgb... where r, g and b are single bytes. <br><br></td></tr></table><br>
<a name="602061"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chris C</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> so I guess you need to make an opengl texture with rgb format instead of rgba ?? <br><br></td></tr></table><br>
<a name="602065"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >splinux</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> or otherwise i can program a routine to write every pixel to the screen, or to an image.<br>however i still have many problems.<br>i didn't have much time to study the code.<br>maybe in a few days i will can make some previsions about a possible release.<br>actually i think it could be exit a demo release, with just a few functions. <br><br></td></tr></table><br>
<a name="602071"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chris C</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> i thought about looping through each 3 bytes at a time and writing them to a texture / screen but thats gonna be very slow.<br><br>I think somthing like opengl pbuffers might be the way to go... <br><br></td></tr></table><br>
<a name="602075"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >splinux</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> ok. however i can't get the image because of some problems with grabbing frames.<br>actually i have some 200 lines lenght c code, with some difficult parts to analyze.<br>some days ago i've got it, but i couldn't process it because i didn't know that format.<br>the file was deleted and now i have some problems, but many files, so i hope to program something into a few days. <br><br></td></tr></table><br>
<a name="602506"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >splinux</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> i think tomorrow i will rewrite the c code deviding it into various functions.<br>if anyone would like to help me, all the help is welcome. <br><br></td></tr></table><br>
<a name="602803"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chris C</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> post the c code maybe i can help convert some of it?? <br><br></td></tr></table><br>
<a name="602971"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >splinux</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> it's from a program called videodog.<br>it's one of the eldest sources of the program, modifyied to make a .pnm image, when the original program could only print the file content.<br>you have to compile it with gcc, and then exec it in this way:<br>./videodog -x 320 -y 240 -d /dev/video0 -w 3 -p<br>and it will create an a.pnm image.<br><br><div class="quote"> <br>#include &lt;stdio.h&gt;<br>#include &lt;unistd.h&gt;<br>#include &lt;stdlib.h&gt;<br>#include &lt;string.h&gt;<br>#include &lt;asm/types.h&gt;<br>#include &lt;linux/videodev.h&gt;<br>#include &lt;sys/mman.h&gt;<br>#include &lt;sys/ioctl.h&gt;<br>#include &lt;asm/types.h&gt;<br>#include &lt;sys/types.h&gt;<br>#include &lt;sys/stat.h&gt;<br>#include &lt;fcntl.h&gt;<br>#include &lt;signal.h&gt;<br>#define VERSION "0.06"<br>#define OPTSTR "hx:y:w:d:pu:c:b:l:sni:"<br>#define DOT fprintf(stderr,".");<br>void showhelp(void) {<br>fprintf (stderr,"Video Dog tool Version %s\n", VERSION);<br>fprintf (stderr,"Gleicon S. Moraes\n");<br>fprintf (stderr,"Options you really need:\n");<br>fprintf (stderr,"-x (number) image width\n");<br>fprintf (stderr,"-y (number) image height\n");<br>fprintf (stderr,"-w (number) image depth (in bytes) \n");<br>fprintf (stderr,"-d device (like /dev/video0 )\n");<br>fprintf (stderr,"-p set the output in pnm format (24 or 8 bits only)\n");<br>fprintf (stderr, "Other options :\n");<br>fprintf (stderr,"-h just show this lines, doesn't help you ok ?\n");<br>fprintf (stderr,"-i input number (0 is the default) \n");<br>fprintf (stderr,"-u image Hue\n");<br>fprintf (stderr,"-c image Contrast\n");<br>fprintf (stderr,"-b image Brightness \n");<br>fprintf (stderr,"-l image Colour\n");<br>fprintf (stderr,"-s show device report\n");<br>fprintf (stderr,"-n Dont capture an image, just setup the device (Useful if you want to correct something before start grabbing)\n");<br>exit(0);<br>}<br>/* global */<br>unsigned short int pnm=1;<br>FILE *fp;<br>int x=0, y=0, w=0;<br>unsigned char *v_device; /* device */<br>static struct video_picture grab_pic;<br>static struct video_capability grab_cap;<br>static struct video_channel grab_vid;<br>static struct video_mmap grab_buf;<br>static int grab_fd, grab_size;<br>static unsigned char *grab_data;<br>int hue=-1, contrast=-1, brightness=-1, colour=-1, nograb=0,<br>showc=0i, channel=0;<br>/* prototype */<br>void swap_rgb24(unsigned char *, int );<br>unsigned char* grab_one(int *, int *);<br>int grab_init();<br>/* signal handler */<br>void _sighandler (int sig) {<br>switch (sig){<br>case SIGINT: /* ctrl+x */<br>free (v_device);<br>close (grab_fd);<br>munmap(grab_data, grab_size);<br>fprintf (stderr, "Caught SIGINT - Cleaning \n");<br>break;<br>}<br>}<br>void set_picture() {<br>if (hue &gt; -1) grab_pic.hue=hue;<br>if (contrast &gt; -1) grab_pic.contrast=contrast;<br>if (brightness &gt; -1) grab_pic.brightness=brightness;<br>if (colour &gt; -1) grab_pic.colour=colour;<br>if (ioctl(grab_fd, VIDIOCSPICT, &amp;grab_pic) == -1) {<br>perror ("PICTURE");<br>exit (1);<br>}<br>}<br>void set_channel() { /* do nothing if the device doesn't<br>allow it */<br>if (ioctl(grab_fd, VIDIOCGCHAN, &amp;grab_vid) == -1) return;<br>grab_vid.channel=channel;<br>if (ioctl(grab_fd, VIDIOCSCHAN, &amp;grab_vid) == -1) return;<br>}<br>void show_cap() { /* mostra settings atuais */<br>fprintf (stderr,"\nVideo DOG tool Version %s\n", VERSION);<br>fprintf (stderr, "Device Name: %s\n", grab_cap.name);<br>fprintf (stderr, "Device: %s\n", v_device);<br>fprintf (stderr, "Max Width : %d\n", grab_cap.maxwidth);<br>fprintf (stderr, "Max Height : %d\n", grab_cap.maxheight);<br>fprintf (stderr, "Current Settings :\n\n");<br>fprintf (stderr, "\tInput : %i\n", grab_vid.channel);<br>fprintf (stderr, "\tBrightness : %i\n",<br>grab_pic.brightness);<br>fprintf (stderr, "\tHue : %i\n", grab_pic.hue);<br>fprintf (stderr, "\tColour : %i\n", grab_pic.colour);<br>fprintf (stderr, "\tContrast : %i\n", grab_pic.contrast);<br>fprintf (stderr, "\n");<br>}<br>int main (int argc, char **argv) {<br>int c;<br>signal (SIGINT, _sighandler);<br>while ((c = getopt (argc, argv, OPTSTR)) != EOF)<br>switch (c) {<br>case 'x':<br>x=atoi(optarg);<br>break;<br>case 'y':<br>y=atoi(optarg);<br>break;<br>case 'w':<br>w=atoi(optarg);<br>break;<br>case 'p':<br>pnm=1;<br>break;<br>case 'd':<br>v_device= (char *)malloc ((strlen(optarg) *<br>sizeof(char))+1);<br>memset(v_device, 0, strlen(optarg));<br>strncpy(v_device, optarg, strlen(optarg) -1<br>);<br>break;<br>case 'i':<br>channel=atoi(optarg);<br>break;<br>case 'u':<br>hue=atoi(optarg);<br>break;<br>case 'c':<br>contrast=atoi(optarg);<br>break;<br>case 'b':<br>brightness=atoi(optarg);<br>break;<br>case 'l':<br>colour=atoi(optarg);<br>break;<br>case 'n':<br>nograb=1;<br>break;<br>case 's':<br>showc=1;<br>break;<br>case 'h':<br>default:<br>showhelp();<br>break;<br>}<br>if (!x || !y || !w ) nograb=1;<br>if (!v_device) {<br>fprintf (stderr, " I NEED A DEVICE NAME \n");<br>showhelp();<br>}<br>grab_init();<br>set_picture();<br>set_channel();<br>if (showc) show_cap();<br>if (pnm) {<br>fp=fopen("a.pnm", "w+");<br>if (w == 1) {<br>fprintf(fp, "P5\n%d %d\n255\n", x, y);<br>}<br>if (w == 3) {<br>fprintf(fp, "P6\n%d %d\n255\n", x, y);<br>}<br>}<br>if (!nograb) fwrite ((unsigned char*)grab_one( &amp;x, &amp;y),x * y * w, 1, fp);<br>free (v_device);<br>close (grab_fd);<br>fclose(fp);<br>munmap(grab_data, grab_size);<br>} /* main */<br>void swap_rgb24(unsigned char *mem, int n) {<br>unsigned char c;<br>unsigned char *p = mem;<br>int i = n ;<br>while (--i) {<br>c = p[0];<br>p[0] = p[2];<br>p[2] = c;<br>p += 3;<br>}<br>}<br>int grab_init() {<br>if ((grab_fd = open(v_device,O_RDWR)) == -1 ) {<br>perror("open videodev");<br>exit(1);<br>}<br>if (ioctl(grab_fd,VIDIOCGCAP,&amp;grab_cap) == -1) {<br>fprintf(stderr,"wrong device\n");<br>exit(1);<br>}<br>memset (&amp;grab_pic, 0, sizeof(struct video_picture));<br>if (ioctl (grab_fd, VIDIOCGPICT, &amp;grab_pic) == -1) {<br>fprintf (stderr, "no pict");<br>exit(1);<br>}<br>switch (w) {<br>case 1:<br>grab_buf.format = VIDEO_PALETTE_GREY;<br>break;<br>case 2:<br>grab_buf.format = VIDEO_PALETTE_RGB565;<br>break;<br>case 3:<br>default:<br>grab_buf.format = VIDEO_PALETTE_RGB24;<br>break;<br>}<br>grab_buf.frame = 0;<br>grab_buf.width = x;<br>grab_buf.height = y;<br>grab_size = x * y * w;<br>grab_data =<br>mmap(0,grab_size,PROT_READ|PROT_WRITE,MAP_SHARED,grab_fd,0);<br>return(1);<br>}<br>unsigned char* grab_one(int *width, int *height) {<br>for (;;) {<br>if (-1 == ioctl(grab_fd,VIDIOCMCAPTURE,&amp;grab_buf)) {<br>perror("ioctl VIDIOCMCAPTURE");<br>} else {<br>if (-1 ==<br>ioctl(grab_fd,VIDIOCSYNC,&amp;grab_buf)) {<br>perror("ioctl VIDIOCSYNC");<br>} else {<br>//DOT<br>fprintf(stderr,"len: %d\n", grab_size);<br>if (w == 3) swap_rgb24(grab_data,<br>grab_buf.width * grab_buf.height);<br>*width = grab_buf.width;<br>*height = grab_buf.height;<br>return grab_data;<br>}<br>}<br>}<br>}<br> <br></div><br><br>PS: not ALL the code has to be used, only some functions(like grab_init and grab_one).<br>we could modify the main funcion naming it as cam_setup and then program a blitz interface to receive the data(returned by grab_one).<br>then we'll be able to convert it using ogl or blitz functions.<br>at the moment the only grab program i can make is using c, with max is more difficult because they will be liked toghether, passing datas each other.<br><br>in the future the program might have some functions to adjust/read the camera parameters.<br><br>PS2: in which way can i make a code box under this forum? <br><br></td></tr></table><br>
<a name="603097"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chris C</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> well the only thing I'm not sure about is usinf ioctl in max, but with a tiny bit of imported C code you could just call a routine that calls ioctl<br><br>extern<br>function m_ioctl(fd:int,dev:int,cap:byte ptr)<br>end extern<br><br>if you make an opengl texture with the GL_RGBA8 format you should then just be able to bind the texture and draw a quad using it... <br><br></td></tr></table><br>
<a name="603108"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >splinux</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> yes, but look at there lines of code:<br><div class="quote"> <br>unsigned char *v_device; /* device */<br>static struct video_picture grab_pic;<br>static struct video_capability grab_cap;<br>static struct video_channel grab_vid;<br>static struct video_mmap grab_buf;<br>static int grab_fd, grab_size;<br>static unsigned char *grab_data;<br> <br></div><br>how could i declare them with bmax? they use structs from videodev.h. <br><br></td></tr></table><br>
<a name="603114"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >splinux</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> oh, another thing: the c's open() hasn't a corresponding function in bmax, because bmax uses TStram to store the returned infos.<br>so, if we want to communicate with iotl, we have to use the c function importing it too. <br><br></td></tr></table><br>
<a name="603176"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chris C</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> yeah, it would probably be better to do most of it with C and import the C routines into a max file<br><br>max is really weak when you need to access C structs especially if they are nested<br><br>I'd do a C function that grabs a frame and puts it in a byte array supplied by max, then in max you can create a texture with and display it.<br><br>extern<br>grabinit(dev:string)<br>grab(buf:byte ptr) <br>end extern<br><br>you basically have all the C code to write the two routines <br><br></td></tr></table><br>
<a name="603370"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >splinux</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> we have to add a cam_close func because otherwise the camera will give us error.<br>good idea the grab(buf:byte ptr), so we don't have to call c:byte ptr=grab(), which<br> could give us problems returning the data and in this way is faster.<br>today i have many things to do(i'm configuring my new wireless router), however tomorrow i'll do most of the translation. <br><br></td></tr></table><br>
<a name="603835"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >splinux</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> ok. wireless is ok under Linux too.<br>now i can return working on this project.<br><br>that idea of write only 3 functions with c is great, however these functions will not be used by users, the users will use bmax written functions which will handle the primary 3.<br>just a moment and i'll start planning the module. <br><br></td></tr></table><br>
<a name="604415"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >splinux</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> Chris C: how much trnslation have you made? <br><br></td></tr></table><br>
<a name="604597"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chris C</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> none! I was just giving you pointers... WAY too busy at the moment, sorry if you got the wrong end of the stick... <br><br></td></tr></table><br>
<a name="604706"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >splinux</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#31">[#31]</a></td></tr></table></td></tr><tr ><td class="posttext"> i'm too busy, too, so i haven't translated anything.<br>i'll start maybe tomorrow. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
