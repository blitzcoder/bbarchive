<!DOCTYPE html><html lang="en" ><head ><title >Conflict between rigz.timelinefx &amp; bah.cegui mods</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Conflict between rigz.timelinefx &amp; bah.cegui mods</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Conflict between rigz.timelinefx &amp; bah.cegui mods</a><br><br>
<a name="1106609"></a>

<a name="1106610"></a>

<a name="1106611"></a>

<a name="1106612"></a>

<a name="1106613"></a>

<a name="1106614"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Armitage 1982</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi<br><br>First, I do not have the last bah.cegui version but <b>cegui.mod v0.6.2 (rev 783)</b>.<br><br>Does anyone using the TimelineFX module experiencing runtime crash while simply "import bah.cegui" ?<br>If not, does it work when using loadAnimImage with an incbin png ressources ?<br><br>While simply adding <b>Import bah.cegui</b> to the TimelineFX example (http://www.rigzsoft.co.uk/index.php?option=com_content&amp;view=article&amp;id=24:a-simple-program&amp;catid=5:module-help&amp;Itemid=18) the application crash at start.<br>And when I try to do the same in my game engine, I can reach the first loadAnimImage command before things crash (my engine do use cegui of course). Weird...<br><br>A debug version won't help either to locate the problem.<br>Think I will have to stick with my slow dumb particles engine :(<br><br><font class="tiny">Last edited 2011</font><br><br><font class="tiny">Last edited 2011</font><br><br><font class="tiny">Last edited 2011</font><br><br><font class="tiny">Last edited 2011</font><br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1106714"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Pete Rigz</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Armitage, I'll try and find the time to take a look at this. Is it the loadanimimage that is conflicting? <br><br></td></tr></table><br>
<a name="1106737"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Armitage 1982</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hard to tell,<br>I thing it as more to do with a low level OpenGl problem, because I can't catch any error in debug mode :(<br>Simply try to import Cegui in the TimelineFX should reproduce the problem.<br>If not, it's probably coming from my system. <br><br></td></tr></table><br>
<a name="1106905"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Armitage 1982</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> The only thing that log when in Debug Mode is this :<br><br><b>DebugLog:PASSTHROUGH</b><br><br>A bit hard to debug...<br>I just need to know if it's my version of Cegui that conflict with TimelineFX or if it's a general issue. <br><br></td></tr></table><br>
<a name="1107500"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Armitage 1982</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi<br><br>No news about this ?<br>Thank you. <br><br></td></tr></table><br>
<a name="1108545"></a>

<a name="1108546"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Armitage 1982</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think I find a solution.<br><br>This is a "badly" fixed example to use TimelineFX in conjunction with Cegui :<br><pre class=code>
SuperStrict
 
Import bah.cegui
Import rigz.timelinefx
Import rigz.Tweener

New TPixmapLoaderFI  'This will fix the brl.pixmap.LoadPixmap bug

'Load the effects library
Local MyEffectsLib:tlEffectsLibrary = LoadEffects("effects/examples.eff")
'Create an effect and assign it an effect from the library
Local MyEffect:tlEffect = MyEffectsLib.GetEffect("simple explosion 1")
'Create the particle manager to manage the particles
Local MyParticleManager:tlParticleManager = CreateParticleManager()

Graphics (1024, 768, 0) 
		 
'These commands are important to set the origin of the particle manager. For this example we're setting the origin so that
'effects will be placed at screen coordinates. If you leave out the setorigin command then an effect created at 0,0 would
'be placed at the center of the screen.
myparticlemanager.SetScreenSize(GraphicsWidth(), GraphicsHeight())
myparticlemanager.SetOrigin(GraphicsWidth() / 2, GraphicsHeight() / 2)
 
'This will make one frame equal 33 millisecs long - or 30 updates per second.
SetUpdateFrequency(30)
 
'Create a tweener using the tweener mod. Make sure its frequency matches that above
Local Tweener:tTweener = New tTweener.Create(30)
 
'Our main loop
While Not KeyDown(KEY_ESCAPE) Or AppTerminate()
 
  Cls
 
  If MouseHit(1)
    'to create an effect you need to use the copyeffect command, and copy the MyEffect you created earlier. 
    'You shouldn't use MyEffect as it is the template
    'for which is used to create effects you draw on screen.
    Local tempeffect:tlEffect = CopyEffect(myeffect, MyParticleManager)
    'Set the temp effect to the mouse coords
    tempeffect.setx(MouseX())
    tempeffect.sety(MouseY())
    'add the effect the the particle manager. Important, otherwise the particle manager would have nothing to update
    MyParticleManager.addeffect(tempeffect)
  End If
 
  'here is the timing code, update the tweener to get the number of ticks for this loop
  Tweener.Update()
 
  For Local Ticks:Int = 1 To Tweener.FrameTicks
    'Update the execution time for the tweener
    Tweener.UpdateExecutionTime()
    'Update the particle manager
    MyParticleManager.Update()
  Next
 
  'and finally draw the particles.
  MyParticleManager.DrawParticles(Tweener.Tween)
 
  Flip 0
 
Wend
</pre><br><br>First, I tracked the bug into the modified Indiepath <b>singlesurface.bmx</b> of TimeLineFX.<br><b>LoadSpriteEffect::LoadtAnimImage</b> Point me to the reasons of the crash.<br>This function normally use the <b>brl.pixmap.LoadPixmap</b>.<br>Unfortunately, this function is implemented by the module <b>bah.freeimage</b> used in <b>bah.cegui</b>.<br><br>This implementation is normally done at the end of the Freeimage module thanks to a <b>New TPixmapLoaderFI</b>, but, for some strange reasons, it's no more the case when you import Freeimage and TimeLineFX.<br><br>What I simply did is adding <pre class=code>New TPixmapLoaderFI</pre> just before any <b>LoadEffects</b> to ensure that LoadPixmap will correctly work.<br><br>Finding what's changing the LoadPixmap function in TimeLineFX is the key to  fix this particular case. But as soon as you know you have add <i>New TPixmapLoaderFI</i>, it's no big deal.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
