<!DOCTYPE html><html lang="en" ><head ><title >Slow images</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Slow images</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Slow images</a><br><br>
<a name="575707"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Eikon</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I am writing a 2D side scroller in Max and have been constantly running into speed issues through every step of its development. All of them seem to be linked to BMax's poor performance with large images. Here's a breakdown of my games frames per second as different portions of the rendering code are added in.<br><br>640x480x16<br><br>Blank Screen: 6,200 FPS<br><br>Render Map: 2 layers of 16 x 16 1.5 Scaled + Filtered Tiles<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
SetColor 255, 255, 255; SetScale 1.5, 1.5
a = 0; b = 0
If (playerList[myID].D = 1 Or scrollX &gt; 0) Then tmpXOff = 1 Else tmpXOff = 0
If (playerList[myID].D = 0 Or scrollX &lt; 0) And scrX &gt; 0 Then tmpXOff2 = 1; a = -1 Else tmpXOff2 = 0

For y = scrY To scrY + 18
	For x = scrX - tmpXOff2 To scrX + 26 + tmpXOff
		If map(x, y, 0) &lt;&gt; -1 Then DrawImage imgTiles, Int((a * 24) - scrollX), Int(b * 24), map(x, y, 0)
		If map(x, y, 1) &lt;&gt; -1 Then DrawImage imgTiles, Int((a * 24) - scrollX), Int(b * 24), map(x, y, 1)
		a:+1
	Next
	If tmpXOff2 = 1 Then a = -1 Else a = 0
	b:+1
Next
SetScale 1, 1
</textarea><br>Down to 2,600 FPS     O_o<br><br>Render 320x240 2x Scaled + Filtered Background Image: 1,500FPS<br><br>So here with only a tilemap and one background image showing, frames per second are already at 1,500 on my PC, and are around 200 on my less powerful laptop. How am I sopposed to add in anything else when something this basic brings a Radeon 7500 / P4 2.0Ghz laptop to its knees? I have the latest drivers on all my systems, and after much testing I am very disappointed with OpenGL performance in general. <br><br>I was planning on having two parallax scrolling backgrounds but this doesn't seem possible. Does anyone have any speed tips they can share? <br><br></td></tr></table><br>
<a name="575816"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TomToad</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Maybe you could try using DirectX instead of OpenGl.  I've been working on a scrolling game and decided to do some tests.  I found that with the OpenGl drivers, I was getting about 500 fps when the most was being drawn on the screen, and about 1000 with the least. <br>Using DirectX drivers, I got about 650fps with the most drawing and about 1200 with the least.<br>CPU and video card are<br>AMD XP 2400+ 2ghz: nVidia FX5200: <br><br>BTW, rendering a blank screen on my system only achieved appx 2000 fps.  You sure you were calculating the fps correctly?  Or were you really rendering a blank screen and not just flipping the backbuffer and counting how many times you could do that per second? <br><br></td></tr></table><br>
<a name="575844"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kuron</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> You are not alone, I am having similar issues.  The problem is BlitzMax does not support 2D, its 2D is "emulated" via 3D methods (whether using OpenGL or D3D7 drivers).  Hence, this is really hard on a graphics card, and when you have a lot of stuff going on at once, it will completely choke.  <br><br>An example, even on very good speced system here, the IGlass demos absolutely crawl because of the effects being used in them.  <br><br>Things like scaling, alpha blending, shadows are absolute FPS killers.  I get far worse performance with the DX7 drivers than with the OpenGL drivers.<br><br>I LOVE the core language of BMax, unfortunately using it for anything related to graphics, 2D, sprites, games has been disappointing due to the performance issues, not to mention the sound issues.<br><br>Hopefully the next update will fix some of the issues. <br><br></td></tr></table><br>
<a name="575866"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ferminho</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I disagree in using 3D in the background being something negative... I think pure 2D operations like alpha, scaling, rotating are far slower and having 3D acceleration for those is great.<br><br>I've seen some blitz3D/basic apps and realtime rotation/scaling was soo slow... <br><br></td></tr></table><br>
<a name="575882"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MadMax</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes I've found this too, Bmax is nice and its OOP stuff is interesting to use, but once you start wanting to do something serious it starts crawling. Sound is a nightmare.<br><br>This OOP is very nice from a programmers point of view, but maybe good old "spaguetti" code is faster. Let's hope future updates sort out these issues as Bmax has a lot of potencial. <br><br></td></tr></table><br>
<a name="575888"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> BMAX is 2d in 3d, each image is made up from a textured quad. If you have a large image then you are going to suffer from the same old fill-rate problem you would get with any game written in any language.<br><br>Things like blendmodes and rotation and scaling do not kill FPS, large images, large amounts of different images will kill FPS. You still have to play by the same rules you did with Blitz3d to keep FPS rates up. Keep the amount of surfaces to a minimum, BMAX will create a new surface for each image you load, try to pack many images into a single image as this will require only one surface to draw. Try to keep image(texture) sizes ^2, BMAX will resize if the image does not conform - hence major amounts of extra vidmem is used.<br><br>Conclusion: Treat the BMAX graphics engine like a Blitz3d single surface system. <br><br></td></tr></table><br>
<a name="575891"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kuron</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Things like blendmodes and rotation and scaling do not kill FPS, <br></div>Cute theory, but not true.  In the example codes simply disabling shadows and alphablending give a huge FPS boost, but this is par for the course and will be the same with any 3d game. <br><br></td></tr></table><br>
<a name="575894"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Rotation and Scaling will not have an impact since BMAX calculates each vertex position everytime you draw an image. Having said that, scaling an image so it fills a large proportion of the screen will impact performance but only because of fill-rate issues. <br><br>Blendmodes are handled by the 3d Hardware not software, disabling these could give an FPS boost on older 3D GFX hardware. <br><br>So this all points to a GFX Hardware problem and not an issue with BMAX. I suppose you could re-write the drawing function to ignore scaling and rotation, not sure if you'd get much of a boost though. <br><br></td></tr></table><br>
<a name="575895"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kuron</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Blendmodes are handled by the 3d Hardware not software, disabling these could give an FPS boost on older 3D GFX hardware. <br></div>It will give a boost on newer cards, too.  3D effects come with a price and that price has always been and will always be performance :c/  BMax is currently using dated version of OpenGL and D3D and cannot even take "full" advantage of newer graphics cards.  Granted in Eikon's case he is using a Radeon 7500 which came out back in 2001 and was a budget card.  However, with the dated versions of OpenGL &amp; D3D being used by BMax (which are equally as old, if not older than his video card), he should not be having any major performance hits.<br><br>OGL under B+ still blows away BMax in performance. <br><br></td></tr></table><br>
<a name="575925"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> You all know that 2D means no alpha, don't you?<br>This is the reason why it was used as actual 2D games without alpha aren't really doable :-) (and languages that tried so are really crap in it, like PureBasics FX stuff or SDL).<br><br>The reason this whole stuff gets that slow is because BM resends the whole vertex data with every image drawing instead of just changing their transformation. This is the bottleneck as it just "overloads" your graphic cards.<br>Even newest hardware can't handle it that good and pre-shader hardware with its unoptimized pipe will break far earlier than shader hardware.<br><br>Hopefully we will see an extended Max2D when Max3D is arriving using VBOs and similar stuff instead of creating every quad again with "glbegin,glend" everytime ... <br><br></td></tr></table><br>
<a name="575926"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Paradox7</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Will there every be a true 2D in blitzmax :( and not this 2d in 3d world we have <br><br></td></tr></table><br>
<a name="575933"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kuron</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> You all know that 2D means no alpha, don't you? <br></div>Depends on who is doing it ;c)  I have a DD 2D engine laying around that has very fast alpha blending.  Generally to get decent alphablending it means brushing up on your ASM skills and doing it the old fashioned way.  However alpha blending is slow as can be in IBPro when used on numerous sprites.  Its ok in PB which used D3D for alphablending (but then thats not true 2D).<br><br><div class="quote"> Will there every be a true 2D in blitzmax :( and not this 2d in 3d world we have  <br></div>No, because MS yanked DirectDraw when DX8 was released.  Even worse is DX10 will break backwards compatibility (as MS has been promising for over 5 years) and will run anything pre DX10 via software emulation which will be much slower.<br><br>However, DirectDraw has never been needed for 2D under Windows.  I have seen many 2D engines done in C++ that are strictly GDI and are extremely fast.  Much, much faster than the "software driver" in B+ and great performance even on systems with mobo video chips. <br><br></td></tr></table><br>
<a name="575936"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >altitudems</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm not sure why you guys are having trouble with speed. My engine runs perfect with over 2000 tiles, perpixel lighting, weather particles, etc. being drawn every frame.<br><br>You might want to check and see if your your issues arent solved by better memory/object managment.<br><br>All I worry about is making sure that someone with a 16-32mb video card and 1ghz processor get at least 75fps. If I can achieve this, I just use delta timing as a backup, and I'm set. <br><br></td></tr></table><br>
<a name="575943"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Eikon</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Seems like I struck a vein here. Thanks everyone for your replies that let me know I am not alone. <br><div class="quote"> <br>The reason this whole stuff gets that slow is because BM resends the whole vertex data with every image drawing instead of just changing their transformation. This is the bottleneck as it just "overloads" your graphic cards.<br>Even newest hardware can't handle it that good and pre-shader hardware with its unoptimized pipe will break far earlier than shader hardware.<br> <br></div><br>I have read about the problem you're talking about, Dreamora, and I seem to remember Simon saying he had a fix for that, but he never showed back up with the code. Here's hoping he can find the time to address this serious issue.<br><br><a href="http://blitzbasic.com/Community/posts.php?topic=48587&amp;hl=drawimagefast" target="_blank">http://blitzbasic.com/Community/posts.php?topic=48587&amp;hl=drawimagefast</a><br><br>@TomToad: I've tested with Direct3D and it seems slower in every case except on my laptop, where it performs about equal with OpenGL. In my experience D3D will only exceed OpenGL speed on outdated or integrated hardware. I'm also sure 6,200FPS is a correct reading. <br><br></td></tr></table><br>
<a name="575945"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> <a href="http://developer.nvidia.com/object/Top_Things_Kill_DX7.html" target="_blank">http://developer.nvidia.com/object/Top_Things_Kill_DX7.html</a> <br><br></td></tr></table><br>
<a name="575995"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> This drawimagefast things and other brought up optimations (like batch rendering) are only of little use. The gain is next to 0 with most "actual" GPUs but the needed cpu power to calculate this optimations in realtime is more then nothing. So its more of a lose than a win.<br><br>The only real optimations would be a switch to vertexobjects etc which are stored in VRAM. But this would have a bad impact on compatibility especially to office graphics hardware with their SiS, Intel and other onboard chipsets that wouldn't work anymore. So I think we won't have a that good chance to see a Max2D enhancement in that direction ... <br><br></td></tr></table><br>
<a name="576011"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> This drawimagefast things and other brought up optimations (like batch rendering) are only of little use. The gain is next to 0 with most "actual" GPUs but the needed cpu power to calculate this optimations in realtime is more then nothing. So its more of a lose than a win. <br></div><br><br>Firstly, you're wrong to group my drawimagefast suggestion together with batch rendering. There is zero overhead with my drawimagefast suggestion. It may or may not be a big gain, but it's all gain.<br><br>Secondly, your comments about batch renderinging are only true in theory. If the CPU was as out of date as the videocard, there might be some truth in what you say. Probably not much because CPU's are insanely fast these days, but maybe some. In practice, though, it's not like that. When you go into Fry's or BestBuy and buy a new PC, you can't buy a five year old CPU. The most underpowered CPU you can still buy is still insanely fast and more than capable of a little image sorting. The same is not true of videocards. While the chipsets are often newish, they're often about as capable as cards that are five years old. So even if there is a small CPU overhead in batch rendering, it's actually a good thing because it goes some way to redressing the imbalance between CPU's and GPU's in vaguely modern PC's. <br><br></td></tr></table><br>
<a name="576014"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you switch off filtering you should get a framerate improvement. That does consume quite  a bit extra effort usually.<br><br>I think also you would be better off having a tilemap made of 64x64 tiles rather than 16x16, as that's a whole lot more overhead to process the individual tiles, switching textures, etc.<br><br>Also you can use some OpenGL buffer tricks, maybe use the stencil or alpha buffer, so that you don't have to draw the texels that have already been drawn, ie don't waste time drawing on pixels that are already done.<br><br>I think BlitzMax is plenty fast enough with OpenGL. Maybe on the PC OpenGL is slower sometimes. If you look at the Platypus demo that was released in the showcase forum recently, it has LOTS of parallax scrolling and screen action with no slowdown. It's entirely possible. Maybe you are not thinking in a way that is cooperative for the way a graphics card works. There are different rules. <br><br></td></tr></table><br>
<a name="576017"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Syb: yours doesn't exist. the link above runs into an error. Thats why I assumed it was like other "fast draw" implementations that check for simple rebindings, which hasn't much effect as BM does not rebind if not needed as well.<br><br>I know that CPUs are extremely fast, although I only have an "old" P-M 1,6ghz.<br>But on systems that take advantage of batch rendering in 2D etc the CPUs won't be that fast and I think, spending all their power an enjoyable gameplay instead of reorganisation of data is the better choice, if you had to choose. But I think you agree in that.<br>If there is no choice that has to be done, then optimations like that can help :-) <br><br></td></tr></table><br>
<a name="576023"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> yours doesn't exist. the link above runs into an error. Thats why I assumed it was like other "fast draw" implementations that check for simple rebindings, which hasn't much effect as BM does not rebind if not needed as well. <br></div><br><br>It errors for me too, but since I suggested a command called DrawImageFast, I assumed it was mine. If it wasn't then, none of what I said applies. If it was, then my suggestion was specifically *not* to check anything. It was to give us a command which draws without doing the checking that BMax usually does, and forgoes the GLBegin..GLEnd pair. In other words, it lets us force fast drawing when we want to draw many copies of the same image ( particles? ) and does no checking. It's not error safe, but as I pointed out in my request, neither was writepixelfast in old versions of Blitz. You can't have everything, and since it's entirely optional, I think it's worth letting people do something silly if they can get a speed boost from it. You only need a warning in the docs. <br><br></td></tr></table><br>
<a name="576024"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nelvin</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> Batching vertices using the same renderstates/textures would be by far the BIGGEST possible performance boost. A single call to GL or D3D does have HUGE overhead, has to walk through several abstraction layers, has to do lots of additional tests to be as robust as possible and as fast as the given level of execution allows.<br>So batching the vertices each frame and sending them together to the graphics card is minimal overhead compared with sending each single blit.<br>It of course depends a lot on trianglesize - 100 fullscreen triangles won't get much faster by sending them batched to the graphics card, but thousands of polys used by tilemaps, particle systems etc. will get a lot faster.<br><br>Onboard vertexbuffers aren't of much help for the typical 2D needs - these are mainly used for instancing and/or vertexshaders (skeletal animations etc.)<br><br>A very thin but portable batching layer would be the best and most useful extension for Max2D. <br><br></td></tr></table><br>
<a name="576049"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dubious Drewski</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> Eikon, an initial framerate hit of 6200 to 2600 isn't something<br> to worry about.  The size of the <br>performance hits will reduce as more of the game is added.  <br>Eventually, when your game is completed, you'll still get <br>framerates of 100 - 200, and that's nothing to complain about. <br><br></td></tr></table><br>
<a name="576117"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Eventually, when your game is completed, you'll still get<br>framerates of 100 - 200, and that's nothing to complain about.  <br></div><br><br>You obviously didn't read carefully. He's down to 200 on the laptop now, with nothing but a tilemap and a background. Frankly, I'm not surprised. Tilemaps are *EXACTLY* what I had in mind when I suggested DrawImageFast or even better an optimized renderer. And was sadly ignored. <br><br></td></tr></table><br>
<a name="576364"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dubious Drewski</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> I see your point, Sybixsus. But, the first 3 lines in my post above are still true. <br><br></td></tr></table><br>
<a name="576439"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>Conclusion: Treat the BMAX graphics engine like a Blitz3d single surface system. <br> <br></div><br>I agree but how do you do this?<br>Loadanimimage will create seperate images for each frame. <br>If you loadimage, how do you reference only a portion of that image? Drawimagerect works differently.<br>Drawimageblock and drawimagerect in the code archives creates a new image on the fly (I think) which might help but I haven't got either to work...<br><a href="/codearcs.php?code=1422" target="_blank"> DrawImageRect </a><br><a href="/codearcs.php?code=1241" target="_blank"> DrawImageBlock </a> <br><br></td></tr></table><br>
<a name="576445"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Eikon</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> tonyg: If you loadimage, how do you reference only a portion of that image? Drawimagerect works differently. <br></div><br>I use this function here<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Function DrawImagePart(Image:TImage, DrawX#, DrawY#, PartX#, PartY#, PartWidth#, PartHeight#, Frame# = 0)
	Local OldX:Int
	Local OldY:Int
	Local OldWidth:Int
	Local OldHeight:Int
	
	Local ViewportX:Int = DrawX
	Local ViewportY:Int = DrawY
	
	' Save current viewport settings
	GetViewport(OldX, OldY, OldWidth, OldHeight)
	
	' Calculate viewport coordinates based on image's handle	
	If Image.Handle_X Then
		Local PercentX:Float
		PercentX = Float(Image.Handle_X) / Float(Image.Width)
		ViewportX = DrawX - (PercentX * PartWidth)
	EndIf
	If Image.Handle_Y Then
		Local PercentY:Float
		PercentY = Float(Image.Handle_Y) / Float(Image.Height)
		ViewportY = DrawY - (PercentY * PartHeight)
	EndIf
	
	SetViewport(ViewportX, ViewportY, PartWidth, PartHeight)
	DrawImage(Image, DrawX-PartX, DrawY-PartY, Frame)
	
	' Restore old viewport settings
	SetViewport(OldX, OldY, OldWidth, OldHeight)
End Function
</textarea><br>but all my testing has shown that using an AnimImage is faster than a single image and any DrawImageRect method I could find. <br><br></td></tr></table><br>
<a name="576514"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I agree but how do you do this?<br>Loadanimimage will create seperate images for each frame.<br>If you loadimage, how do you reference only a portion of that image? Drawimagerect works differently.<br>Drawimageblock and drawimagerect in the code archives creates a new image on the fly (I think) which might help but I haven't got either to work... <br></div><br><br>Are you sure LoadAnimImage makes seperate images?<br><br>Draw parts of an image using the SetUV command that I posted on this forum (it's somewhere, not idea how to find it). <br><br></td></tr></table><br>
<a name="576525"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Are you sure LoadAnimImage makes seperate images? <br></div><br>OMG its true, there is a seperate PixMap for each frame.<br><br>Now I know what I'll be doing today. <br><br></td></tr></table><br>
<a name="576575"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've written a new Type called TAnimImage, you can load your multiframe images into this very much like the LoadAnimImage BUT it only uses one texture and not several like the BRL command.<br><br>I got massive memory savings and speed increases : <a href="http://www.blitzbasic.com/Community/posts.php?topic=51647" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=51647</a> <br><br></td></tr></table><br>
<a name="576671"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kuron</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks dude.  Every little bit helps. <br><br></td></tr></table><br>
<a name="576684"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dubious Drewski</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#31">[#31]</a></td></tr></table></td></tr><tr ><td class="posttext"> Videogame Takeaway, that Type is great.  Well done, mate. <br><br></td></tr></table><br>
<a name="576881"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#32">[#32]</a></td></tr></table></td></tr><tr ><td class="posttext"> You guys are spoilt. Back in the old days, it was hard enough to get several objects to move around on a screen where the background wasn't even updated every frame, at 320x256 or similar resolution. Here you're playing with 800x600 resolutions, 32-bit color, and expecting it to just fly along. It's a lot of work to operate with these higher resolutions and color qualities. So how about some gratitude that things are as fast as they are?<br><br>Here I only have a GeForce 4MX - 64mb ram, and supposedly about 1 billion texels per second. It seems plenty fast enough that the recently released Platypus demo runs perfectly smoothly, 60fps scrolling with lots of overlapping masked parallax layers, plenty of enemies and on-screen movement, particle effect etc. As far as I'm concerned that is good performance, at 640x480 in 32-bit color (unless it's 16bit?, but still). Actually seeing that demo run is inspirational and brings a smile to my face knowing that I can likely, therefore, implement the kind of ideas I had in mind. <br><br>If you are seriously getting major slowdown with your tilemap engine maybe you need to rethink how you are implementing your game and how you are drawing your screen. I hope you aren't trying to draw 1000's of 16x16 individual images, for example? When you're working with OpenGL and hardware accelerated graphics, you really have to think differently that you might've thought in the past with software renderers and so on. You have to change your thinking and your approach, not just throw some old program into a new paradigm and expect it to work well. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
