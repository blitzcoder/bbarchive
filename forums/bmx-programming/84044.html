<!DOCTYPE html><html lang="en" ><head ><title >Vista weirdness...</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Vista weirdness...</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Vista weirdness...</a><br><br>
<a name="949049"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >marksibly</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br><br>I'm just trying to clean things up a little on Vista, but have discovered something very odd.<br><br>On my machine, if I run this app from a console as non-admin, the directories appear to get created - but they don't show up in explorer or even dos!<br><pre class=code>
Strict

CreateDir "c:\program files\bbhtml"
CreateDir "c:\program files\bbhtml\dir1"
CreateDir "c:\program files\bbhtml\dir2"

For Local t$=EachIn LoadDir( "c:\program files\bbhtml" )
	Print t
Next
</pre><br>On the other hand, running this as admin also creates the directories, only you *can* see them in explorer/dos.<br><br>I was under the impression that you *couldn't* create anything in program files unless you were admin, but from the above it appears you can, they're just not visible!<br><br>Anyone have any idea what might be going on here, or how I might be able to 'see' such hidden files?<br><br>I'm not good with Vista's admin/UAC stuff - and the deeper into it I go, the weirder it all gets. <br><br></td></tr></table><br>
<a name="949050"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Robert Cummings</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Try a unique name then doing a search as admin to see what shows up. <br><br></td></tr></table><br>
<a name="949053"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> i think you'be been virtualised!<br><br><div class="quote"> <br>Attempting to create or write a file or directory under a folder which does not grant write permission to the process will fail under Windows Vista if the application does not have administrative privileges. If your 32-bit game executable is running in legacy mode, because it did not declare a requested execution level, its write operations will succeed, but they will be subjected to virtualization as described in the section "UAC Compatibility with Older Games" later in this article.<br> <br></div><br><br><a href="http://msdn.microsoft.com/en-us/library/bb206295.aspx" target="_blank">http://msdn.microsoft.com/en-us/library/bb206295.aspx</a> <br><br></td></tr></table><br>
<a name="949057"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GaryV</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> They are being created, but are being put in your virtual store. <br><br></td></tr></table><br>
<a name="949060"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Been there been pissed off by that too.  Skid's link reveals all the stinky details.  If you turn off UAC it'll work otherwise you have to write to "approved" shared data locations AND if you want different users on the same PC to be able to access that data (read+write) then you need to set the correct security permissions to the files and folders which is a whole other painful situation.  My framework sorts all that stuff out and I think I posted the code on here somewhere before... <br><br></td></tr></table><br>
<a name="949064"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GaryV</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I'm not good with Vista's admin/UAC stuff - and the deeper into it I go, the weirder it all gets. <br></div>Keep in mind that with Vista, even when you're running as administrator you don't really have full administrator rights.  Only Vista itself has full administrator rights. <br><br></td></tr></table><br>
<a name="949065"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GaryV</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> As long as you follow Microsoft's development guidelines for the proper places to store data, then you will have no problem.<br><br>Like Grey suggests you can do hacks to write data to the program files directory, but Microsoft has made it clear this may not be supported in future versions of Windows.  They really want you to put the data where you are supposed to, not where you want to. <br><br></td></tr></table><br>
<a name="949083"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> GaryV: thats not fully correct.<br>If you kick out UAC you have near full Admin rights. There is only a very very small amount of stuff that is missing in comparision to XP Pro admin rights for example <br><br></td></tr></table><br>
<a name="949086"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> GaryV: thats not fully correct.<br>If you kick out UAC you have near full Admin rights. <br></div>Isn't that exactly what he said?? <br><br></td></tr></table><br>
<a name="949089"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> No<br>He said that you never have full admin rights.<br><br>If UAC is disabled &amp; you are on an admin account, you are, by XP standards, full admin on Vista <br><br></td></tr></table><br>
<a name="949208"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> But if you are distributing anything commercially you can't assume they've turned off UAC. <br><br></td></tr></table><br>
<a name="949215"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >markcw</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Relevant question:<br>If you install a program to:<br>'C:\Users\username\Documents' or 'C:\Users\username\AppData\Local'<br>is that the quick way round UAC? <br><br></td></tr></table><br>
<a name="949223"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tricky</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> As far as I know... Yes...<br>I personally use a portable harddrive to host both BlitzMax and the projects I write in it. This is the easiest way to get around UAC. <br><br></td></tr></table><br>
<a name="949250"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Snixx</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> *facepalm* <br><br></td></tr></table><br>
<a name="949256"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GaryV</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> If you kick out UAC you have near full Admin rights. <br></div><br>"near" doesn't mean full ;)  We are discussing Vista (as suggested in the initial post).  Comparing to XP's admin privileges is futile since they are vastly different.<br><br><div class="quote"> If you install a program to:<br>'C:\Users\username\Documents' or 'C:\Users\username\AppData\Local'<br>is that the quick way round UAC? <br></div><br>For now.  This may not be supported in the future.  MS has made hints that executable files may only be allowed in certain directories in the future.  <br><br>I am not sure what the aversion is to installing your game or app where it normally should be and then writing/saving data only to the directories you are supposed to.  It doesn't hurt to be courteous to your EU.  <br><br>This is nothing new, it has been the "proper" and "suggested" way to do it for a long time.  Unfortunately, MS had to start enforcing it because developers would not "play by the rules".<br><br>This thread should be a reminder to all of us to read MS's development guidelines for Vista and follow them.  It will save you a lot of trouble in the long run.  If stuff like this can grab Mark, it can grab all of us ;)<br><br><a href="http://msdn.microsoft.com/en-us/windows/default.aspx" target="_blank">http://msdn.microsoft.com/en-us/windows/default.aspx</a> <br><br></td></tr></table><br>
<a name="949295"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> While I understand the reasons MS is enforcing this, it really is unfortunate that the 'proper' way of doing things is such a mess with files spread over multiple directory hierarchys...<br><br>Personally I installed all of my programming-related tools under c:\code <br><br></td></tr></table><br>
<a name="949462"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TomToad</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> The files are being created in virtual storage.  This behavior is so that legacy programs that insist on writing to the Program Files directory will still work.  All the files are redirected to User/UserName/AppData/Local/VirtualStore/Program Files.  You can either navigate directly to that directory or reach it by opening the parent directory in the Program Files folder and clicking on Compatibility Files on the menu bar.<br>Strange thing though, if the parent directory is Program Files like in your example, then the Compatibility Files option doesn't appear in the menu bar, so you will need to navigate to it through the actual path. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
