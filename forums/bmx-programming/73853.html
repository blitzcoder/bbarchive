<!DOCTYPE html><html lang="en" ><head ><title >Float-coords producing weird anti-alias</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Float-coords producing weird anti-alias</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Float-coords producing weird anti-alias</a><br><br>
<a name="825179"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> First the result when drawing one sprite at x=100 and one at x=100.5:<br><br><img src="http://www.gamezworld.de/bilder/tvt_smeartest.png"><br><br>then the test-code:<br><pre class=code>
SetGraphicsDriver GLMax2DDriver()
Graphics 800,600,0
Global Test:TImage =LoadImage("tvt_smeartestimg.png", FILTEREDIMAGE)



Repeat
	Cls
	SetColor 255,255,0; DrawRect(150,100,50,100)
	SetColor 255,0,255; DrawRect(200,100,50,100)
	SetColor 0,0,255; DrawRect(250,100,50,100)
	SetColor 0,100,50; DrawRect(300,100,50,100)
	SetColor 255,255,255;	DrawRect(100,100,50,100)
	DrawImage(Test,100,100)
	DrawImage(Test,100.5,150)
	Flip 0
Until KeyHit(KEY_ENTER)
</pre><br><br>And the testfile:<br><img src="http://www.gamezworld.de/bilder/tvt_smeartestimg.png"><br><br><br>Why does this produce those jagged anti-alias outlines seen on the sprite drawn over the right rectangles (i know that white isn't as visible on the brighter rectangles ... but why isn't alpha-channel used there?).<br><br>Another thing is when drawing on a pixmap (I have all figure-sprites in one image, drawing player-colored sprites at the bottom) when now drawing them with integer-coordinates (120, 121 ...) everything is ok, but when using fractional coordinates (120.5,120.65,...) it's not only getting smeared/blurred (what's acceptable) but also blurred differently - so for example the dark skin-color used as face-border is drawn dark in one frame and brighter in the next and same for clothes etc.<br>This produces an akward visible defect (like blinking sprites).<br><br>Short: using non-fractional-coordinates everything works perfectly, using fractional-coordinates some disturbing effects are drawn. How to avoid?<br><br><br>bye<br>MB<br><br><b>edit:</b> Ok, without filteredImage the effect would be gone, but also the smoothness of the movement. <br><br></td></tr></table><br>
<a name="825184"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlackSp1der</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> your character pixels are merged with the transparent pixels, transparent pixels are alpha=0 rgb=255, you need to filter your image and set the transparent value to apha=0 rgb=0 to avoid this. <br><br></td></tr></table><br>
<a name="825192"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Robert Cummings</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> if its a png use Setblend Alphablend before drawing. <br><br></td></tr></table><br>
<a name="825239"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, sorry, forgot to set AlphaBlend to make a short example for my problem, within my app I use the correct Blendmode but only the single-figure-sprites (one figure per image instead of all figures with all their frames in one big image) get drawn properly.<br><br>So I'm sorry for the bad example, but the problem stays the same. But don't matter with it until I can provide a short code example showing the problem I want to solve.<br><br>So thanks and until the next problem ;D<br><br>bye<br>MB <br><br></td></tr></table><br>
<a name="825255"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ziggy</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> round the cords before drawing? I think this is correct behaviour when using non integer values as the engine is "mixing" pixels, isn't it? <br><br></td></tr></table><br>
<a name="825312"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> you need to filter your image and set the transparent value to apha=0 rgb=0 to avoid this <br></div><br><br>This is incorrect. Transparent pixels should have their alpha set to zero and their rgb colors set to the same as any solid neighbors for hardware filtering to work correctly. Here is a blitz3d example of the process required:<br><br><a href="/codearcs.php?code=1131" target="_blank">KeyImage Edge Correction algorithm</a> <br><br></td></tr></table><br>
<a name="825392"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Robert Cummings</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> If your drivers mip map settings are set to override stuff it can cause visual issues with textures.<br><br>Set to application preference if its the case. <br><br></td></tr></table><br>
<a name="825407"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlackSp1der</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> This is incorrect. Transparent pixels should have their alpha set to zero and their rgb colors set to the same as any solid neighbors <br></div><br>oh well, but I think I'm right and the problem is that the transparent pixel is in white and that's why it has that ugly border, the method you mentioned is the best but to put it all to zero is less complex and takes out that white border. <br><br></td></tr></table><br>
<a name="825456"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Search for defringe.  It's a neat little app that I use on all my graphics to solve that problem. <br><br></td></tr></table><br>
<a name="825463"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> The figures are hand-drawn (pixels set manually), so no defringe is needed.<br><br>the easy (and embarrassing for me) reason for the problem was the fact, that I placed different SetBlend-Commands around my app to save some fps and in my tries to optimize more (more sprites on one image) I changed order and all figures got drawn with MaskBlend instead of AlphaBlend... <br><br>Because special figures got drawn way before others I only checked those ones and they were alphablended... thats why my problem occoured and now I have to blush ;D.<br><br><br>TY for your help.<br><br>Now I hope I just have to wait for Mark's update (DX9 and reflection) to see again some nifty speed improvement.<br><br><br>bye<br>mB <br><br></td></tr></table><br>
<a name="825470"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> tada! <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
