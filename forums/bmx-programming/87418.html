<!DOCTYPE html><html lang="en" ><head ><title >TList.Remove() method uses overridable compare</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >TList.Remove() method uses overridable compare</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >TList.Remove() method uses overridable compare</a><br><br>
<a name="990710"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Muttley</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just got bitten by this.<br><br>TList uses the Compare method to find the link of the Object you wish to remove.  Unfortunately I'd overridden the Compare method to sort my renderable objects by Z-Depth.  This meant that when attempting to remove a specific renderable Object from the list it was removing the first renderable that had the same Z-Depth as the object I requested to be removed (which was a surprise to say the least).<br><br>This means that both TList.Remove(), TList.FindLink() and ListFindLink() don't really work as you would expect.<br><br>Is this working as designed, or an unexpected feature?<br><br>Cheers<br><br>Muttley <br><br></td></tr></table><br>
<a name="990771"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mark Tiffany</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> That might just explain a weird bug I had ages ago when trying to re-factor some MaxIDE code (to over-ride Compare instead of having a dedicated SortThisList function)... <br><br></td></tr></table><br>
<a name="990867"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Muttley</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm, not sure why this got moved here. At the very least this is a bug report as the Remove method is not doing what it says it will do. <br><br></td></tr></table><br>
<a name="990872"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tommo</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's not a bug. <br>TList.Remove uses "Compare" method to find the "matched" object and remove it.<br>You can extend TList and make your own version which doesn't use Compare for searching.<br><pre class=code>
Type TListRaw extends TList
Method FindLink:TLink( value:Object )
	Local link:TLink=_head._succ
	While link&lt;&gt;_head
		If link._value=value Return link
		link=link._succ
	Wend
End Method
End Type
</pre><br><br>The best way to remove a object in list is using TLink, which save you a lot of time from searching. <br><br></td></tr></table><br>
<a name="990874"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Muttley</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm aware of the possible workarounds, but storing the TLink in an object is not workable if your objects might be in one or more lists at the same time (for example).  Your objects would then need to know in advance that they will be added to lists, and that's not a good design practice.<br><br>It's more that the docs imply it will remove the exact object you provide, but actually deletes the first object that matches using the compare method, which may or may not be the object you've asked it to remove. <br><br></td></tr></table><br>
<a name="990879"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Oddball</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Why are you overriding the compare method? You can sort lists using the custom compare function parameter. <pre class=code>SortList list,True,ZSort

Function ZSort:Int( o1:Object, o2:Object )
	Return TMyType(o1).z-TMyType(o2).z
End Function</pre>This way you can sort your lists in multiple ways by using different custom compare functions, and best of all your compare method stays intact. <br><br></td></tr></table><br>
<a name="990883"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mahan</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just wanted to add some knowledge from another language that uses a similar mechanism in collections, Java:<br><br>In java, developers have a "contract" i.e. written rules about how the equals() and hashCode() methods must work to be 100% functional when used in conjunction with javas collections:<br><br>See link here:<br><a href="http://www.geocities.com/technofundo/tech/java/equalhash.html" target="_blank">http://www.geocities.com/technofundo/tech/java/equalhash.html</a><br><br>On the other hand I agree with Oddball here. To override compare() with the z-order comparision should imho not be expected to work in conjunction with the existing collection library.<br><br>You can almost hear it in the meaning of the word: "compare". It's meaning it insanely broad. What do we compare? An instance to another? One Z-order to another Z-order? Apples to oranges? Religions to Political ideologies?<br><br>This is where the java equals() contract comes in as a solution as it defines exactly what is expected of a possible implementation.<br><br>And maybe BlitzMax should have such a written contract for compare() too? <br><br></td></tr></table><br>
<a name="990908"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Instead of a TLink, give each object a list of TLinks :D <br><br></td></tr></table><br>
<a name="991101"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tommo</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> that's not a good design practice. <br></div><br>I agree with that. It also happens on TMap.<br>I encountered this at a similar situation. I was trying to sort a array by Z-depth, since sorting method of array only supports native Compare method, I had to override the Compare method. <br><br>It was a surprise when I found that TList/TMap uses Compares in searching. <br><br></td></tr></table><br>
<a name="991496"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Muttley</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Oddball: <div class="quote"> Why are you overriding the compare method? You can sort lists using the custom compare function parameter. <br></div><br><br>Well, for one the docs for the TList Sort method says: "User types should implement a Compare method in order to be sorted."<br><br>Secondly, I ran some tests which showed that using an overriden Compare method was up to 20% faster than using the SortList command with a sort function parameter.<br><br>@Mahan: In Java the compare()/compareTo() methods are only used for sorting and you will generally use whatever makes sense for the class itself, ie. sorting renderable objects on their z-depth makes perfect sense when you want to draw them in the correct order.  ;)<br><br>For checking equality the equals() method is used (as you mention) which can also be overriden, but if not defaults to comparing object references, not object values, which makes perfect sense.<br><br>I think the main issue here is the misleading docs. <br><br>Method: Remove( value:Object ) <br>Description: Remove an object from a linked list <br>Information: Remove scans a list for the specified value and removes its link.  <br><br>To me that implies it will remove the specific object you pass it and should therefore really be comparing the objects reference to those in the list, not using the method that's supposed to be used (according to the same docs) for sorting objects. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
