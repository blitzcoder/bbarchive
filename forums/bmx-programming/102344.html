<!DOCTYPE html><html lang="en" ><head ><title >Disable float/string localization on Linux?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Disable float/string localization on Linux?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Disable float/string localization on Linux?</a><br><br>
<a name="1222027"></a>

<a name="1222028"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> How can I disable localization of info on Linux?  My application is saving floating-point numbers with commas instead of periods in some regions and it is causing problems. <br><br></td></tr></table><br>
<a name="1222029"></a>

<a name="1222030"></a>

<a name="1222047"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ziggy</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is this happening at data conversion level or in the serialization of data? Maybe you could use the locale of std <a href="http://en.cppreference.com/w/c/locale/setlocale" target="_blank">http://en.cppreference.com/w/c/locale/setlocale</a> Maybe the internal streams are being format. You can also expect to have the minus sing at the right of the numbers on several regions. <br><br></td></tr></table><br>
<a name="1222033"></a>

<a name="1222034"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Since I live in the U.S. I really have no idea where this occurs.  I think it's in the String() and Float() functions.  All I know is that my users in some areas are having problems because my config file is getting stuff like "0,25" written to it instead of "0.25".<br><br>I can work around this for files that are only for their machine, like a settings file, but our material files are ASCII based.  If they save materials files, they won't work right on other computers. <br><br></td></tr></table><br>
<a name="1222037"></a>

<a name="1222038"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> String() uses sprintf internally, so I guess this is SO question is describing the same problem: <a href="http://stackoverflow.com/questions/3709886/sprintf-commas-and-dots-in-c-and-localization" target="_blank">http://stackoverflow.com/questions/3709886/sprintf-commas-and-dots-in-c-and-localization</a><br><br>i.e. add a call to setlocale right before the data is written/serialized?<br><br>For that matter, to test the issue yourself, you could try simply adding a setlocale to German in initialization to force the "wrong" behaviour, regardless of your system. (demonstrated <a href="http://en.cppreference.com/w/cpp/locale/setlocale" target="_blank">in the official example</a>) <br><br></td></tr></table><br>
<a name="1222042"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >*</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> You normally find the characters are in the euro zone countries like the Netherlands and Germany where things a like 24.00 for us becomes a 24,00.<br><br>I always found it weird tbh but a quick replace on the string if the comma is surrounded by numbers seemed to help in most cases. <br><br></td></tr></table><br>
<a name="1222044"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ziggy</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> There are more things that can change on locales, such as negative sign placement: in ex. 45,78- is the same as -45.78 so I would highly recommend you to do what Yasha suggested just as the first sentence in your application. If it's not ready to support non US configurations (that's sad), you should modify the locale the whole application so everything is shown the same everywhere. <br><br></td></tr></table><br>
<a name="1222045"></a>

<a name="1222046"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dawlane</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> You will have to do a bit of editing in blitz_string.c. See <a href="http://stackoverflow.com/questions/7684014/c-printf-with-f-but-localized-for-the-users-country" target="_blank">here</a> for setting the locale. <br><br></td></tr></table><br>
<a name="1222093"></a>

<a name="1222094"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here's what I did at the start of my program:<br><pre class=code>Extern
Function setlocale(category:Int,locale$z)
EndExtern
setlocale(0,"en-us")</pre> <br><br></td></tr></table><br>
<a name="1222095"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ziggy</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think this should do it. I thought it was en-US, but not sure. <br><br></td></tr></table><br>
<a name="1222096"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Are you sure "setlocale" is available on all systems?<br><br>On my NAS I had trouble to get setLocale working - as some binaries werent compiled with support of it.<br><br>So it _might_ fail.<br><br><br>bye<br>Ron <br><br></td></tr></table><br>
<a name="1222097"></a>

<a name="1222098"></a>

<a name="1222099"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ziggy</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's already using it (otherwise he won't be having the problems he has) so I'm sure it's available in current scenario. <br>Additionally, AFAIK I think it is something that does not have to be available at the OS level, as the STD implementation of set locale will use a default english version of itself in case the setLocale fails (at the OS api level), so even if it does not work, it should provide expected results, as at the end, it'll be formatting text in english US notation <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
