<!DOCTYPE html><html lang="en" ><head ><title >Simple  auto-updater (cross-platform)?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Simple  auto-updater (cross-platform)?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Simple  auto-updater (cross-platform)?</a><br><br>
<a name="1038265"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hello!<br><br><b>A.</b> <br>For my little radio player project more and more people demand an auto-updater for the station files. Has someone here written a thing like that? - It needs to be cross-platform. <br><br><b>B.</b><br>My idea for this function was:<br>1. Download a complete filelist from a static url.<br>2. Then check every file on the users HDD:<br>   - File is older or not present =&gt; File from the server is downloaded<br>   - File is not in list (i.e. broken station) =&gt; File will be deleted from HDD<br>3. CRC check for errors?<br><br>^Are there more efficient ways to handle this?<br><br><b>C.</b><br>Is it better to buy a commercial / external app for this? Which one?<br><br>I don't want to reinvent the wheel if possible. <br><br>Thanks!<br>Grisu <br><br></td></tr></table><br>
<a name="1038267"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Trouble with using file date/timestamps is that they can be changed.<br><br>I would give every file a version number, and store it on the client PC in an index file.  Keep an updated index file on the server, compare the two, download anything that needs updating.<br><br>Reinventing wheels is good sometimes.  You finish up with exactly the wheel to suit your needs rather than making do with somebody else's wheel.  You might get a better wheel than anything that existed before. <br><br></td></tr></table><br>
<a name="1038280"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the fast reply.<br><br>I also could zip all the stations files into one. So I only need to check one file. I could then download the zip and extract it to the users dir. <br><br></td></tr></table><br>
<a name="1038282"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't know of any cross platform apps of this type. Since the vast majority of features would need platform-specific code, I'm thinking that a cross-platform autoupdater would be hideously expensive. I use this Windows-only one, which has source available, but does not yet have any ports that I know of.<br><br><a href="http://wyday.com/wyupdate/" target="_blank">http://wyday.com/wyupdate/</a> <br><br></td></tr></table><br>
<a name="1038287"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >N</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> <a href="http://sparkle.andymatuschak.org/" target="_blank">http://sparkle.andymatuschak.org/</a><br><br>Sparkle appears to be the dominant update framework for Mac OS software.  I personally think it works very well, based on how many programs I've seen using it. <br><br></td></tr></table><br>
<a name="1038389"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the input.<br><br>So far I'm making good progress, the only issue I have is the download function.<br><br><img src="http://img823.imageshack.us/img823/6995/updaterx.png"><br><br>The following function crashes when downloading a lot of small files in a row.<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Function HTTPGetFile:Int(url$, filePath$)
	url$ = url$.Replace("http://", "")
	Local slashPos: Int = url$.Find("/")
	Local host: String
	Local file: String

	If slashPos &lt;&gt; -1
		host$ = url$[..slashPos]
		file$ = url$[slashPos..]
	Else
		Return -1
	EndIf
	
	Local fileStream:TStream = OpenStream(filePath$, False, True)
	If Not(fileStream) Then Return -1
	
	Local TCPStream:TStream = OpenStream("tcp::" + host$)
	If Not(TCPStream)
		fileStream.Close()
		Return -1
	EndIf
	
	TCPStream.WriteLine "GET " + file$ + " HTTP/1.1"
	TCPStream.WriteLine "Host: " + host$
	TCPStream.WriteLine "Connection: close"
	TCPStream.WriteLine ""
	
	Local dataLength:Long 
	Local in$ = TCPStream.ReadLine()
	While in$
		If in$.Find("Content-Length:") &lt;&gt; -1
			dataLength = Int(in$[in$.Find(":") + 1..].Trim())
		EndIf
		
		in$ = TCPStream.ReadLine()
	Wend

	Local byteCount:Long
	While Not(TCPStream.Eof())
		fileStream.WriteByte(TCPStream.ReadByte())
	Wend
	TCPStream.Close()
	FileStream.Close()

	If byteCount &lt;&gt; dataLength Then 
'        progress=" Ok! "
'        Print "Dowloading: "+filepath+" - "+progress
         Return -1
    Else 
'        progress=" Nicht gefunden!"
'        Print "Dowload: "+filepath+" - "+progress
'        DeleteFile (filename)  
         Return -1
    EndIf    
End Function
</textarea><br><br>Why does saving banks no longer work? I remember it did in old days.<br>bank:TBank = LoadBank("http://www.google.com/intl/en_ALL/images/srpr/logo1w.png)<br>SaveBank(bank, "c:/logo.png") <br><br></td></tr></table><br>
<a name="1038415"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >kfprimm</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> <pre class=code>

Strict

Import BRL.HTTPStream

Local bank:TBank=LoadBank("http::www.google.com/intl/en_ALL/images/srpr/logo1w.png")
SaveBank bank,"C:/logo.png"
</pre><br><br>Untested, but I believe that should do it. Note the "::". <br><br></td></tr></table><br>
<a name="1038434"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks, User error... ;) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
