<!DOCTYPE html><html lang="en" ><head ><title >Stuff at compile time?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Stuff at compile time?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Stuff at compile time?</a><br><br>
<a name="744630"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Picklesworth</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> The answer is probably a very big "NO", but I might as well ask.<br><br>I am writing a system which has now regrettably resorted to Strings in order to keep track of data for certain objects.<br>(A better description: It is an Extensions system where Extensions which may or may not exist are linked to Containers which may or may not exist based on key / value combinations that are stored in a TMap - though there is a high chance that said keys do not exist because they are specifically set by different Containers (which as I already said may or may not exist in a manner essentially unknown by the actual program), thus breaking things if the program is compiled as Strict).<br><br>This is unfortunate to be using strings, because the whole process of keeping track of data for those objects is hidden away thus rendering their use pointless!<br>Not too much of a problem for processing speeds because it only happens at particular moments, and memory waste is hardly a problem, but it just looks DUMB!<br>( And dumb is just not acceptable at this point, since I've now scratched out every bit of wonderful automagic code I previously had :( )<br><br>My last hope to make this system actually sane, I suspect, is a precompiler. (That, or I wait for the DLL support to be officially "Usable")<br>Is it possible to write code in BlitzMax that runs in its precompiler?<br><br>Theoretically, it could be quite possible, with the precompiler getting an in-line precompiling program compiled, running that, then finishing compiling the actual program. Of course, there would have to be some pretty creepy stuff going on for that to actually work; I realize that I am simplifying immensely and it would actually be both very difficult and near impossible.<br><br>There are unofficial precompilers such as BLIde's, which could work well, but I don't want to have people tethered to a single IDE.<br><br>So, thinking before compilation in BlitzMax, in any way at all, no matter how simple: Is it possible?<br><br>Even something really simple, like "If some constant is set, compile this code, otherwise remove it!" <br><br></td></tr></table><br>
<a name="744646"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Azathoth</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Blitzmax has very little in the way of a precompiler, currently you're stuck with ?Win32, ?MacOS, ?Linux, ?LittleEndian, ?BigEndian; maybe more but as far as I know no way to create your own. <br><br></td></tr></table><br>
<a name="744662"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JazzieB</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Speaking of the If..&lt;constant&gt;..Then thing, I've been meaning to ask this for ages.  Anyway, in previous Blitz versions (B3D, for example) you could do this...<br><br><pre class=code>
Const releaseBuild=True

If releaseBuild Then
  ..full version extra goes here..
Else
  ..nag screen..
EndIf
</pre><br><br>In B3D it would not compile any code that had absolutely no chance of getting executed because it was bound by a constant.<br><br>Is this the same for BlitzMax?  I seem to remember someone saying a while ago that BlitzMax just compiled everything, so I now find myself having seperate final sources for release and demo versions, which is not good and a pain if I need to change anything that's present in both. <br><br></td></tr></table><br>
<a name="744701"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Azathoth</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I did a test awhile ago, it does seem to remove unused variables and maybe strings but doesn't use this conditional compiling like the previous blitzbasics. <br><br></td></tr></table><br>
<a name="744704"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SculptureOfSoul</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> One thing you could do to control what gets compiled and what doesn't is to use a temporary "marker" like so in the following<br><br><pre class=code>
'Tag-FullVersionBegin
insert full version only code here
'Tag-FullVersionEnd
</pre><br><br>And then, when you are going to compile your demo version, do a search and replace and replace 'Tag-FullVersionBegin with "?Debug" and 'Tag-FullVersionEnd with "?"<br><br>If you build it in release mode then that code won't be compiled. <br><br></td></tr></table><br>
<a name="744709"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SculptureOfSoul</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's hard to offer more help without having a better idea of how your extensions actually interface with the main program and such. From your description above I really have no clue what you are trying to do exactly. I don't see how a precompiler is going to help in a situation where you have extensions that may or may not exist. Are these extensions external processes? <br><br></td></tr></table><br>
<a name="744765"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Picklesworth</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hm... In that case, I guess a feature request would be in order.<br>Why doesn't that "?" thing act as an If statement that happens in the precompiler, where Win32, Linux, MacOs, etc. are constants.<br><br><br>Okay, so at the moment every extension is compiled into the program, added by Include. (Yes, I know Include is dumb, blah blah blah).Those Extensions contain a variety of functions.<br>Outside of those Extensions, there are Extension Containers. The containers store a selection of extensions' functions.<br>The idea here is that any piece of code can have a Container tossed onto it, thus making it possible to add more code to it. (Rather simplistic, but it seems workable).<br>With that ugly design, an Extension can be added (some day...), removed, disabled, enabled or reconfigured on the fly!<br><br>Adding extension functions to the appropriate containers is where is gets (more) fuddly.<br><br>Each Extension Function has a bunch of key/value pairs set to it which help to identify it to certain extension containers. The keys may be set with Extension Containers themselves (as global variables), though there are a few set by the core Extensions system. An example of one of these keys is "FileType", into which one puts the file type that a mesh loader extension loads.<br>Those sorts of values cannot be hard-coded into the core, because the system should be very generic. (Having a FileType variable hard-coded into every Extension Function object is certainly not a wise move).<br>Having them as Strings is wasteful, and having them just as straight variable names breaks the ability to compile in Strict; there seems no way to actually check if a variable is set other than expecting the precompiler to define it as 0 for me if it doesn't exist! (And since that seems all the precompiler will do for me in that department, it is a bit stuck).<br>Feel free to prove me wrong, please!<br><br>An Extension Function object has a method which gets it to loop through every container and find the ones that want to use it.<br>This is done via a callback function set for each extension container; that function looks at an extension function's key / value pairs in order to decide if it is an appropriate extension function for that container.<br>If it is, it is added to that Container's list of contained functions :)<br><br><br>Yep, it's a bit convoluted, sort of like one of those Rube Goldberg contraptions! <br><br></td></tr></table><br>
<a name="744770"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SculptureOfSoul</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, I'm just about as clueless as before as to exactly what you're doing and why, but that's probably due to me and not your explanation :P. <br><br>Anyhow, I'd look into Lua or using hash tables as your container objects. You can define new key pairs on the fly and you won't bomb out if you check for a key that doesn't exist. <br><br>Sorry if this isn't much help - I'm sure a more experienced coder can offer better advice. <br><br></td></tr></table><br>
<a name="744859"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> I wish max had a full set of precompiler directives that let you create macros like in a macro assembler. <br><br></td></tr></table><br>
<a name="744974"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Picklesworth</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ah, LUA!<br><br>That's a good idea, SculptureOfSoul!<br>I'm sure LUA knows how to handle string/value pairs such that they don't slow everything down.<br>Do you know if there is a way to get its various variable management things going without having to parse a script file?<br>Although I guess even if it does end up with a script file, I could use it to my advantage somehow... (I guess I'll have to, actually, since LUA is a rather big thing to use for something so tiny).<br><br><br>The reason I don't want to do horrible String comparisons myself: I saw what happened to BlitzUI :( <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
