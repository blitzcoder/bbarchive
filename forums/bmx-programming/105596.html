<!DOCTYPE html><html lang="en" ><head ><title >length of null array = 0</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >length of null array = 0</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >length of null array = 0</a><br><br>
<a name="1288789"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bobysait</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't know if it's how it's supposed to be, but length of null arrays returns "0".<br>in some way it makes sens, but shouldn't it crashes with an access to a Null pointer ?<br><br><pre class=code>
Type Ta
	Field length:Int
End Type

Local a:Ta[];
Print a.length
Print a&lt;&gt;Null

Local t:Int[]
Print t.length
Print t&lt;&gt;Null

</pre> <br><br></td></tr></table><br>
<a name="1288793"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> No, because a non-initialised array is internally an instance of a special empty array. <br><br></td></tr></table><br>
<a name="1288794"></a>

<a name="1288816"></a>

<a name="1288817"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> String and array variables can't actually be Null in the sense of having the same <i>object identity</i> as any other type variable set to Null. They both instead return objects with length 0, because as you can see, that's simply more useful in this case.<br><br>There is one area where you need to be careful though, and that's if you tend to store a lot of things in variables of type Object. There are a couple of edge cases where BlitzMax doesn't, or can't, insert the implicit conversion (between bbNullObject and bbEmptyArray), and as a result it's possible - if unlikely - to end up writing code that compares Null to Null and ends up false or whatever. Will add example if I can find it.<br><br><br>Anyway, the general name for this particular way of handling non-values is the <a href="https://en.wikipedia.org/wiki/Null_Object_pattern" target="_blank">Null Object Pattern</a> (or sometimes Nil Object Pattern, to distinguish it from Null). Under this pattern, instead of marking "absent" values with an inaccessible non-value like the null pointer, there are instead valid "zero" values defined for each type that always provide a correct response to field reads or method calls, but simply do nothing. This is useful in many places: BlitzMax uses it internally in its implementation of TMap, for instance, to avoid having to write an extra "If Null" test when navigating the tree (instead, the leaves are nil objects that simply don't return anything or navigate further).<br><br>It would be nice to support this at a language level and be able to tell types not to use Null, but not obvious how to go about it.<br><br><br>Finally - <b>do not assume</b> that accessing Null will lead to a crash. This is a <i>debug</i> feature only, in BlitzMax. BlitzMax's Null is not the same as hardware null, and accessing it does not cause a segfault the way it does in C or C++ - in release mode, reading from null will often silently succeed (the refcounting GC relies on this, technically making Null itself an instance of the Null Object Pattern in BlitzMax). You need to check for Null manually in BlitzMax if you want your code to be safe in release mode, or add "gates" that prevent Null values entering an area. Debug mode doesn't use hardware signals to check for Null - it just inserts an invisible If branch around every single use of an object variable. <br><br></td></tr></table><br>
<a name="1288800"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bobysait</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, then just declaring the array without initialization means an object is created.<br>Thanks for the confirmation.<br><br>That also explain why I couldn't understand the maxgui TGadgetItem creation<br>-&gt; the "items:TGadgetItem[]" is never initialized with a new or auto-array form (I searched the sources so deeply that I felt I was beginning to think as a gadget ...), and I couldn't find why it doesn't crash here<br><br><pre class=code>
Method InsertItem(index,text$,tip$,icon,extra:Object,flags)
?debug
		If index&lt;0 Or index&gt;items.length Throw "Gadget item index out of range."
?
		items=items[..items.length+1]
</pre><br><br>But then, it makes sens.<br><br><br><br>ps :<br>Actually I also realized I can push an object to a Null array on the fly<br>It's not really related to the topic (or maybe it is ... in some kind), but I'm still discovering stuff years after the beginning :)<br><br><pre class=code>
Local t:Object[] = Null;
t :+ [Object(Null)]
print t.length
</pre> <br><br></td></tr></table><br>
<a name="1288803"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> declaring the array without initialization means an object is created. <br></div><br>No. Your variable just points to an address in memory which represents a global empty array.<br><br><div class="quote">  Actually I also realized I can push an object to a Null array on the fly <br></div><br>That's not doing what you think. :+ on an array will allocate a New array of an increased size, copy the old contents to it, and add the new stuff at the end. <br><br></td></tr></table><br>
<a name="1288812"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bobysait</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>That's not doing what you think. :+ on an array will allocate a New array of an increased size, copy the old contents to it, and add the new stuff at the end. <br> <br></div><br>Actually, it's exactly what I thought it does, but I didn't explained in the details cause I thought it would be hard for me to explain this in English.<br>But yeah, t :+ [Obj] means t = t[..size] + [Obj]<br>that 's why I said "It's not really related to the topic (or maybe it is ... in some kind)". Sorry for that, I'm not always very clear ^_^ (I'm pretty much more often obscure actually) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
