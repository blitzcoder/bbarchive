<!DOCTYPE html><html lang="en" ><head ><title >Linker Error with External Lib</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Linker Error with External Lib</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Linker Error with External Lib</a><br><br>
<a name="793990"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is going off topic from the Vista/MinGW thread now, so I'll post separately.<br><br>I've got a MinGW Static Library, which references a MinGW Dynamic Library. The Dynamic Library has a .dll and a .a and the static library, just a .a.<br><br>The Static Library was built with the .a from the dynamic library included in the linker options.<br><br>I get undefined reference to blah::blah for every command in the dynamic library. Why, and how can I fix it? <br><br></td></tr></table><br>
<a name="794176"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Anyone got any ideas? Since I can't get BMax to compile a module with GCC at all, this is the only way I have left to build the TV3D and HGE modules. <br><br></td></tr></table><br>
<a name="794212"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> does your static library internally import the .a of the dynamic library at all? or better include the header file of the dynamic library? otherwise the functionality is nowhere defined and won't work. <br><br></td></tr></table><br>
<a name="794271"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> My Static Library has a Dev C++ Project file, and the project imports the .a of the dynamic library in the linker options. This is all I have to do to compile a standalone GUI app in DevC++ so I thought this would be fine for my static library too. <br><br></td></tr></table><br>
<a name="794279"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >errno!</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> even if a lib you use imports the .a file it's self, you usually have to manually import it in blitz too.<br><br>if the depnded on lib is called libgab.a for example, add this to your imports<br><br>import "libgab.a"<br><br>blitz will recognigze it as a lib and import it as you'd expect.<br>-edit- you have to copy the the .a file to your project's folder where it compiles from. <br><br></td></tr></table><br>
<a name="794286"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, I import the lib into the BlitzMax project as well, but I don't think that's where the linking error is. It reports the name of my CPP file ( the base file of the static lib ) as being the source of the linker errors, so I think it's the static lib that can't see the functions, not the module. <br><br></td></tr></table><br>
<a name="794316"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dabz</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Any chance you could re-indroduce the problem you are having gabs in a example, with roughly everything you have (bmx files, lib file and dll file)<br><br>It would be a lot betterer to play around than trying to guess! ;)<br><br>Dabz <br><br></td></tr></table><br>
<a name="794329"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well there's about 100 files, so it's a bit OTT to do that.<br><br>Essentially :<br><br>Dynamic Lib - Contains lots of functions in classes. (Eg: class1-&gt;Function1(), class2-&gt;Function1(), class2-&gt;Function2(), etc )<br><br>Static Lib - Links to Dynamic Lib<br>             Exports lots of Functions in CDECL format<br>             Calls functions in Dynamic Library<br><br>Blitzmax Module - Imports Dynamic Lib.<br>                  Imports Static Lib.<br>                  Calls Functions in Static Lib.<br>              <br>And when I compile the module, I get several hundred undefined references to the class and function names in the dynamic library. The errors are all reported in the static library. <br><br></td></tr></table><br>
<a name="794344"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dabz</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> It seems a bit of a mare, could you try CORE_EXPORT after the class keyword:-<br><br><i>class CORE_EXPORT GabsClass</i><br><br>in your lib sources and see if it builds and works?<br><br>Baring in mind, this is just from research on the net regarding linking to DLL's that contain classes.<br><br>Still, I've tried! ;)<br><br>Dabz <br><br></td></tr></table><br>
<a name="794494"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm class functions are a little bit different than regular ones ... cause normally you would enclose the code in export "C" which makes sure it will work.<br><br>If you use objects thought, you might want to use extern types and declare the whole objects there to prevent this kind of error (unless the lib you import already offers plain function access but I do not assume so as we are talking of TV3D most likely) <br><br></td></tr></table><br>
<a name="794502"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Dabs: Thanks. There's no problem exporting the classes, the headers are already set up with CORE_EXPORT or EXPORTCLASS or something like that. I can link to them just fine if it's built as a single BMax module which imports the C code instead of compiling the C code as a static library. I gather it must be the way I'm linking in the Dev C++ project which is causing the problem.<br><br>Dreamora: You can't link to libraries by Externing the types, that only works with classes with virtual methods, and that's not what TV has. The whole purpose of the static library is to write plain functions which call the class functions. It's the static library which can't see the classes, not the BMAX module. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
