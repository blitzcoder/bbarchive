<!DOCTYPE html><html lang="en" ><head ><title >scoring + Game takes 30+ seconds to end.</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >scoring + Game takes 30+ seconds to end.</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >scoring + Game takes 30+ seconds to end.</a><br><br>
<a name="1025663"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >WERDNA</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey everyone.<br><br>I have a rather nasty problem with the game I'm working on right now.<br>I want to put in an awards system like in the super smash bro's games, where<br>if you meet certain prerequisites during a match you'll earn awards that net you<br>extra points for your high score :)<br><br>Well I have that working just fine, but as soon as I read the arrays that contain<br>the data, my game will slow down dramatically(No big deal since nothings going<br>on at the time other than the score display), and when you press a key the game<br>will 'seem' to run just fine. you can play matches, move around character select<br>etc. But as soon as you try to end by pressing ESC it takes from 20 to 60 seconds<br>to end OR just freezes up completely. This ONLY happens when I try to read<br>data from both arrays so I can display both the award name, and how many<br>points it's worth(I have two arrays. 1 that just holds the award names, and<br>the other which holds two values. True or False to see if you have met the<br>prerequisites, and the point value of the award).<br><br>Here's the code where I read from them.<br><br>Function ScoreDisplay()<br>Local Fonto = LoadImageFont:TimageFont(CurrentDir()+"/Fonts/Vera.ttf",36,SMOOTHFONT)<br>Local y = 172<br>Local AwardO$ = "A W A R D S"<br>SetImageFont Fonto<br><br>DrawText AwardO$,width/2-TextWidth(AwardO$)/2,100<br><br>(Here's the bit that checks the arrays V)<br>For scores = 1 To 51<br>If CheckArray[scores,0] = True <br>DrawText AwardsArray[scores]+" "+CheckArray[scores,1],width/2-200,y<br>y = y + 36<br>End If <br>Next <br><br>SetImageFont Fonto3<br>End Function <br><br>The above works fine if I edit out CheckArray[scores,1] after DrawText.<br>It also works fine on Windows XP. The problem seems to only be on Win7.<br><br>I tried redoing how I read the awards just a few moments ago, using two<br>different Types instead of two different arrays, and got it to display the text<br>just fine, but it still crashes or takes forever to end my program when I hit<br>ESC. I tried removing all of both types from their respective type lists before<br>typing END, but the program still ends itself weirdly. Occasionally it takes only<br>a few seconds to end, but usually it takes awhile or crashes.<br><br><br>Twould be nice if any one knows how to fix this :)<br>I'm using BlitzMax 1.34 by the way. <br><br></td></tr></table><br>
<a name="1025664"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jesse</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> what does the line look where you create the checkArray. you might be going out of bound. <br>arrays don't work the same as they do in blitzBasic.<br>if you create an array of 50 elements it will index between 0 to 49:<br><pre class=code>
local a[50]
for b = 0 to 50-1
   a[b] = n
next
</pre><br>are you running in debug mode?<br>are you using strict or superstrict? <br><br></td></tr></table><br>
<a name="1025666"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >WERDNA</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Global CheckArray[60,2]<br>For Checks = 1 To 51<br>CheckArray[Checks,0] = False <br>Next<br><br>I create more than I need so there's no way I'll go out of bounds ;)<br>A tad wasteful of resources, but whatever, lol.<br><br>I'm running in debug mode.<br>I am not using strict or superstrict.<br><br>As I mentioned, this does work just fine on WinXP. its just on Win7(And probably Vista)<br>that there is a problem. <br><br></td></tr></table><br>
<a name="1025669"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jesse</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> have you tried running your application with UAC OFF on windows 7?<br>I am thinking you are trying to write the files with out permission and are attempting to read files that don't exist in your hard drive. <br><br></td></tr></table><br>
<a name="1025690"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> <pre class=code>
local a[50]
for b = 0 to 50-1
   a[b] = n
next
</pre><br><br>btw, using "Until" makes the code more readable :<br><br><pre class=code>
local a[50]
for b = 0 Until 50
   a[b] = n
next
</pre><br><br>And as Jesse points out, arrays are zero indexed.<br><br><br>How often are you loading the same font file? 60 times a second? <br><br></td></tr></table><br>
<a name="1025703"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jkrankie</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I can''t see anything wrong with your function, so it's probably how you're calling it. are you calling it from in a loop or something?<br><br>Cheers<br>Charlie <br><br></td></tr></table><br>
<a name="1025731"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Muttley</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> One thing that can help spot problems in advance is to always use SuperStrict.  Seriously, every program you write, always have that as the first line, it will save you so many problems.<br><br>The fact that you're loading the imagefont every time ScoreDisplay() is also a bit suspect. <br><br></td></tr></table><br>
<a name="1025743"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Make fonts and things like that global variables. <br><br></td></tr></table><br>
<a name="1025801"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >WERDNA</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Slaps self in the forehead.<br>Loading the font 60 times a second is definitely a bad idea, lol.<br><br><div class="quote">  btw, using "Until" makes the code more readable :  <br></div><br>Thanks for the tip! I'll try adding that from now on instead of to #.<br>And yeah, I now arrays are 0 indexed ;)<br><br>@jkrankie<br>I'm calling the function from the games main While loop. Nothings wrong with how<br>I'm calling it. It works just fine without any slow down as long as I edit out checkarray[scores,1] <br>after Drawtext.<br><br>I'll see about simply changing the font to a global, see if that alone fixes it, lol.<br><br><br>Thanks for the help, I'll see if any of the above fixes it. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
