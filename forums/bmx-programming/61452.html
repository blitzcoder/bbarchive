<!DOCTYPE html><html lang="en" ><head ><title >Ugly problem with alpha images!</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Ugly problem with alpha images!</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Ugly problem with alpha images!</a><br><br>
<a name="686694"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've got an ugly issue with my alpha mapped 24 bit PNG's!<br><br>Whenever they are drawn at non-integer pixel boundaries, I see white pixels being blended in around the edges, as if all areas with an alpha of 0 had been filled in with white, and the bilinear filtering is grabbing that color around the borders to blend with!<br><br>And sure enough, if I disable filtering on my images, then the problem goes away, but then everything which is rotated or scaled down looks like ass, (even if mipmapping is enabled... oddly) and that's just not acceptable!<br><br>Has anyone had this problem?  Does it have something to do with how the PNG's were saved, or what program was used to create them?  If there were image data in those areas, then there wouldn't be a problem.<br><br>The only way right now I could potentially solve this issue would be to clamp the positions of all my sprites to integer boundaries, but then the movement wouldn't be as smooth, and there's no guarantees that will help with stuff which is rotated. <br><br></td></tr></table><br>
<a name="686701"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I found the problem.  It is indeed the program used to export them which is the issue.  In my case, Photoshop.  <br><br>Someone posted a "defringe" program in this thread which seems to solve the problem.  I still have some white specks, but they could just be the artist who messed up, or me when I edited the art and resaved it after it already had the white transparency from a previous save:<br><br><a href="http://www.blitzbasic.com/Community/posts.php?topic=50808#566036" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=50808#566036</a><br><br>Seems to make most png's smaller than the photoshop ones too, but those it makes bigger it makes much bigger so I guess I'll look into a program called png crush that someone mentioned. <br><br></td></tr></table><br>
<a name="686705"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >René</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Maybe SuperPNG may help. A free Photoshop plugin, that saves PNG by not using "Adobe's PNG format". But I have not tried yet.<br><br><a href="http://www.fnordware.com/superpng/" target="_blank">http://www.fnordware.com/superpng/</a> <br><br></td></tr></table><br>
<a name="686733"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yan</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah, the SuperPNG plug-in does indeed eliminate the fringing but you have to faff around with the alpha channel. Although some prefer to do it that way, I just find it easier to run the final image through DeFringe.<br><br>I generally use <a href="http://sourceforge.net/project/showfiles.php?group_id=1689&amp;package_id=6641" target="_blank"><b>pngcrush  </b></a> anyway, as the PNGs PS creates are often far bigger than they should be.<br><br><br>I really must put a proper front end on that thing at some stage. ;o) <br><br></td></tr></table><br>
<a name="686964"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Have you tried a 1 pixel border all round the image?  This solved a crappy anti-aliasing issue at non-int coords for me. It's probably not be the same issue of course. <br><br></td></tr></table><br>
<a name="689801"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> OK, I've ran into the same problem.  My artist sent me some text and when drawn at non-integer coords, OR when scaled it looks crap (see the black outline on the tops or sides of letters).<br><br>Take a look:<br><br><img src="http://www.greyaliengames.com/misc/ugly.png"><br><br>Here's the code:<br><br><pre class=code>
Strict
Graphics 600,400

Local image:TImage=LoadImage("play.png")

SetClsColor 200,200,200
Cls

SetBlend AlphaBlend
DrawImage image,10,10

DrawImage image,300,10.5

DrawImage image,10.5,200

SetScale 1,1.5
DrawImage image,300,200


Flip

While Not KeyHit(KEY_ESCAPE)
Wend
</pre><br><br>Here's how I drew the 4 images:<br><br>1) (top left) integer coords<br>2) (top right) fractional Y coord<br>3) (bottom left) fractional X coord<br>4) (bottom right) integer coords but scaled to 1.5 in Y.  Notice how the uglyness is really obvious!<br><br>As sswift says, turning off filtered image sorts it out but the scale ones loop rubbish (blocky)<br><br>I'm gonna have to check out this defringe thing now. <br><br></td></tr></table><br>
<a name="689824"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> woo, defringe.exe works great, thanks Ian.<br><br>However, if I get the image in Gimp 2.0 and resave it with Save Background Color and Save color values from transparent pixels unticked, it doesn't fix it even though this was stated in that other thread by Ian.  Perhaps it only works on new images?  Also notice my issue is with black pixels not white ones... <br><br></td></tr></table><br>
<a name="689831"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> hmm, I take it back.  defringe *almost* works great, but I think it only works on the outer edges, not any inner edges, as it half fixes the problem, look:<br><br><img src="http://www.greyaliengames.com/misc/ugly2.png"><br><br>It's most noticeable on the lower left image.  Perhaps it's because there was a shadow there?... <br><br></td></tr></table><br>
<a name="690049"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yan</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> DeFringe just scans the image and replaces the colour of  any zero alpha pixels with the average colour of all surrounding,     non zero alpha, pixels.<br><br>I'm not really sure what I'm supposed to be looking for in the above image, but the nature of filtering makes some blurring unavoidable. <br><br></td></tr></table><br>
<a name="690051"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> The most obvious problem I see there is that the image is cut off. Better remove the shadow there or make the image larger ...<br><br>But actually I don't see any problems on all the images beside the potential problems the bottom right could have due to non-uniform scaling <br><br></td></tr></table><br>
<a name="690053"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't know why you put them on a gray background.  If there are any speckles around the egdes, they'll be white, and that makes any harder to see.  <br><br>But you say your problem is with black pixels not white ones?  What are you saving these from?  As far as I know, with Photoshop you get only white pixels. <br><br></td></tr></table><br>
<a name="690058"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yan/Dreamora: in the second image I posted, look at the bottom left Play.  can you see the little black lines/pixels on the sides of the letters?  most noticeable on A and Y (compare with the top right image where ther are none).  This isn't blurring it's the filtering averaging with black.  These are not there with filtering turned off.  This is because defringe nearly worked perfectly but doens't work on those areas as there must be a tiny bit of shadow there.  Also I know about the truncated shadow, thanks.<br><br>sswift: I put them on a grey background as I am getting BLACK speckles.  The artist is using photoshop which is why I'm confused they are not white based on what I've read in these posts! <br><br></td></tr></table><br>
<a name="690101"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yan</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah, it's effectively blurring the shadow pixels.<br><br>As far as I can see, you have three options if you want to totally eliminate this...<br><br>1) Make all transparent pixels a mid/light grey (the defringe function can use a defined colour instead of averaging, it's just not plumbed in). This will give you a light'ish halo on any dark backgrounds though.<br><br>2) Reconfigure everyone's graphics hardware so it ignores the colour of transparent pixels when it filters. ;o)<br><br>3) Stop being so anal and don't worry about it as it'll probably be unnoticeable in game. ;op <br><br></td></tr></table><br>
<a name="690103"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> 3) Stop being so anal and don't worry about it as it'll probably be unnoticeable in game. ;op  <br></div><br><br>lol, luckily I'm only scaling that image vertically so it'll be fine.  The solution I really need is for the artist to supply proper pngs with the correct transparency and it'll be fine.  Another artist supplied a load that were totally fine. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
