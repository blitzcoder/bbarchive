<!DOCTYPE html><html lang="en" ><head ><title >SetViewPort on canvas broken?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >SetViewPort on canvas broken?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >SetViewPort on canvas broken?</a><br><br>
<a name="649641"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Can you test this? (requires MaxGUI)<br><pre class=code>win = CreateWindow("blah",50,50,500,500)

canv = CreateCanvas(0,0,400,400,win)
	SetGadgetLayout canv,1,0,1,0
	SetGraphics CanvasGraphics(canv)

img = LoadImage("sheep2.jpg")

SetViewport 50,50,50,50

Cls
DrawImage img,0,0
Flip

Delay 4000
End</pre><br>I get a long vertical strip instead of a small square as you could expect.  Looks like the Y component of the viewport doesn't do anything.<br><br>Is it just me? <br><br></td></tr></table><br>
<a name="649648"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CS_TBL</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's not just you.. I mentioned this in the bugbin ages ago .. but no 'confirm' from anyone, nothing.. Highly irritating for map-editors 'ns stuff. <br><br></td></tr></table><br>
<a name="649656"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Can you link me up to the your bug report so I can prod it? <br><br></td></tr></table><br>
<a name="649660"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CS_TBL</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> ehrm.. now I start to doubt it :P I do know I mentioned it there, but there's no dedicated topic from me it seems.<br>It could be that someone else talked about it and I confirmed it, could be just a mentioned issue in a topic about <i>other</i> bugs.. :P<br><br>For safety: make a new topic about it, better an extra topic than an extra bug I'd say.. ^_^ <br><br></td></tr></table><br>
<a name="649687"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yan</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm...Works fine here.<br><br>This...<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">path$ = getenv_("BMXPATH") 
win = CreateWindow("blah",50,50,500,500)

canv = CreateCanvas(0,0,400,400,win)
	SetGadgetLayout canv,1,0,1,0
	SetGraphics CanvasGraphics(canv)

img = LoadImage(path$ + "/doc/bmax120.png")

SetOrigin 50,50
SetViewport 50,50,50,50

Cls
DrawImage img,0,0
Flip

Delay 4000</textarea><br><a href="http://homepage.ntlworld.com/mollymole/storage/beaker.jpg" target="_blank"><b>Gives me this...</b></a> <br><br></td></tr></table><br>
<a name="649691"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Diablo</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> works here too. <br><br></td></tr></table><br>
<a name="649706"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CS_TBL</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> before anything, I'm using 1.16, 1.18 refuses to work here.<br><br>Anyway:<br><br>That example from Hamish is actually the good-case-scenario.<br><br>I think most ppl use viewport to fill-up the gap left by the lack of DrawImageRect (the proper one, not the one in bmax), for which we need a viewport and negative x/y coords for the image to draw.<br>Try this stuff, and notice the different x/y coords at the draw-/tileimage commands!<br><pre class=code>
SuperStrict
Local window:TGadget=CreateWindow("o.O",32,32,640,480)
Global canvas:TGadget=CreateCanvas(32,32,256,256,window)

Global image:TImage=CreateImage(64,64)
Local x:Int
Local y:Int
Local i:Int
Local pm:TPixmap=LockImage(image)
	For y=0 To 63
		For x=0 To 63
			i=Rnd(255)-(x*2)-(y*2)
			If i&lt;0 i=0
			WritePixel pm,x,y,$ff000000|i+256*(255-i)+65536*i
		Next
	Next
UnlockImage image

SetGraphics CanvasGraphics(canvas)

Repeat
	WaitEvent()
	If EventID()=EVENT_WINDOWCLOSE End
	If EventSource()=canvas update
Forever

Function update()
	SetViewport 0,0,256,256
	Cls
	SetViewport EventX(),EventY(),32,32
	

	' try em all! (but just one at a time eh!)
	'
	'
	
		
	' works!
	TileImage image,EventX(),EventY()

	' works!
'	DrawImage image,EventX(),EventY()

	' you GOTTA *love* this effect ^_^
'	TileImage image,0,0

	' also buggy
'	DrawImage image,0,0
				
	
	Flip
End Function
</pre> <br><br></td></tr></table><br>
<a name="649713"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Posting errors for an outdated and already updated and fixed version is quite ... lets say useless?<br><br>Its broken in 1.16 and fixed with 1.18, there is nothing that could be done on that. <br><br></td></tr></table><br>
<a name="649824"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Er.. I'm using 1.18!  And Hamishs code has the same problem. <br><br></td></tr></table><br>
<a name="650047"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> So, is it just me then? <br><br></td></tr></table><br>
<a name="650350"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Dreamora - why do you say it has been fixed?  Do you have a link to an existing bug report, or thread where this has been mentioned? <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
