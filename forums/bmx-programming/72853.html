<!DOCTYPE html><html lang="en" ><head ><title >.EXE icon...</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >.EXE icon...</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >.EXE icon...</a><br><br>
<a name="814336"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yahfree</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> New to blitzmax, in blitz3d you used some method to hack the EXE's resource file and implant the icon, now this method still holds true but i'v seen some methods that seem easyer, like importing an *.o file in the code and bam you have your icon..<br><br>anyone care to share? i'd like to have one on the physical exe file, one on the system tray below, and one of the window aswell.<br><br>is this possible? <br><br></td></tr></table><br>
<a name="814362"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> <a href="http://homepage.ntlworld.com/config/max/appiconguide.htm" target="_blank"> Icon Guide </a><br>If you search the Code Archives and forums with 'Icon' you will find a few posts with information like <br><a href="/posts.php?topic=58571#651552" target="_blank"> this </a> <br><br></td></tr></table><br>
<a name="814366"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yahfree</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> thanks i'll give it a try.. <br><br></td></tr></table><br>
<a name="814373"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yahfree</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> hmm, the winres command works, but when i try to use it(correctly according to that page) it doesnt create the file. any ideas?<br><br>basicly i get the same message as when i type "windres -?" <br><br></td></tr></table><br>
<a name="814418"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JazzieB</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I personally just use the Resource Hacker method for my final EXE and <a href="/codearcs.php?code=1841" target="_blank">this</a> for the window and task bar icons. <br><br></td></tr></table><br>
<a name="814437"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >plash</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> create a batch file containing:<br><pre class=code>%MINGWDIR%/bin/windres -i res.rc -o res.o</pre><br><br>then make a file called res.rc, then paste this:<br><pre class=code>101 ICON icon.ico</pre><br>you have to change the icon name to whatever your using.<br><br>you can also add XP theme manifests by adding another line:<br><pre class=code>1 24 manifest.txt</pre><br><br>the text inside manifest.txt should be:<br><pre class=code>&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;
&lt;assembly xmlns="urn:schemas-microsoft-com:asm.v1"
manifestVersion="1.0"&gt;
&lt;assemblyIdentity
    name="XPManifest"
    processorArchitecture="x86"
    version="1.0.0.0"
    type="win32"/&gt;
&lt;description&gt;Windows Shell&lt;/description&gt;
&lt;dependency&gt;
    &lt;dependentAssembly&gt;
        &lt;assemblyIdentity
            type="win32"
            name="Microsoft.Windows.Common-Controls"
            version="6.0.0.0"
            processorArchitecture="x86"
            publicKeyToken="6595b64144ccf1df"
            language="*"
        /&gt;
    &lt;/dependentAssembly&gt;
&lt;/dependency&gt;
&lt;/assembly&gt;</pre> <br><br></td></tr></table><br>
<a name="814457"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yahfree</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> sorry, but whats a batch file and how do i make one? i got the resfile.rc, and the icon, i'll add that XP manifest to the rc file aswell. <br><br></td></tr></table><br>
<a name="814459"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >plash</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> a batch file (.bat) is just a text file, when executed opens a command prompt and runs commands contained within the file. <br><br>just name the batch file "build.bat" and open it. <br><br></td></tr></table><br>
<a name="814463"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yahfree</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> its telling me un reconized command, in the batch file i have:<br><pre class=code>
C:\USER1\Programs\MinGW/bin/windres -i res.rc -o res.o
</pre><br><br>i'm using windows if it matters <br><br></td></tr></table><br>
<a name="814465"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >plash</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> hmm, try replacing all the "\" slashes with "/" slashes. <br><br></td></tr></table><br>
<a name="814469"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yahfree</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> ahh i got it to work, i took out the dir, and just made it:<br><br><pre class=code>
windres -i res.rc -o res.o
</pre> <br><br></td></tr></table><br>
<a name="814471"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yahfree</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> works great, it has the icon in the tray below, on the .exe, but its missing the icon on the window, any fixes? <br><br></td></tr></table><br>
<a name="814474"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >plash</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> are you using max2d or maxgui? iv'e never tested it on the window created by graphics, works like a charm when using createwindow.<br><br>i do know there is a way to set a windows icon by using its hwnd, but i cant remember the command.. <br><br></td></tr></table><br>
<a name="814479"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yahfree</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> max2d. <br><br></td></tr></table><br>
<a name="814499"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >plash</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> i have no clue how to set the window icon when using graphics, i have something else i am working on so here's all i got, still not working though..<br><pre class=code>SuperStrict

Framework brl.glmax2d
Import brl.blitz
Import brl.random

Import "res.o"

?Win32

Import "-lshell32"

Extern "Win32"
	Function LoadIcon:Int(hWnd:Int, file$z, index:Int) = "ExtractIconA@12"
	Function SetClassLong:Int(hWnd:Int, nIndex:Int, dwNewLong:Int) = "SetClassLongA@12"
	Function FindWindowA:Int(WndClass$z, WndTitle$z)
End Extern

?
AppTitle = "GRAPHICS ICON"
Graphics 800, 600
SetGraphicsDriver GLMax2DDriver()

SetWindowIcon
SetBlend LIGHTBLEND
SetAlpha 0.4
While Not KeyDown(key_escape)
	SetColor Rnd(100), Rnd(100), Rnd(100)
	DrawOval Rnd(625), Rnd(600), Rnd(100, 200), Rnd(100, 200)
	Flip '; Delay 15
	If AppTerminate() Then Exit
Wend

Function SetWindowIcon(IconID:Int = 0)
?Win32
	Local hWnd:Int = FindWindowA("BlitzMax GLGraphics", AppTitle) ; DebugLog hWnd
	Local icon:Int = LoadIcon(hWnd, AppFile, IconID) ; DebugLog icon
	SetClassLong hWnd, -14, icon
?
End Function</pre><br><br>also, the window class may differ if you're using a different graphics driver. <br><br></td></tr></table><br>
<a name="814583"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yahfree</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> hmm thanks for all the help plash.<br><br>one of the links tonyg gave me looked like what i needed (by gray alien) but it didnt seem to work...<br><br>i'v done some searching cant seem to find any diffenitive answers, anyone else care to share? <br><br></td></tr></table><br>
<a name="814591"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> What you want to achieve is a little hard.<br>You will need to learn and research on MSDN as you try to combine the graphics window, which is NO application window with application features (window icon, system tray symbol).<br><br>You would better trying it using MaxGUI or a different OS GUI module (bruceys wxMax for example) <br><br></td></tr></table><br>
<a name="814592"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Does <a href="/posts.php?topic=66973#748597" target="_blank"> this </a> not help? <br><br></td></tr></table><br>
<a name="814598"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yahfree</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> OH! that works, that post by grey alien! <br><br></td></tr></table><br>
<a name="814757"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MGE</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yahfree, care to post exactly what you're doing to make it work? And also, is your solution compatible with Windows XP? Thanks. <br><br></td></tr></table><br>
<a name="814881"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yahfree</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> yes its compatible with windowsXP<br><br>i copy windres.exe from minGW to a folder somewhere (i keep it by all my projects) along with my Icon, and my resfile.rc<br><br>now you should have 3 files in this "IconMaker" folder:<br>1: icon.ico ;your icon (32x32 .ico)<br>2: resfile.rc ;with the lines:<br><pre class=code>
101 ICON icon.ico
</pre><br>3: windres.exe ; from your MinGW/bin<br><br>Now, open notepad and add the following line:<br><pre class=code>
windres -i resfile.rc -o icon_import.o
</pre><br>save this as build.bat in the same "IconMaker" folder<br><br>now open a DOS window (command prompt) and drag and drop that build.bat file into the command prompt window. now press enter. and you'll have a new file in the "IconMaker" folder icon_import.o<br><br>now import this into your bmax programs and that will give you your main icon.<br><br>this was hard to set up, but now making a new icon res file is as easy as dropping a new icon into that folder and deleting the other one then calling it on command prompt.<br><br>Now to get it on the window call the following function right after Graphics.<br><pre class=code>
' -----------------------------------------------------------------------------
' ccSetIcon
' -----------------------------------------------------------------------------
Function SetIcon(iconname$, TheWindow%)	
	?Win32
	Local icon=ExtractIconA(TheWindow,iconname,0)
	Local WM_SETICON = $80
	Local ICON_SMALL = 0
	Local ICON_BIG = 1
	sendmessage(TheWindow, WM_SETICON, ICON_BIG, icon)
	?
End Function

'call it like this
SetIcon(AppFile, GetActiveWindow())
</pre><br>you'll also need the following win32 externs:<br><pre class=code>
'Needed externs
?win32
Extern "win32"
	Function ExtractIconA%(hWnd%,File$z,Index%)
	Function GetActiveWindow%()
	Function SendMessage:Int(hWnd:Int,MSG:Int,wParam:Int,lParam:Int) = "SendMessageA@16"
End Extern
?
</pre><br><br>Credits to grey alien for that function, this will extract the icon out of your exe file and display it on the window.<br><br><br>now the result is a completely independant compiled exe that needs no external files to display its icon.<br>heres an example:<br><pre class=code>
Import "icon_import.o"

'Needed externs
?win32
Extern "win32"
	Function ExtractIconA%(hWnd%,File$z,Index%)
	Function GetActiveWindow%()
	Function SendMessage:Int(hWnd:Int,MSG:Int,wParam:Int,lParam:Int) = "SendMessageA@16"
End Extern
?

Graphics 800,600
SetIcon(AppFile,GetActiveWindow())

While Not AppTerminate() = True
Cls


Flip
Wend
End



Function SetIcon(iconname$, TheWindow%)	
	?Win32
	Local icon=ExtractIconA(TheWindow,iconname,0)
	Local WM_SETICON = $80
	Local ICON_SMALL = 0
	Local ICON_BIG = 1
	sendmessage(TheWindow, WM_SETICON, ICON_BIG, icon)
	?
End Function
</pre> <br><br></td></tr></table><br>
<a name="814896"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >amonite</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> tahnks for sharing this method, it just comes very handful :) has i have been recently trying to make this work with no results. <br><br></td></tr></table><br>
<a name="814921"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MGE</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry my bad, I meant to say is it compatible with Vista? Thanks for posting the detailed instructions!! :) <br><br></td></tr></table><br>
<a name="814941"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yahfree</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> not sure, i'd like to know this though, if you have a vista machine to test it on. <br><br></td></tr></table><br>
<a name="815075"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JazzieB</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> Grey's method works in Vista, as it's my main dev machine. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
