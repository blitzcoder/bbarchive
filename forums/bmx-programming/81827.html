<!DOCTYPE html><html lang="en" ><head ><title >Streaming Audio</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Streaming Audio</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Streaming Audio</a><br><br>
<a name="921782"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> What options are currently available?<br><br>I just looked at MaxMod2 Beta 4 but it seems to crackle horribly when other stuff (i.e. Firefox) is running.  I tried MaxMod 1.25 and that was the same.<br><br>I don't want to have to pay out for something like FMOD or BASS to do this.  The cost is one issue, figuring out how to do it is another.<br><br>[edit] Just noticed that MaxMod 1.25 seems to work fine with DirectSound, but is this a safe/reliable driver to use?  OpenAL is v crackly. <br><br></td></tr></table><br>
<a name="921786"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GaryV</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> AUDIERE<br><br><a href="http://audiere.sourceforge.net/" target="_blank">http://audiere.sourceforge.net/</a><br><br>It works great <br><br></td></tr></table><br>
<a name="921787"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is this what you're using? <br><br></td></tr></table><br>
<a name="921788"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GaryV</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, but I am using it with another language.  (So far with BM, I have only done apps.)  It also seems to work well on the Vista systems I have tested it on. <br><br></td></tr></table><br>
<a name="921791"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ah.  No idea at all how to get that going in Blitzmax. :/ <br><br></td></tr></table><br>
<a name="921808"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is there a way to allocate a large memory bank (big enough for your audio file), spawn a new thread that loads the audio into the bank space, while another thread (or main thread) plays the audio? The only thing non-streaming about it would be that you are using more memory than just some buffer, you'd need space for the whole audio in ram - but if the playing is slower than the file access speed it should be okay? That would at least let you play from the start - but then, I'm not sure that you can play the audio that's in a bank? <br><br></td></tr></table><br>
<a name="921826"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Is there a way to allocate a large memory bank (big enough for your audio file), spawn a new thread that loads the audio into the bank space, while another thread (or main thread) plays the audio? The only thing non-streaming about it would be that you are using more memory than just some buffer, you'd need space for the whole audio in ram <br></div>Isn't that the same as just using LoadSound?<br><br>Or are you suggesting that there's some way of loading an OGG file into a bank, and decompressing it piece by piece into smaller buffers and playing it from there? <br><br></td></tr></table><br>
<a name="921832"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Perturbatio</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Ah. No idea at all how to get that going in Blitzmax. :/  <br></div><br><br>It's simple really, just mention this thread to Brucey ;) <br><br></td></tr></table><br>
<a name="921907"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> I guess I wasn't thinking about the impact of decompression. Basically I thought that you could start the file loading in a separate thread and then start playing it before it's finished loading. But that's going to require two things: a) A way to load the audio data into a memory bank or area of allocated memory, and b) a way to play the audio located at that address - which will probably involve decompression. <br><br>I presume long pieces of ogg music are not all copied to the sound card at once, but are spooled off as needed by the driver or something, since they are mainly stored in main ram? And I presume that the ogg decompressor mainly thinks about a local area of the ogg datastream when trying to decompress the next chunk of audio? If that's the case - if the decompression proceeds through the file more or less sequentially, then it could be decompressing while the file data is loading, and if can do that it could be playing it. Just a matter of whether there are sufficient commands to load into memory and play at the same time.<br><br>e.g. Can you do LoadSound() in one thread and have it start loading the audio file, but not finish loading, while another thread calls PlaySound() with the same audio data? Does LoadSound need to finish first to pass the handle back for PlaySound to use, or is there some other way to do it?<br><br>Another option, and this is perhaps best left to BRL, is for them to modify LoadSound so that it spawns a thread to do the loading, detaches the thread, then returns with the handle to the object so that you can call PlaySound right away while it's still loading.<br><br>Another question though, how long does it actually take to load the piece of audio that you're trying to load? A few seconds? Isn't the loading of it something that can be done while some splash screen or menu is being operated or something? <br><br></td></tr></table><br>
<a name="921913"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >REDi</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>MaxMod2 Beta 4 but it seems to crackle horribly when other stuff (i.e. Firefox) is running.<br> <br></div><br><br>Hmm I'll look into that, is this on your slow test machine?<br>As you probably noticed I swapped to using RtAudio instead of writing all the audio drivers myself, hopefully I'll be able to increase the buffer size for dsound and make it more stable, we sorted it okay for my original dsound driver so it should be no big deal.<br><br><div class="quote"> Is there a way to allocate a large memory bank (big enough for your audio file), spawn a new thread that loads the audio into the bank space, while another thread (or main thread) plays the audio? <br></div><br><br>MaxMod2 already allows you to stream the audio into memory, there is a demo app in the examples folder, the problem is none of the audio drivers allow you to play from existing data (they all duplicate the audio data before playing it).<br><br>So to combat this I've been writing another audio driver (hence the delay) that handles streaming and playing sound through a single audio output.  This plays the audio samples direct from the TAudioSample object, allowing us to stream the loading and play the audio at the same time :)<br><br>The new driver also adds some nice extras like loop points for channels, changing the play cursors position (seeking) on a channel, ect.<br><br>BTW if anybody has any ideas/requests, I'm all ears. <br><br></td></tr></table><br>
<a name="921989"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Hmm I'll look into that, is this on your slow test machine? <br></div>No.  Tested on two systems:<br><br>1. Athlon XP3000+ 2.16GHz, 1.5GB RAM, Vista Home Premium<br>2. Intel Dual Core @ 2x1.4GHz, 2GB RAM, Vista Home Premium<br><br>I noticed another problem with Maxmod.<br><br>If I use CreateAudioStream with the 'paused' flag set to True, its ignored when using OpenAL and the track starts playing immediately, yet it works OK when using DirectSound.<br><br>I think this 'RTAudio' thing may be part if not all of the problem with the crackling thing.  I used maxmod (1.16?) for Buzzword with OpenAL, on System #1 above, and didn't observe any problms. <br><br></td></tr></table><br>
<a name="922108"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >plash</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> I would think the issue is using threading, other processes take up a lot of cpu when performing tasks and the thread for audio handling is low-priority. <br><br></td></tr></table><br>
<a name="922137"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I would think the issue is using threading, other processes take up a lot of cpu when performing tasks and the thread for audio handling is low-priority. <br></div>Don't know about REDi but I've not been anywhere near the threading stuff in Blitzmax. <br><br></td></tr></table><br>
<a name="922223"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >REDi</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I noticed another problem with Maxmod. <br></div><br>Okay I'll take a peek and post an update soon. *EDIT* done ;)<br><br><div class="quote"> I would think the issue is using threading <br></div><br>Yeah pretty much, that and the circular buffer size, its a bit of a juggling act between stability and latency, nothing that cant be sorted though. <br><br></td></tr></table><br>
<a name="922292"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Does latency become less of an issue if you stream from RAM rather than HD?<br><br>Also, any ETA on when the OpenAL crackly problem can be mendid? :) <br><br></td></tr></table><br>
<a name="922448"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >REDi</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Does latency become less of an issue if you stream from RAM rather than HD? <br></div><br>Dunno, I wouldn't have thought there's much in it tbh, easy enough to test though.<br><br><div class="quote"> Also, any ETA on when the OpenAL crackly problem can be mendid? :)  <br></div><br>Oops I missed that bit, I'll 'ave a tinker in a bit.<br><br>*EDIT* 1.27 download is up, it *MAY* fix your OpenAL crackle, the buffer size was pretty big anyway so I didn't adjust that, but if this doesn't fix it I may have to. <br><br></td></tr></table><br>
<a name="922583"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Cliff - working perfectly now on my Intel Dual Core system.  Should get time to test it on the XP3000+ later. <br><br></td></tr></table><br>
<a name="922621"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Right - this is interesting (Maxmod 1.27).<br><br>1. Pentium Dual Core @ 2x1.4GHz, 2GB RAM, Vista Home Premium - OK<br>2. Athlon XP3000+ @ 2.16GHz, 1.5GB RAM, Vista Home Premium - CRACKLY<br>3. P3-733MHz, 256MB RAM, WindowsXP - OK<br><br>Beginning to think there's some slight oddity between MaxMod/OpenAL/Vista.<br><br>When testing on system #2 above, even having taskmanager open is enough to make it cough every time the taskmanager window refreshes (~once per sec). <br><br></td></tr></table><br>
<a name="923418"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >REDi</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Strange!  I'm flat out busy ATM, but I'll have a look when I've got some time. <br><br></td></tr></table><br>
<a name="923460"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> Good news..... kind of.  The crackling problem is nothing to do with MaxMod.<br><br>I just wrote some code that uses LoadSound instead and get exactly the same problem. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
