<!DOCTYPE html><html lang="en" ><head ><title >Socket Programming</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Socket Programming</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Socket Programming</a><br><br>
<a name="743712"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Banshee</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've been trying to get my head around Blitz Max's socket programming of late, and i'm getting very confused with it.  I have a very procedural approach to programming, I dont much hold with OO and because of that i'm struggling with the stuff in the code archives.<br><br>I'm very good with Blitz3D's networking, I can use either UDP or TCP, assemble my streams byte by byte, close connections, send / receive messages - i've written everything from a multi-threaded web server to games to server management tools to game mods and even once a multi-player game 'AI' that connected to multiplayer LAN games.<br><br>But BlitzMax... *boggle*<br><br>I've hunted for tutorials, experimented, and read through the code archives and i'm still stuck!  I can't seem to fathom out the basic concept of sockets.<br><br>As far as I can figure out I create a socket, and then I bind the socket to a port (which begs questions about why I need to create the socket in the first place, but i'm sure it's logical to somebody more knowledgeable than me).<br><br>On the server I then repeatedly check socketListen on the socket to see if data has arisen, or should this be the bound socket?<br><br>Once a connection is detected it returns a new socket for that connection, so I bind that socket to a stream with createSocketStream, and I then read off that data with readShort/Int/Line etc, and check for more available content with SocketReadAvail() I think, although maybe I need a stream command for that.<br><br>On the client side I create a socket, bind it to the send port, then I connect it to the remoteIP and the receive port at the other end, which creates a new socket.<br><br>I then bind a stream to the new socket and write data to it with writebyte/int/line - but how do I send this stream?<br><br>I'm so confused by all of this, but I want to learn.  I really dont want to use networking libraries because I want to master it for myself, but i'm so confused !<br><br>Is there a tutorial on network coding in BlitzMax anywhere?<br><br>Help please.  I'm too stupid to figure this out. <br><br></td></tr></table><br>
<a name="743721"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Networking with BM means GNet ^^<br><br>If you are good in B3D networking thought, I would look at Vertex BNetEx (as well to get your head around the socket stuff if you want to do low level programming) <br><br></td></tr></table><br>
<a name="743728"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> CopyStream?<br>I struggled with the same thing and came up with <a href="/posts.php?topic=57847#643388" target="_blank"> this </a> as very simple send/receive. <br><br></td></tr></table><br>
<a name="743772"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dirk Krause</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Also there is a tutorial here:<br><a href="http://www.blitzmax.com/codearcs/codearcs.php?code=1555#comments" target="_blank">http://www.blitzmax.com/codearcs/codearcs.php?code=1555#comments</a> <br><br></td></tr></table><br>
<a name="743793"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SculptureOfSoul</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Don't bind your client side sockets. It's bad practice. The OS will handle assigning the socket when it's connected, and this will guarantee that it's on a free port whereas if you bind it you could very well run into conflicts with other running programs. <br><br></td></tr></table><br>
<a name="744196"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Banshee</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thank you for all the help, it seems the command I was missing, or rather, misunderstood, was flushStream - which sends the data queued rather than trashes it.  I was being foiled by native English! <br><br></td></tr></table><br>
<a name="744216"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Banshee</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm not quite there yet though, I can't seem to figure out how to double check if there is data available for reading.  Using both SocketReadAvail() and the .size() method on the stream both return 0, is there not a way to double check a network stream has any content before reading it?<br><br>Thank you. <br><br></td></tr></table><br>
<a name="744434"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SculptureOfSoul</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I didn't use Socketsreams in my program so I'm not sure where they diverge from standard raw sockets. SocketReadAvail() does work with raw sockets, but my guess is that the socketstream is doing something like reading all of the information available on the socket into a stream buffer - so hence SocketReadAvail() finds nothing sitting on the standard socket buffer since the stream has already read it.<br><br>I'm assuming you'll have to use stream commands on the socketstream to test if it's empty. I'd try calling EOF() on the stream and see if that works...i.e if it returns false there *should* be data sitting there for you.<br><br>If that doesn't work, you'll have to experiment with some other stream functions (checking if streampos = streamsize, check if readbyte throws an exception, etc.) <br><br></td></tr></table><br>
<a name="744438"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SculptureOfSoul</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Whoops, I missed that you said you were checking .size() on the stream. Hmm. Actually, I was wrong about the notion that a socketstream might automatically read the data. After taking a peek at the source, it looks like it should be sitting on the socket. <br><br>So calling MySocketStream.Socket().ReadAvail()   <br>always returns 0? Are you sure data is being sent to it? I know that's a silly question but y'never know. <br><br>Also ignore my Eof() surmisings. All it does in the case of a socketstream is let you know if it's connected.<br><br>SocketReadAvail(MySocketStream.Socket()) or the more OOP version of the code I posted above *should* be returning a non 0 value when there is data to be read. <br><br></td></tr></table><br>
<a name="744542"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skn3</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have created, or am creating a tcpserver and tcpclient layer for raw sockets. Shame you cant get yer hands on it cos its for an inhouse thing at work lol (making a peer to peer network for a remote management tool). I might post a modified version once it is finished though. If you have any questions in general id be happy to help. <br><br></td></tr></table><br>
<a name="745194"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Banshee</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thank you so much for the various help, particularly SculptureOfSoul as that has really helped me get a grip on it and I now have a multi-client server model running and i'm assembling my streams byte by byte just how I wanted.  I think previously I was checking the readavail() of the wrong socket, but now it is all working and i'm very grateful to all of you :).<br><br>*hugs*<br><br>(it's ok, i'm a girl, hugging is not gay) <br><br></td></tr></table><br>
<a name="745236"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SculptureOfSoul</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Glad that my musings were of some help. Network programming can be quite tricky (I know I've got a lot to learn yet!) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
