<!DOCTYPE html><html lang="en" ><head ><title >Has Single-surface been introduced?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Has Single-surface been introduced?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Has Single-surface been introduced?</a><br><br>
<a name="608066"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I sort of remember looking through the image.loadanim<br>code pre-1.12 and saw it created a seperate pixmap for each frame in a loadanimimage.<br>Looking at it now, and it seems to create a pointer to a rectangular area of the image using staticpixmaps. <br>A quick test seems to suggest the code is running at similar speeds to Indie's SS code. <br>Can somebody check the code and see what they think (or if BRL could comment...)? <br><br></td></tr></table><br>
<a name="608504"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Robert Cummings</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Anyone? <br><br></td></tr></table><br>
<a name="608579"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DStastny</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> No,  I have been extensivily through the code.  Each Frame of image is loaded into a seperate texture surface.<br><br>Doug Stastny <br><br></td></tr></table><br>
<a name="608613"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Robert Cummings</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks!<br><br>Should be a good speed boost when/if they decide to put this in (for ogl and dx)? <br><br></td></tr></table><br>
<a name="608631"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's only my GL test that runs at similar speeds. <br>DX is still approx 40% slower with loadanimimage. <br>All very odd. <br><br></td></tr></table><br>
<a name="608786"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >HrdNutz</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> DX7 is slightly slower than GL if unoptimized, optimized they are about the same speed.  Being able to draw from a single surface isn't going to speed stuff up too much, as the problem lies in sending single quad to the renderer at one time.  Most optimal solution is to keep as much stuff in one texture as possible, and then batch geometry by texture/render state.  Without batching, you won't see much improvement, and without having everything in a single surface, batching can't work.  <br><br>If you want to use single surface now, there is code on this forum on how to do it, and it's very simple.  Thank IndiePath for that :) <a href="http://www.blitzbasic.com/Community/posts.php?topic=51647&amp;hl=single%20surface" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=51647&amp;hl=single%20surface</a><br><br>However, without batching geometry you cannot possibly achieve high end results like other games do.  I think this is what buffered mode is trying to acomplish, but either way we need custom ways to handle this for optimal results.  DrawVertexArray() function, if properly implemented,  would solve all this <br><br></td></tr></table><br>
<a name="608802"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi HrdNutz, that's the code I was comparing.<br>Something has definately changed somewhere. <br>I checked again and it doesn't seem to be single-surface although (at one point) there is a staticpixmap xcreated for a cell. This is then copied into the image and split into seperate frames to display.<br>It's possible the recent changed to the DX and GL drivers have closed the gap a bit by performance improvements.<br>There also seems to be some memory changes as Indie's code in DX now takes more memory than before and needs a gccollect. <br>My results..<br>                                DX                        GL<br>                           MEM  TIME         MEM      TIME<br>Loadanimimage  -200   500          1000    1665<br>TAnimImage       30000 471          1000    1659<br>+GCCollect           -200  460          No change.<br>using...<br><pre class=code>
For Local a = 1 To 100
	Cls
	For Local b = 1 To 1000
    SetRotation Rand(360)
		blob.Draw(Rand(0,640),Rand(0,480),32,32,Rand(0,4))
'        DrawImage blob,Rand(0,640),Rand(0,480),Rand(0,4)
	Next
	Flip
Next
End Rem
</pre> <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
