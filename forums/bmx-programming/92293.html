<!DOCTYPE html><html lang="en" ><head ><title >What are Events?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >What are Events?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >What are Events?</a><br><br>
<a name="1051193"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BLaBZ</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've heard some incredible great things about events, is there an events tutorial? A place I could find an explanation of Hooks and EventQueues and their common usage?<br><br>Thanks! <br><br></td></tr></table><br>
<a name="1051195"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Events are useful when your program will spend most of its time sitting around waiting for user input. For example a text editor. When the user isn't typing or clicking on a button, the text editor probably won't be doing anything either. For standard games, where action is always going on, I personally prefer the good old-fashioned game loop.<br><br>MaxGUI makes use of events - reading some tutorials for it might help you understand the concept behind events.<br><br><a href="http://www.2dgamecreators.com/maxgui/" target="_blank">http://www.2dgamecreators.com/maxgui/</a> <br><br></td></tr></table><br>
<a name="1051197"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CS_TBL</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's also a different way to let actions happen. Imagine one general and 10 soldiers. In the old days of code, the general would instruct all soldiers individually to attack the enemy. In the event-days, the general sends out an event called 'AttackEnemies_KThxBye' and the soldiers are programmed to react on that specific event.<br><br>Or, in concrete code, the old days:<br><br>for t=0 to 9<br> soldier[t].AttackEnemy<br>next<br><br>And in the event days:<br><br>General.InstructTroupsToAttackEnemy<br><br>After this, *if* you have soldiers waiting for this event, then they'll attack. But if there aren't any soldiers waiting (haven't trained them, or they're already dead) then nothing happens. Also, the amount of soldiers or whether their index number is consecutive, doesn't matter, whoever reacts to this event will attack. You could even program a turtle to attack, as long as it reacts to that event (and has relevant attack code) This is a specific difference between the 'hardwired' first code. With events, things get less hardwired, and in a way 'easier', more natural perhaps. <br><br></td></tr></table><br>
<a name="1051199"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Has anybody made an action or strategy game based around events? I'd be interested to see how that looks in concrete code. <br><br></td></tr></table><br>
<a name="1051200"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BLaBZ</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wow thats sounds incredible! I'm guessing hooks are created via AddHook?!<br><br>It also sounds like if you have lets say 1000 soldiers, you don't have to continually loop through their updates, just feed what happens?! So you could have a ton more units as oppose to not using events.<br><br>Would it make multiplayer a bit easier? Through networking events?<br><br>If it's not to much to ask, how would you create an object that reacts to simple event? <br><br></td></tr></table><br>
<a name="1051209"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CS_TBL</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, the fun bit is that these 1000 soldiers aren't in any loop that's of your concern, they just 'are'. They manage themself, you don't have to worry about who listens when, that's all done automatically for you.<br><br>In the old days, you programmed actions. In these event days you program behaviour. And if that behaviour involves doing actions, then you have actions. <br><br></td></tr></table><br>
<a name="1051214"></a>

<a name="1051215"></a>

<a name="1051216"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> The lack of concrete code from a working prototype should warn you that this idea is better on paper than in practice. Programming isn't magic or sentient, no matter how many tricks you add.<br><br><div class="quote"> So you could have a ton more units as oppose to not using events. <br></div>You can hide it or make it easier to manage, but you still have to program the nitty gritty of your game somewhere. Neither method would inherently be able to support more units than the other.<br><br>Of course if you can provide me with a non-trivial working example to prove me wrong...<br><br><font class="tiny">Last edited 2010</font><br><br><font class="tiny">Last edited 2010</font> <br><br></td></tr></table><br>
<a name="1051227"></a>

<a name="1051231"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CS_TBL</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> code+comments should be enough to get the idea..<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">' event example with a lame army!
'
' CS_TBL

SuperStrict
Global EVENT_ATTACK:Int=AllocUserEventId()
Global EVENT_SOLDIERDIED:Int=AllocUserEventId()

Type TSoldier
	Field life:Int=100
	Field rank:Int ' 0 puki, 1 footman, 2 archer, 3 ogre, 4 mage, 5 corporal
	Field name$
	Field legion:Int
	
	Function eventhook:Object(id:Int,data:Object,context:Object)
		If TSoldier(context) TSoldier(context).ev TEvent(data);Return data	' don't bother understanding this line, just c/p + fix
	EndFunction
	
	Method New()
		AddHook EmitEventHook,eventhook,Self
	End Method
	
	Method Free()
		RemoveHook EmitEventHook,eventhook; GCCollect()
	End Method
	
	Method ev(event:TEvent)
		If life&gt;0 ' am I still alive?
			If event.id=EVENT_ATTACK ' attack order?
				If event.x=legion ' my legion?
					If event.y=rank ' my rank?
						If Attack()=0 ' soldier attacks, but did he.. die??
							Local e:TEvent=New TEvent ' oh dear..
							e.id=EVENT_SOLDIERDIED
							EmitEvent e ' send msg to the general
							e=Null
						EndIf
					EndIf
				EndIf
			EndIf
		EndIf
	End Method
	
	Method Attack:Int()
		Print name+" (rank: "+rank+", legion: "+legion+") says: ~q"+Mid(..
		"OMFG DIE!   "+..
		"Take this!  "+..
		"Kiss my Ass!"+..
		"Feel my axe!"+..
		"Puppypowah!!",+..
		1+Int(Rnd(4))*12,12)+"~q [life: "+life+"]"
		
		life:-Rnd(50)
		
		If life&gt;0 Return 1 ' if we're not dead, return a 1 so that the general knows this particular soldier is still alive
		Return 0
	End Method
	
	Method Identify()
		Print "Name  : "+name
		Print "Legion: "+legion
		Print "Rank  : "+rank
		Print "Life  : "+life
		Print "--------------------"
	End Method
End Type

Function CreateSoldier:TSoldier(rank:Int=0,name$="Garfield",legion:Int=1337)
	Local a:TSoldier=New TSoldier
	a.rank=rank
	a.name=name
	a.legion=legion
	Return a
End Function

Function GimmeName$()
	Local n$="Andy Bert Claude Denny Ernie Frank Gerard Hank Inky Jack Kraken Leonard Manly Neo Ottman Pooki Quint Randy Sandy Trevor Uma Victor Wendy Mr.X Yasmin Zack"
	Local name$[]=n.split(" ")
	Return name[Rnd(Len(name))]
End Function

Function Conclusion()
	Print
	Print
	Print "**************************************************************************"
	Print "* Your army died, you are an epic faillure of a general. Bah, humbug you! *"
	Print "**************************************************************************"
End Function




' let's form an army here
Local totalsoldiers:Int=8
Local soldier:TSoldier[totalsoldiers]
For Local t:Int=0 To totalsoldiers-1
	soldier[t]=CreateSoldier(Rnd(5),GimmeName(),Rnd(3))
Next
' soldier[] contains your soldiers
' note how the code below *no where* referrs to this array! It's there, it manages itself whether you do something or not



' here be your game
Local e:TEvent=New TEvent
Local timer:ttimer=CreateTimer(6) ' pick a lower number if you want to see less fast scrolling

OnEnd Conclusion

Repeat
	WaitEvent()
	
	If EventID()=EVENT_SOLDIERDIED
		totalsoldiers:-1
		If totalsoldiers&lt;1 End
	EndIf
	If EventID()=event_timertick ' select a legion and a rank, and let them attack!
		e.id=EVENT_ATTACK
		e.x=Rnd(3) ' pick a legion - it could be that no one will be selected!
		e.y=Rnd(5) ' pick a rank - it could be that no one will be selected!
		EmitEvent e
		Print "======================="
		Print "Soldiers left: "+totalsoldiers
		Print "=======================~n"
	EndIf
Forever</textarea><br><br><font class="tiny">Last edited 2010</font> <br><br></td></tr></table><br>
<a name="1051234"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BLaBZ</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> haha love the dialog<br><br>This is an awesome example and exactly what I was looking for, thanks so much! <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
