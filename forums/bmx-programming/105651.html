<!DOCTYPE html><html lang="en" ><head ><title >Zip and Packing Assets for Minib3d</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Zip and Packing Assets for Minib3d</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Zip and Packing Assets for Minib3d</a><br><br>
<a name="1290095"></a>

<a name="1290137"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RustyKristi</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm currently playing around with incbin and it's really cool to have an embedded solution for a game/app. <br><br>I was thinking if there is an existing zipped solution or mod, as I would like to separate my asset files and don't want my exe to be one big file. <br><br></td></tr></table><br>
<a name="1290096"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Endive</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Can you explain a little more? <br><br></td></tr></table><br>
<a name="1290098"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RustyKristi</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey Endive, this is related to packing and publishing your files. So when you distribute your game/app, you can structure it like this:<br><br>/MyGame.exe<br>/Textures.zip<br>/Data.zip<br>/Assets.zip<br><br><br>I'm also looking for Cower's PhysFs mod but I can't find any working link :( <br><br></td></tr></table><br>
<a name="1290103"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Maybe this will help:<br><br><a href="http://www.blitzmax.com/codearcs/codearcs.php?code=2559" target="_blank">http://www.blitzmax.com/codearcs/codearcs.php?code=2559</a> <br><br></td></tr></table><br>
<a name="1290106"></a>

<a name="1290107"></a>

<a name="1290108"></a>

<a name="1290117"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dw817</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Rusty, if you are referring to doing your own compressions inside BlitzMAX, there are three commands built directly inside the language called:<br><br><b>Compress</b>, <b>Compress2</b>, and <b>Uncompress</b>.<br><br>To my knowledge, the data it compresses is just as small as PKZIP/WinZIP will do.<br><br>Let me know if this is something you want to pursue and I'll try to help you if I can as I'm quite familiar with how these commands work. <br><br></td></tr></table><br>
<a name="1290119"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dw817</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Rusty, if you are referring to doing your own compressions inside BlitzMAX, there are three commands built directly inside the language called:<br><br><b>Compress</b>, <b>Compress2</b>, and <b>Uncompress</b>.<br><br>To my knowledge, the data it compresses is just as small as PKZIP/WinZIP will do.<br><br>Let me know if this is something you want to pursue and I'll try to help you if I can as I'm quite familiar with how these commands work. <br><br></td></tr></table><br>
<a name="1290114"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Koriolis' zipstream module lets you load assets from a zip file. (It's also compatible with incbin, so you can incbin the zip file into your blitzmax program if you so choose) <br><br></td></tr></table><br>
<a name="1290123"></a>

<a name="1290124"></a>

<a name="1290125"></a>

<a name="1290126"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RustyKristi</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks dw817. I'm trying to use minib3d so this will include models and textures. Can you give a simple example or where can I find one?<br><br>@xlsior<br>Reading this old thread response from Kippykip, is it compatible with minib3d?<br><br><div class="quote"> ZipStream appears not to work with minib3d when using loadMesh etc.. <br></div><br><br><a href="http://www.blitzbasic.com/Community/post.php?topic=71734&amp;post=1211775" target="_blank">http://www.blitzbasic.com/Community/post.php?topic=71734&amp;post=1211775</a> <br><br></td></tr></table><br>
<a name="1290129"></a>

<a name="1290130"></a>

<a name="1290131"></a>

<a name="1290132"></a>

<a name="1290133"></a>

<a name="1290135"></a>

<a name="1290165"></a>

<a name="1290169"></a>

<a name="1290170"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dw817</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> I can't help you with 3D graphics, that is definitely something I can say, "I don't know."<br><br>As there is still quite a bit about BlitzMAX I have yet to understand.<br><br>But compression of data, like you are zipping it, I can do fairly easily. Here are some functions I wrote to get you started.<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
compresfile "froggy.jpg"

' &gt;&gt; RETRIEVE SELECT CHARACTER FROM STRING FROM RIGHT
Function fncz$(a$,b)
  Return Mid$(a$,Len(a$)-b+1,1)
EndFunction

' &gt;&gt; RETRIEVE LAST CHARACTER FROM STRING
Function fnz$(a$)
  Return Right$(a$,1)
EndFunction

' &gt;&gt; COMPRESS A FILE, SAVE NEW ONE, RETURNS NEW EXTENSION
Function compresfile(f$)
Local fp:TStream=ReadStream(f$),a$=LoadText(fp),b$,o$
  CloseStream(fp) ' loadtext reads in entire file at once
  b$=compres$(a$) ' compress results in b$
  o$=Left$(f$,Len(f$)-2)+fnz$(f$)+fncz$(f$,2)
  fp=WriteStream(o$) ' ^ tricky change extension - JPG becomes JGP
  WriteString fp,b$
  CloseStream(fp)
EndFunction

' &gt;&gt; DECOMPRESS A FILE, SAVE NEW ONE, RETURNS PROPER EXTENSION
Function decompresfile(f$)
Local fp:TStream,a$,b$,o$,f2$=f$ ' remember original filename
  f$=Left$(f$,Len(f$)-2)+fnz$(f$)+fncz$(f$,2)
  fp=ReadStream(f$) ' ^ tricky change extension JPG becomes JGP
  a$=LoadText(fp) ' loadtext reads in entire file at once
  CloseStream(fp)
  b$=decompres$(a$) ' decompress results in b$
  fp=WriteStream(f2$) ' write back with proper filename
  WriteString fp,b$
  CloseStream(fp)
EndFunction

' &gt;&gt; BUSY COMPRESS ROUTINE - MODIFIED ORIGINAL BY GRABLE
Function compres$(strz:String)
Local inz:Byte Ptr=strz.tocstring()
Local outz:Byte[2^24] ' needs to be big enough for most files
Local outsz:Int=outz.length,r$
  compress2 outz,outsz,inz,strz.length,9 ' 9 means maximum compression
  r$=String.frombytes(outz,outsz)
  Return r$
EndFunction

' &gt;&gt; BUSY DECOMPRESS ROUTINE - MODIFIED ORIGINAL BY GRABLE
Function decompres$(strz:String)
Local inz:Byte Ptr=strz.tocstring()
Local outz:Byte[2^24] ' needs to be big enough for most files
Local outsz:Int=outz.length,r$
  uncompress outz,outsz,inz,strz.length
  r$=String.frombytes(outz,outsz)
  Return r$
EndFunction
</textarea><br><br><img src="http://www.writerscafe.org/uploads/rte/d3243a2c5c81c3ed5c77e51ce9e4fa91.png"><br><br><img src="http://www.writerscafe.org/uploads/rte/4b9c0e3c7f119122a499b50304719b70.jpg"><br><br>Also, here is the FROGGY image if you want to use it and compare byte size before and after compression. It is a JPEG so to be able to compress a JPEG even smaller is a pretty amazing feat, and this code does that. <br><br></td></tr></table><br>
<a name="1290136"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RustyKristi</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> @therevills<br><br>will that work with loading 3d models in minib3d? I should have made the subject more clear.<br><br>thanks dw87. Yes, I'm more particular in packing up my assets so they are more organized not all over the place, but I also have some interests in having good compression so it will be faster to download.<br><br>Edit: Subject Updated <br><br></td></tr></table><br>
<a name="1290139"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dw817</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Glad to help. And yes, it does seem like the average game these days has many MANY files. Quite a bit different then when I was growing up - it was essential it seemed for game authors to cram everything down into one encrypted and compressed EXE.<br><br>That was the merit badge.<br><br>Those days are gone now it seems. Ah well. :) <br><br></td></tr></table><br>
<a name="1290321"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> @therevills<br><br>will that work with loading 3d models in minib3d? I should have made the subject more clear. <br></div><br><br>Looking at the code it should work for any file. <br><br></td></tr></table><br>
<a name="1290328"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RustyKristi</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks therevills. I have tested that the code and it works well, with Filax's version it's more efficient but the point of zipping assets for a game is not to unpack and write in file. I was thinking more of unpack and load directly to the game, without any cache or file writes. This is similar using incbin (i think), without the exe attachment. <br><br></td></tr></table><br>
<a name="1290345"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> So streaming into memory then...<br><br>Maybe this module then:<br><a href="http://www.blitzmax.com/Community/posts.php?topic=71734" target="_blank">http://www.blitzmax.com/Community/posts.php?topic=71734</a> <br><br></td></tr></table><br>
<a name="1290351"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dw817</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Therevills, the site: <b>"http://www.koriolis-fx.com/"</b> is not even active anymore. Because what you are saying is of interest to me too. <br><br></td></tr></table><br>
<a name="1290366"></a>

<a name="1290368"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Further down that thread is another link:<br><a href="http://retroremakes-framework.googlecode.com/svn/trunk/modules/koriolis.mod/" target="_blank">http://retroremakes-framework.googlecode.com/svn/trunk/modules/koriolis.mod/</a><br><br>(I've never used this mod - I think I would be paranoid with the amount of RAM it would use - LOL!) <br><br></td></tr></table><br>
<a name="1290367"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dw817</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Therevills, I'm going to look this over. <br><br></td></tr></table><br>
<a name="1290372"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Therevills, the site: "http://www.koriolis-fx.com/" is not even active anymore. Because what you are saying is of interest to me too.  <br></div><br><br>Brucey adapted a version of Koriolis' module that's compatible with blitzmax-NG, which can be found here: <a href="https://github.com/maxmods/" target="_blank">https://github.com/maxmods/</a> <br><br></td></tr></table><br>
<a name="1290374"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dw817</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Also good to know, Xlsior. Brucey is a coding genius, I'm poring over his work - exceptionally good, but also complex to understand. <br><br></td></tr></table><br>
<a name="1290401"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> I suggest to use KORIOLIS ZIPSTREAM. I use KORIOLIS in all my commercial projects to have only one file . And it always works reliable and as expexted. <br><br></td></tr></table><br>
<a name="1290412"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RustyKristi</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks guys. I was wondering how would you go about and use zipstream and minib3d to load a mesh and sound in a zip file? <br><br>I'm only seeing that it only works with textures in minib3d.. <br><br></td></tr></table><br>
<a name="1290414"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RustyKristi</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> I was hoping that there's probably something similar with Blitzmax like this one:<br><br><a href="http://www.blitzmax.com/Community/posts.php?topic=69315" target="_blank">http://www.blitzmax.com/Community/posts.php?topic=69315</a> <br><br></td></tr></table><br>
<a name="1290680"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> Koriolis zipstream works perfect with minib3d.<br>from one of my projects:<br><pre class=code>SuperStrict
Import koriolis.zipstream 
Import sidesign.minib3d

?Win32
	Import "icon.o"
?

Incbin "tt1.zip"
DatenPfad$="ZIP::Incbin::tt1.zip//"

Global ImagePfad$=DatenPfad
Global SoundPfad$=DatenPfad 
.....
		Tisch=CreateCube()
		ScaleMesh Tisch, 7.5,0.6,7
		PositionEntity Tisch,-0.5,-1.1+0.45,5
		Local Holz:TTexture=LoadTexture(ImagePfad + "buche.png")
		EntityTexture Tisch,Holz


Global Sounds:TSound[25]
....
		Sounds[2] = LoadSound(SoundPfad + "bing.png")
</pre> <br><br></td></tr></table><br>
<a name="1308467"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yue</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> Where download mod  zipstream? <br><br></td></tr></table><br>
<a name="1308470"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> Brucey has a port that's fixed bot Blitzmax NG on his githug page:<br><br><a href="https://github.com/maxmods" target="_blank">https://github.com/maxmods</a><br><br>(Koriolis.mod) <br><br></td></tr></table><br>
<a name="1308518"></a>

<a name="1308519"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yue</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> @XLSIOR<br>Thanks :) I have a question if it works with version 1.50 of BlitzMax ? <br><br></td></tr></table><br>
<a name="1308521"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RustyKristi</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have checked this again, it works and doesn't throw errors but it does not work with meshes only textures and probably sounds as Midimaster pointed out. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
