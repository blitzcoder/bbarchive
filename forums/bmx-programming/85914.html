<!DOCTYPE html><html lang="en" ><head ><title >Interfacing with the OS. HELP!!</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Interfacing with the OS. HELP!!</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Interfacing with the OS. HELP!!</a><br><br>
<a name="972708"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >beanage</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey Guys,<br><br>[Extern] works fine for functions.. but it doesnt work for flags!<br><br>Extern "Win32"<br> Function CreateFileMapping() 'works/ doesnt throw an error<br> Global INVALID_FILE_HANDLE 'doesnt work<br> Global PAGE_READWRITE 'doesnt work<br>End Extern<br><br>Const also fails.<br><br>Any ideas why?<br><br>(Edit: Research tells me i gotta perform an additional Import of the kernel32.dll, mustnt i? I also gotta declare those constants myself.. but where is a proper source to get their values from?)<br><br>(Edit2: My newby implementation doesnt even work for the desired functions. It says undefined reference. But what to do different? ) <br><br></td></tr></table><br>
<a name="972721"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_JIM</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, Google says INVALID_FILE_HANDLE is -1<br><br>and PAGE_READWRITE is 0x04: <a href="http://msdn.microsoft.com/en-us/library/aa366786(VS.85).aspx" target="_blank">http://msdn.microsoft.com/en-us/library/aa366786(VS.85).aspx</a> <br><br></td></tr></table><br>
<a name="972723"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> You can't put globals in an Extern block. <br><br></td></tr></table><br>
<a name="972726"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >beanage</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yea, got that point now.. yet i'm researching on how to include kernel32.dll, but i'm pretty sue i'll gonna make this today!^^ <br><br></td></tr></table><br>
<a name="972727"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SebHoll</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> To import the kernel32 library bindings into BlitzMax apps, you should add something like:<br><br><pre class=code>?Win32
Import "-lkernel32"
?</pre>...to the top of your source file - any functions declared in <b>Extern</b> blocks should then be able to be linked appropriately with the library. <br><br></td></tr></table><br>
<a name="972744"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >beanage</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I need extended help :\<br><br>I need the following functions:<br>CreateFileMapping()<br>MapViewofFile()<br>UnmapViewOfFile()<br><br>They are not included in the kernel32.bmx, are they?<br>( At least i still get "Undefined reference" trying<br><pre class=code>?Win32
Import "-lkernel32"
?
Extern "Win32"
	Function CreateFileMapping( hFile,lpFileMappingAttributes,flProtect,dwMaximumSizeHigh,dwMaximumSizeLow,lpName$z )
End Extern

CreateFileMapping( Null,Null,Null,Null,Null,Null )

</pre>)<br><br>Now how would i get access to them? <br><br></td></tr></table><br>
<a name="972773"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SebHoll</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> You're quite unlucky - you are nearly there.  There is one added complication when dealing with Win32 API functions that accept strings as parameters.  Most of the functions (apart from the very new ones that are unicode only) have two separate forms - one that expects <b><u>A</u>NSI</b> strings and one that expects new unicode <b><u>W</u>ide Char</b> strings.  You have to choose which one you want to use, and append either 'W' or 'A' onto the end of the function name. E.g. <b>CreateFileMappingA()</b> or <b>CreateFileMappingW()</b>.<br><br>If your target platform is Windows 2000 or higher, you should use the 'W' functions in favour of the 'A' equivalents as your app will be able to run better on platforms with extended character sets (e.g. Chinese, Japanese symbols).<br><br>So add a 'W' onto the end of your function name, and change your last <b>lpName$z</b> parameter to <b>lpName<u>$w</u></b> and it should now compile.<br><br><pre class=code>?Win32
Import "-lkernel32"
?
Extern "Win32"
	Function CreateFileMappingW( hFile,lpFileMappingAttributes,flProtect,dwMaximumSizeHigh,dwMaximumSizeLow,lpName$w )
End Extern

CreateFileMappingW( Null,Null,Null,Null,Null,Null )
</pre> <br><br></td></tr></table><br>
<a name="972798"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >beanage</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I love you. I spent 8 hours failing to find this out today, thanks to you i (was) finally made it :) <br><br></td></tr></table><br>
<a name="972915"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >beanage</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Another question.. how to get the values of all those API constants.. some seem to be ducumented, others not, some can be found on google, others not.. is there a proper source or a shell command or a "Extern const" syntax to determine? <br><br></td></tr></table><br>
<a name="972917"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >beanage</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, alright. found a WINBASE.H in my Borland\CBUILDER\INCLUDE\WIN32 .. all constants i need seem to be documented there.<br><br><a href="http://www.activevb.de/rubriken/apiviewer/index-apiviewereng.html" target="_blank">API Viewer 2004</a> also proves to be a great tool. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
