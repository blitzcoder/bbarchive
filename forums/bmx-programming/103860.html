<!DOCTYPE html><html lang="en" ><head ><title >How to get rid of orphan definitions?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >How to get rid of orphan definitions?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >How to get rid of orphan definitions?</a><br><br>
<a name="1254202"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Codebox</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I am currently refactoring a code which has extensive use of Globals (and Const) and it's only using functions as well. (No Types as abstraction level usage or classes at all)<br>Bad part about it: it was originally some kind of a game-engine-framework-mix-piece which contains variables for 5 different setups (or games). <br>Already one game is left (functions), but - hard to guess, I know -, the variables still in the source. <br>My question is, how can I easily check the source if there are orphan Definitions of Globals. Anyone got a hint... a tool or something specific to blitzmax language?<br><br>I use BlIDE for coding and the Analyzer works great, but lacks exactly this feature :-/<br><br>any help is appreciated :-) <br><br></td></tr></table><br>
<a name="1254206"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Didnt Blide tell if a variable was unused? Last time I checked it (some years ago) I thought it mentions it somewhere. Maybe "today" it just colorizes it differently.<br><br>If you have "block definitions" (areas containing global after global) you could just block-comment them (rem...endrem) and then try to compile. Each blamed "missing" or unknown variable is then put back into life.<br>Tedious but I doubt you have thousands of variables to check. So instead of waiting for the right tool you might already have finished refactoring.<br><br>bye<br>Ron <br><br></td></tr></table><br>
<a name="1254211"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Codebox</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, regardless which "blocking" I use (function, type etc.), it doesnt work. So I'll have to use the commenting-out-way. <br><br>Oh..  not thousands ... but around 800 ....<br><br>Well.. refactoring .. no one told it's easy :D<br><br>neverless, Danke :-) <br><br></td></tr></table><br>
<a name="1254224"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> with blocking I meant <br><br><pre class=code>
global a:int = 1
function funca()
End function

global b:int = 1
function funcb()
  global c:int = 1
End function

</pre><br><br>compared to<br><pre class=code>
global a:int = 1
global b:int = 1
global c:int = 1

function funca()
End function

function funcb()
End function
</pre><br><br>Another option is to "search in all documents" - search for your global in all documents (source files) and if result count = 1 ... then it is unused.<br><br><br>bye<br>Ron <br><br></td></tr></table><br>
<a name="1254225"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >videz</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> hmm. im not using bmax but still related to programming and blitz..<br><br>What I would do is get a search file content tool and find those global names you are aiming for. There's some search utilities that will list them including the file and line number where they appear. then you can evaluate and start refactoring those orphans ;)<br><br>I could not give you a specific tool to use because its been a long trade secret of mine but google is your friend :) <br><br></td></tr></table><br>
<a name="1254243"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xerra</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Blide does indeed tell you if a variable is unused in a listing. It's underlined in wavy green lines and hovering your mouse over it gives you some message about that "variable is never referenced anywhere in your code"<br><br>I can't give the exact information as I'm at work and can't test it but it's something along those lines. <br><br></td></tr></table><br>
<a name="1254245"></a>

<a name="1254247"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Codebox</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> I tried some stuff out and the Code-Analyzer, besides some nice checks about bad practices (Type-Declaration within Functions (just testing :-D)) doesn't check orphaned globals... only locals. <br><br>Try <br><pre class=code>
SuperStrict
Global unused:int
</pre><br>and the analyzer doesn't "respond".. but<br><pre class=code>
SuperStrict
Local unused:int
</pre><br>and et voila, you've got a warning. regardless which scope the orphaned declaration is.<br><br>Actually I use the commenting-out-way and make some good progress... STRG+SHIFT+M, STRG+F5 .. succeed? delete Line, else i will be thrown into error-location, pressing STRG+Z and move on to next line ... <br><br></td></tr></table><br>
<a name="1254334"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Zethrax</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Get yourself a good text/code editor (such as EditPlus - <a href="https://www.editplus.com/" target="_blank">https://www.editplus.com/</a> ) that has Find-In-Files search functionality. You can go through your identifiers as you encounter them and generate a list of all their instances with the files, lines and character positions listed. In the case of EditPlus you can double-click on the listing and it will open the file at the position where the identifier appears.<br><br>I've used this feature to clean up code similar to what you describe in the past. It's time consuming, but far less so than going through all your code and eyeballing it manually.<br><br>But if you're looking for a fun coding project then it probably wouldn't be massively difficult to create a program to detect orphaned identifiers. I'm tempted to write something similar as I have quite a bit of code that's suffered indignity from my past experiments in identifier markup standards. <br><br></td></tr></table><br>
<a name="1254526"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ziggy</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Zethrax: BLIde does this too, there's no need for any additional tool. <br><br></td></tr></table><br>
<a name="1255315"></a>

<a name="1255318"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> As an aside, depending on the project, not all definitions that are uncalled in visible code are necessarily "orphaned".<br><br>e.g. if you use a lot of reflection, a method might only ever be accessed by dynamic name lookup at runtime, which can't be determined from a static analysis. This is a pattern I use a lot (handy to separate your driver loop/navigator from your data operations, via dynamic delegate). <br><br></td></tr></table><br>
<a name="1255331"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> But with default reflection code you wont be able to access "globals" by name ... so for "globals" the analysis might work in most cases.<br><br>For methods ... of course, that is why for methods the message should be "propably never called" instead "is not called".<br><br><br>bye<br>Ron <br><br></td></tr></table><br>
<a name="1255459"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >zoqfotpik</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is a good job for unix tools like awk.<br><br>Make a list of words immediately following "Function."<br><br>Search your code for those words and count occurrences of those words (grep -v blah | wc -l or something like that).<br><br>For each word whose count is only 1 (that is, for the function definition itself refers to that word) you have an orphan.<br><br>Remove each orphan.<br><br>Run the whole process again, since one orphan might be referenced by code inside of another.  <br><br>Pro Tip: Don't actually make the removal automatic, do that step yourself and comment it out instead of removing it, and it might be a great idea to do this one function at a time, with testing in between (you do have full coverage of unit tests, right?) to make sure your program still runs fully. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
