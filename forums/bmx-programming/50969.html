<!DOCTYPE html><html lang="en" ><head ><title >Faster comparisons</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Faster comparisons</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Faster comparisons</a><br><br>
<a name="568110"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> If I have an int variable that contains the value 4, would it be faster to do:<br><br>If variable&gt;0<br><br>or<br><br>If variable&lt;&gt;0<br><br>??<br><br>I know that in assembler, you can check for `nonzero` without having to compare with another value/register, whereas &gt;0 probably needs extra time? or probably both the same on a modern cpu? <br><br></td></tr></table><br>
<a name="568131"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shambler</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just tested it and if variable&lt;&gt;0 comes out faster by a whisker of a whisker after many millions of operations.<br><br>It doesn't look like Blitz can or is optimising anything under the hood or that any optimisation has any great effect. <br><br></td></tr></table><br>
<a name="568206"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >rdodson41</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> If that is what is really slowing down your code, something is seriously wrong. <br><br></td></tr></table><br>
<a name="568279"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DH</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> X&gt;Y<br>and<br>X&lt;&gt;Y<br>Should be the same time regardless.  The processer has built in comparrisons meaning that since this is simply a register to register comparrison that it should be the same time for both (the processer does it simultaneously)<br><br>When you compare 2 registers in a processer, it runs each register through a series of AND gates.  one side of the gate is going to the first bit of the first register, and the second is going to the first bit of the second register and so on.<br><br>When the enable flag goes true on the chip it opens the gates for input.  The output is a true of false (for comparrison, so is it equel or not equel).  Behind the scenes (elsewhere on the chip) are another series of AND and XOR gates which run through which is greater than the other (IE is reg 1 greater or lessthan reg 2).  This is simultaneous as well (ok, well as fast as an AND gate can switch states which is nothing).<br><br>So when you ask is A&gt;B the CPU is returning the secondary portion of the compare.  When your asking is A&lt;&gt;B or is A=B then the CPU is returning the primary portion of the compare.  When you ask is A&gt;=B then it returns an OR operand of both the primary and secondary portions of the compare.<br><br>So, there should be no difference between the two.<br><br>When making optimizations you must really know what your doing on the CPU.  A+B is cheap, A*B is more expensive, Sin(A) is extremely expensive.  Why?<br><br>A+B is a bit wise XOR operation.  If REG1bit1 =1 and REG2bit2 =1 then carry the 1 and output a 0.<br><br>A*B is a bit wise XOR (like the addition) but using a multiplier.  A+A (b times).  Getting around this the cpu uses a base number, does a bit shift, and whalla (a bit more complex than that, but you get the point). <br><br>Sin(a) we're not going to go into.  It requires a bit of math.<br><br>Doing compares are the same way.  A comparrison between 2 registers is the same regardless of the way your comparring it.  Doing "is a=b" is easy.  Doing "is A=B and B=C" is merely doing 3 comparrisons as oppsed to one (first checking a to b, then b to c, then AB to BC)<br><br>So if you want to make small optimizations then look elsewhere :-)  For example look at loops your doing and how many moves on the program stack your making (IE calling functions, Complex math that can be simplified, or messy comparrisons that can also be simplified).<br><br>As a good measure, stay away from comparring strings if you can help it.<br><br>Hope this helps! <br><br></td></tr></table><br>
<a name="568298"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Snarkbait</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you just want to check if it is nonzero, you can just go:<br><br>if variable<br>...<br>endif<br><br>don't think it's a discernible speed difference tho. <br><br></td></tr></table><br>
<a name="568997"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Good idea about treating the variable as boolean, for tidyness sake, snarkbait.<br><br>I understand how processors work. On the 68000 series, however, operations such as branching based on conditions would use automatically set results produced from certain previous operations. You didn't have to explicitly compare two variables in order to set the condition flags, and the condition flags, once set, could be used in the decision of whether to branch - based on a given flag. So you could branch if zero, branch if nonzero, branch if greater than zero, etc... so it was faster to do that than to compare two variables.<br><br>I also don't think that anyone can ever claim that a certain piece of code is pointless to be optimized under all circumstances, because you have no idea how many times it is being called or how important it is in the overall picture. This is for a very very time-critical highly-used lots-of-processing routine so little bits of difference really do add up.<br><br>It's not so important that I'll lose sleep over it, especially as Blitz seems to not optimize it too well. I just wondered. <br><br></td></tr></table><br>
<a name="569003"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I also don't think that anyone can ever claim that a certain piece of code is pointless to be optimized under all circumstances, because you have no idea how many times it is being called or how important it is in the overall picture. This is for a very very time-critical highly-used lots-of-processing routine so little bits of difference really do add up. <br></div><br><br>I would question that mindset completely. After reading your worklog I thought you may have finally abstracted yourself from the machines you were programming.<br><br>Once a project is finished maybe, but in development your mantra should always be simplify to reduce complexity not obfuscate to increase efficency. <br><br></td></tr></table><br>
<a name="569005"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Robert</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I also don't think that anyone can ever claim that a certain piece of code is pointless to be optimized under all circumstances, because you have no idea how many times it is being called or how important it is in the overall picture. This is for a very very time-critical highly-used lots-of-processing routine so little bits of difference really do add up.<br> <br></div><br><br>I would be very surprised if I saw your code and could not find a more significant optimisation.  <br><br>This kind of thing is so trivial it doesn't even matter on a Z80, let alone a 3Ghz Pentium 4. <br><br></td></tr></table><br>
<a name="569008"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warren</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's worrying about stuff like this that kills projects. <br><br></td></tr></table><br>
<a name="569011"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Reading the .s files that BlitzMax produces in release mode in the project's .bmx directory does make some interesting reading. I was thinking on Intel<br><br>test eax,eax<br><br>was possibly a slight improvement over<br><br>cmp eax,0<br><br>but the 5 generations of Pentiums you have to consider and of course the plethora of AMD designs makes the consideration seem a bit fruitless <br><br></td></tr></table><br>
<a name="569510"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Mr skidracer, your first comment there is offensive.<br><br>I appreciate your opinion but I don't agree with you.<br><br>Robert, there does come a point where something can't be optimized much further.<br><br>Warren, you're taking it too seriously. It's just a question. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
