<!DOCTYPE html><html lang="en" ><head ><title >Vista powersaves mid-game and messes up</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Vista powersaves mid-game and messes up</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Vista powersaves mid-game and messes up</a><br><br>
<a name="826973"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> One of the testers for my game reported this:<br><br>"While game is in fullscreen or active application, the machine shouldn't enter powersaver mode in Vista (Xp functioned correctly). However both failed when they were in windowed mode and active application, screensaver would start. <br><br>Also, in Vista, after resuming from powersaver mode, game had closed down and desktop resolution was reset to 800X600. "<br><br>Anyone come across this before?  Perhaps there is a way to let windows know not to screensave and not to powersave? <br><br></td></tr></table><br>
<a name="827009"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Let me clarify this, there are two issues:<br><br>1) Is it possible to prevent powersaving in Vista when the app is full-screen or windowed?  If not, then is it possible to prevent the crash on returning from power saving mode (I may need to write a simple test app to see if it's some piece of complex code in my game crashing on return from power save, or if it's something very simple that can be shown up with a basic graphics window).<br><br>2) Is it possible to stop the windows screensaver from coming up if your game is active (in windowed mode - I think it doesn't come up already in full-screen mode).  This issue is not vital in my opinion.<br><br>Thanks all for any help :-) <br><br></td></tr></table><br>
<a name="827011"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DStastny</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I cant remember off the top of my head but your application needs to handle WM_POWERSAVE or something like.  I am on vacation and cant really access the source that I need.  But you will need to modify the source or get mark to of the core windows message pump to handle.<br><br>Doug Stastny <br><br></td></tr></table><br>
<a name="827016"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> 2) Yes, but you need to be handling the windows message pump yourself, as Budman already mentioned. You need to monitor for WM_SYSCOMMAND and if you get one, check if it's the SC_SCREENSAVE message. When this happens, this basically Windows saying "Hey, I think I'm gonna start the screensaver now. Do you mind?" If you return True from your WndProc, you're saying you don't mind. If you mind, you return False.<br><br>I guess BlitzMax needs a DisableScreensaver() and EnableScreensaver() pair of functions, because I don't think you can do this without creating your own window and managing it, which I'm guessing would be incompatible with your framework, and if Mark just sets BMax to tell the screensaver not to start always, he'll get complaints from people who don't want their applications stopping the screensaver.<br><br>Personally, I think it's a bad practice to disable the screensaver in an application, but a bad practice *not* to disable it in a game. I hate when games don't disable the screensaver. Only on the rare occasion I've reformatted and not completely disabled it, of course, but still. Don't like it. <br><br></td></tr></table><br>
<a name="827029"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Win32 OpenGL was fixed along time ago so joystick players didn't suffer from this problem, perhaps the dx window message pump needs the fix also, from glgraphics.win32.c[86]:<br><pre class=code>
	case WM_SYSCOMMAND:
		if (wp==SC_SCREENSAVE) return 1;
		if (wp==SC_MONITORPOWER) return 1;
		break;

</pre> <br><br></td></tr></table><br>
<a name="827055"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> sounds like a good solution.  Who is in chare of the dx code?  Can they make it standard?  And this deals with the power save issue too right?  I mean is SC_MONITORPOWER the main power saving flag that will kick in when power saving kicks in or are there others?<br><br>Thanks <br><br></td></tr></table><br>
<a name="827946"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Can anyone at BRL implement this then please?  Thanks <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
