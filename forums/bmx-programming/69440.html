<!DOCTYPE html><html lang="en" ><head ><title >Does it take longer to draw mipmapped images?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Does it take longer to draw mipmapped images?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Does it take longer to draw mipmapped images?</a><br><br>
<a name="776916"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've got an image that I want to show shrinking on screen and normally I load my images with the default flags of MASKEDIMAGE and FILTEREDIMAGE (for scaling up) but the docs say I should also use MIPMAPPEDIMAGE if I want to draw it scaled down.<br><br>I recall hearing that one of these flags greatly increases the Video RAM used for a texture.  Also I was wondering, would a MIPMAPPEDIMAGE be slower to draw than a normal image or is the "hard work" all done when it's first loaded?<br><br>Also I draw a lot of my particles smaller than normal scale so perhaps I should use MIPMAPPEDIMAGE on them to make them look better, but not if it will slow them down...<br><br>I know I could test this but just wondered if anyone had a quick answer.  Thanks! <br><br></td></tr></table><br>
<a name="776965"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >marksibly</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Mipmaps consume some memory, but can actually be faster to render.<br><br>This is because they are more texture cache friendly. If you're drawing a scaled down mipmapped image, texels are frequently fetched from the same/similar areas of vram.<br><br>But if you're drawing a scaled down non-mipmapped image, texels reads are much more 'scattered', resulting in poor cache performance. <br><br></td></tr></table><br>
<a name="777046"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Use mipmaps.  Not using them is not only unlikely to result in any kind of perceptible speed increase in any realistic scenario, but is very likely to slow things down.  <br><br>That is, if you were rendering detailed 3D scenes with lots of textures.  You're rendering some particles.  You'll never see a difference in speed.  But you will see a big difference in image quality. <br><br></td></tr></table><br>
<a name="777048"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> OK thanks guys.  So basically I should make all my particles mipmapped and anything else which is being scaled down.  At some points I do have a lot of particles and my FPS drops from 400 to 200 so I'll see if the mimapped particles change that. <br><br></td></tr></table><br>
<a name="777148"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Grey:<br>Your framerate probably drops when you have a lot of particles for the same reason it did in Blitz3D.  State changes.  <br><br>State changes are things like telling the 3D card to change the texture being used to render polygons.  I am not very knowledgeable in this area, but I think pretty much anything that changes the appearances of polygons counts as a starte change.  Changes in color, alpha, or blend mode could all trigger a state change.  And for all I know Max itself could strigger a state change for each image drawn on the screen regardless of whether or not you draw two identical images one after the other.<br><br>But the point is, state changes, have in the past, when I was using Bltiz3D, been really expensive.  I don't know how expensive they are on modern cards, but "I have lots of particles and my framerate dropped a lot" sounds exactly like the issues I was having with my old particle system in Blitz3D.  200 particles onscreen at once, and the framerate would drop to like 30fps.  Of course this was on a card from  six years ago.  So 400fps down to 200fps might be the sort of speed change you see on modern cards for that.<br><br>Something else to keep in mind is that if your framerate drops to half with X number of particles, then doubling the number of particles will make it drop by only half again.  And you'd still be getting 100fps at that point.  So that's something to seriously consider if you already have as many particles as you need.  The rest of your graphics probably won't be nearly as gpu intensive as that initial batch of particles.<br><br>Also, the difference between 400fps and 200fps may sound like a lot, but it's only 2.5 milliseconds per frame difference.  That's 2.5 out of say 16 total available per frame, if you want to stay over 60fps.<br><br>In short, you should mipmap them cause it will look better, but you're probably worrying needlessly about speeding things up at this point. <br><br></td></tr></table><br>
<a name="777151"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you want to avoid state changes try using the TAnim code on these forums (somewhere). It uses a single texture with texture coordinates to display images (single-surface). <br><br></td></tr></table><br>
<a name="777153"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks sswift.  I basically don't know much about 3D cards you see, I just use BMax and hope that it's doing a good job (it seems to be).<br><br>I actaully ran some tests on my game and got these results:<br><br>1) Game idle = 401FPS<br>2) non-mipmapped particles = 180/198 (2 tests, picked lowest FPS)<br>3) did not draw the particles = 323/329<br>4) mipmapped particles = 205/228<br><br>So basically my particle code costs around 75 FPS.  That's OK though because my TParticle is a very flexible object and I don't want to lose the flexibility for speed.  This 75FPS could of course go up on slower PCs....<br><br>The drawing costs around 135FPS or 110FPS when mipmapped.  So that would appear to prove that mipmapped may be faster, it certainly doesn't harm performance.  On some slower graphics cards this may drop.<br><br>It's very easy for me to change the number of particles in the particular sequence I was testing so if it turns out to be too many for lots of slower PCs then I'll tame it down.  OR I might actually run a little test when the game first loads to see the speed of the machine and then tune the particles accordingly, this would be cool, and a nice addition to the framework :-)<br><br>My machine is 3 years old now, a P4 3.2 and a radeon 9800XT.  So it was good in it's day and may still be better than a lot of budget PCs but it's certainly not up to date.  Even if on some crappy laptops the odd frame is missed so FPS drops from 60Hz (I'll be using Flip1) to 30HZ it won't look bad due to the fixed rate logic and delta code catching up. <br><br></td></tr></table><br>
<a name="777165"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> So how MUCH more memory do mimapped textures take?  Should I load everything as mipmapped? <br><br></td></tr></table><br>
<a name="777178"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Mipmapped textures take approximately 1.33x as much space as a regular texture.<br><br>1 + 1/4 + 1/16 + 1/64 ... = 1 + 0.25 + 0.0625 + 0.015625 = 1.32815.  <br><br>It approaches 1.33x as you use larger and larger textures, but will never exceed that.<br><br><br>And yes, you should, there is no reason not to, unless maybe you had a huge image to display and video memory was really tight, and you never planned to scale the image down, or was trying to get a retro look or something very special case like that. <br><br></td></tr></table><br>
<a name="777186"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ah I understand now!  Thanks very much, your wisdom knows no bounds (at least with regards to this subject ;-)). <br><br></td></tr></table><br>
<a name="777253"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> There is another reason why particle systems actually can slow the whole thing down especially when use on regular office like systems which are assumed to be the "casual gamer market":<br><br>Its overdraw ... if you draw again and again over the same spot, which is something that tends to happen with particle effects, this can cause some serious performance break ins on lower end cards and especially Intel GMA 900 and 950 with their inexistant fillrate. <br><br></td></tr></table><br>
<a name="777256"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> yeah.  But it's hardly worth writing a dirty rects system for them, I did that before in BlitzPlus and it was a pain. <br><br></td></tr></table><br>
<a name="777265"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Definitely :-)<br><br>Its simpler to design particle effects with textures that have more than a single "blob" on for example and make it look like it has more particles than it has ...<br>Gives double advantage: less overdraw and fewer particles to update<br><br>That was one of the things where I think Indiepaths R2T module is of very large help ... updating a few different particle textures in pseudo realtime (tick based) and use them to create larger particle effects combining those dynamic textures.<br>As the module renders to the texture instead of the backbuffer, the main bottleneck of regular Max2D dynamic textures is removed: grab and convert from pixmap to texture.<br><br>(i just called it clustered particle system, don't know if this kind of effect has already a name ... sadly the system is of not much use anymore as I never updated it to newer BM especially since the DX side broke the R2T module by removing some needed functions) <br><br></td></tr></table><br>
<a name="777269"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ah I see, sounds cool. <br><br></td></tr></table><br>
<a name="777270"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Dreamora's right. This is why even high end games often use big flame images for fire effects instead of making a fire out of many small particles. It's not just the updating, it's to cut down on the overdraw, and hence the fillrate requirement. Ever walked up close to a particle effect in a game and seen the framerate plummet? That's why. Because you haven't got more particles to update as you get closer, so it's not that. But you have got more overdraw and cranking up the fillrate.<br><br>I think I'm right in saying that fillrate is the single biggest problem on modern videocards ( because the old state change problem is slightly reduced on modern videocards. It's why multipass shaders can be so expensive. <br><br></td></tr></table><br>
<a name="777339"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> fillrate has ALWAYS been the problem even on old games, that's why dirty rects were so important, and every other trick in the book.  Nowaways it's less relevent but you gotta watch the particle use for sure. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
