<!DOCTYPE html><html lang="en" ><head ><title >Drawimage with vertex colours</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Drawimage with vertex colours</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Drawimage with vertex colours</a><br><br>
<a name="728174"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >necky</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Does anyone know how to update this D3D textured poly function to allow for vertex colours as well as UV coordinates on each poly vert?<br><br><a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=1812" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=1812</a><br><br>Ideally, if anyone knows of a function or module that allow for an advanced 'drawimage' with the addition of vertex colours that would be cool. I`ve taken a look on the forums and can't find anything of this nature.<br><br>thanks,<br>andy. <br><br></td></tr></table><br>
<a name="728261"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xMicky</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> 1) vertex colors: instead of<br>c[ii+3] = Driver.DrawColor<br>set:<br>c[ii+3] = alpha Shl 24 | red Shl 16  | green Shl 8| blue<br>(alpha, red, green, blue:INT in the range 0 to 255)<br><br>2) uv: <br>uv[ii+4] =  u<br>uv[ii+5] =  v<br>(u, v:FLOAT  in the range 0 to 1)<br><br>Shame on me that I haven't commented "thank you" at Progers article  yet, because it offers really an explosion for the 2D-graphic-capabilities of BlitzMax ! So I take the possibility here: Thanks a lot ! <br><br></td></tr></table><br>
<a name="728290"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >necky</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Michael! That's just what I was after.<br><br>Andy <br><br></td></tr></table><br>
<a name="729016"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >necky</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks again for your help Michael. I`ve almost completed the function but there's still a couple of issues that are puzzling me.<br><br>When I set the U or V coordinate I assumed a value of 1.0 would give me the furthest right &amp; bottom edges of the loaded image. Instead, after a lot of blind number changes, I`m having to put in 0.72 for U and 0.585 for V? Any idea what this magic numbers relate to?<br><br>Second problem is the rotation of the image. If you run the below code you'll notice my coloured image is rotated the same as the DrawImage version except it's offset? Any idea why this is happening?<br><br>Strict<br>Graphics 640,480<br>SetClsColor 100,100,100<br>Cls <br><br>Local Image:TImage = LoadImage("Dizzy.png", MASKEDIMAGE)<br><br>Local ColA:Int[] =  [255,255,192,0]<br>Local ColB:Int[] =  [255,255,0,0]<br>Local ColC:Int[] =  [255,0,0,128]<br>Local ColD:Int[] =  [255,0,0,128]<br>Local XPos#=100<br>Local YPos#=50<br><br><br>SetRotation 45<br>SetBlend AlphaBlend<br>SetScale 2,2<br>SetAlpha 1.0<br><br>DrawImage Image,XPos,YPos<br>DrawColImage Image, XPos, YPos, ColA, ColB, ColC, ColD<br><br>Flip<br>WaitKey<br><br><br>'----------------------------------------------------------------------------------------------------<br>' DrawColImage &lt;IMG&gt;, XPos#, YPos#, ColA[], ColB[], ColC[], ColD[], Frame%<br>'----------------------------------------------------------------------------------------------------<br><br>Function DrawColImage( image:TImage,Xp, Yp, ClrA[], ClrB[], ClrC[], ClrD[], frame=0)<br><br>	Local handle_x#, handle_y#<br>	GetHandle handle_x#, handle_y#<br>	Local tx#, ty#<br>	GetOrigin tx#, ty#	<br><br>	Local Alph#=GetAlpha()<br>	ClrA[0]=ClrA[0]*Alph<br>	ClrB[0]=ClrB[0]*Alph<br>	ClrC[0]=ClrC[0]*Alph<br>	ClrD[0]=ClrD[0]*Alph<br><br>	Local Driver:TD3D7Max2DDriver = TD3D7Max2DDriver(_max2dDriver)<br>	<br>	Assert Image, "Image not found"<br><br>	Local uv#[24]<br>	Local ImgWidth#=Image.width<br>	Local ImgHeight#=Image.Height		<br>	Local x#=Xp+Handle_X#<br>	Local Y#=Yp+Handle_Y#<br><br>	Local LeftX#=x<br>	Local RightX#=x+ImgWidth#<br>	Local UpY#=y<br>	Local DownY#=y+ImgHeight#<br><br>	Local c:Int Ptr=Int Ptr(Float Ptr(uv))<br><br>	uv[0]=LeftX#*Driver.ix+UpY*Driver.iy+tx							'--X POS<br>	uv[1]=LeftX#*Driver.jx+UpY*Driver.jy+ty							'--Y POS<br>	uv[2]=0 										'--Z POS<br>	c[3]= ClrA[0] Shl 24 | ClrA[1] Shl 16 | ClrA[2] Shl 8 | ClrA[3]				'--ARGB COLORS<br>	uv[4]= 0.0 ; uv[5]= 0.0									'--UV COORDS<br><br>	uv[6]=RightX#*Driver.ix+UpY*Driver.iy+tx<br>	uv[7]=RightX#*Driver.jx+UpY*Driver.jy+ty<br>	uv[8]=0<br>	c[9]= ClrB[0] Shl 24 | ClrB[1] Shl 16 | ClrB[2] Shl 8 | ClrB[3]		<br>	uv[10]= .72 ; uv[11]= 0.0						<br>	<br>	uv[12]=RightX#*Driver.ix+DownY*Driver.iy+tx<br>	uv[13]=RightX#*Driver.jx+DownY*Driver.jy+ty<br>	uv[14]=0<br>	c[15]= ClrC[0] Shl 24 | ClrC[1] Shl 16 | ClrC[2] Shl 8 | ClrC[3]		<br>	uv[16]= .72 ; uv[17]= .585<br><br>	uv[18]=LeftX#*Driver.ix+DownY*Driver.iy+tx<br>	uv[19]=LeftX#*Driver.jx+DownY*Driver.jy+ty<br>	uv[20]=0<br>	c[21]= ClrD[0] Shl 24 | ClrD[1] Shl 16 | ClrD[2] Shl 8 | ClrD[3]		<br>	uv[22]= 0.0 ; uv[23]= .585			<br><br>	Driver.SetActiveFrame TD3D7ImageFrame(image.Frame(frame))<br>	Driver.device.DrawPrimitive(D3DPT_TRIANGLEFAN,D3DFVF_XYZ| D3DFVF_DIFFUSE | D3DFVF_TEX1,uv,4,0)<br><br>End Function<br><br><br><br>Thanks for your help,<br>andy<br><br>p.s. how do you embed code into a code box? <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
