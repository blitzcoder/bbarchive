<!DOCTYPE html><html lang="en" ><head ><title >Global illumination?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Global illumination?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Global illumination?</a><br><br>
<a name="820769"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> If I understand correctly, this is how to do GI:<br><br>-Render direct lighting using a raytracer.<br>-Render the scene from the view of each luxel, and take the average pixel color from that...<br><br>Then what?  If I add that value, bright areas of the map become twice as bright.  If I scale it to lessen the value, dark areas don't get lit much.  The results I am getting just don't look right, and it creates many strange artifacts.<br><br>It seems like rendering from the luxel position doesn't really account for the way light bounces off surfaces.<br><br><img src="http://www.leadwerks.com/post/gi.jpg"> <br><br></td></tr></table><br>
<a name="820771"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I use it as the ambient factor. Set a global ambient which you then multiply by your global illumination pass, and use the result as the ambient in your traditional lightmapping/lighting equation. <br><br></td></tr></table><br>
<a name="820786"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> It seems like the mathematically correct way to do this would be to bounce the rays off surfaces and add them to wherever they hit.  I don't think rendering the scene from the luxel position is even close to realistic. <br><br></td></tr></table><br>
<a name="820801"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AramusM</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you bounced rays off a surface and added them to whatever they hit wouldnt you want an attenuation factor taking into account the distance from the reflecting texel and the receiving luxel? The attenuation factor being based on the emissivity and specularity of the surface?<br><br>I could be talking out my arse, its been many years since I looked at raytracing back on my old Amiga. <br><br></td></tr></table><br>
<a name="820803"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think the primary problem would be your rays would scatter, and you would get dots of light.<br><br>I'll put this away for now and maybe take another try later. <br><br></td></tr></table><br>
<a name="820806"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >fredborg</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> You need render a hemi-cube (half a cubemap) from each texel, and then weight each pixels acording to the angle between the texel normal and the view direction (dot product). Then just add the result back to the texel (lightmap for instance) color. You may want to wait with updating your lightmap until all the rendering is completed to avoid the render pass to self-influence.<br><br>It's very simple, and can be written in around 50 lines of code.<br><br>You can find a good introduction to this method here:<br><a href="http://freespace.virgin.net/hugo.elias/radiosity/radiosity.htm" target="_blank">http://freespace.virgin.net/hugo.elias/radiosity/radiosity.htm</a> <br><br></td></tr></table><br>
<a name="820823"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> What do you do, just use a really low camera zoom?  The paraballoid rendering they show won't work without highly tesselated geometry. <br><br></td></tr></table><br>
<a name="820825"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >fredborg</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Try scrolling down the page a bit :) <br><br></td></tr></table><br>
<a name="820841"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the tips.<br><br>The big problem I was seeing was that GI would cause bright areas to get uncontrollably bright.  So I added a threshold value above which GI would no longer be calculated.  Here, only luxels darker than 64 will be brightened with GI.  It makes the dark areas get new lighting and shadows, and keeps the bright areas the same:<br><br>Global illumination:<br><img src="http://www.leadwerks.com/post/gi2.jpg"><br><br>Direct lighting only:<br><img src="http://www.leadwerks.com/post/gi3.jpg"> <br><br></td></tr></table><br>
<a name="820854"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> If my vague understanding is correct, and I have never coded this whatsoever, lighting is more of a holographic system. The light at each point in space is the total contribution from every other point in space including all light that is reflected off of or filtered through everything else. Ie the light which is `everywhere` is in the `part` and vice versa. It is also necessary that every single point in space be calculated simultaneously in order for there to be a global accumulation of light. Anything less than that is an approximation and achieving that accuracy/correctness is probably not feasible with any computer.<br><br>You are slightly aided by time, in that light rays seem to take time to travel a distance rather than be everywhere instantly, which partly `localizes` their influence. Maybe you can play on that.<br><br>How to do this technically in an approximate or visually pleasant and fast enough way seems to be an erea of considerable ongoing research at the moment. Good luck with it. <br><br></td></tr></table><br>
<a name="820896"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >North</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey Josh,<br><br>i don't think this strategy is playing out well. Looking at your last screenshots you lost visual quality due to a much lesser tonal range in the image - this seems to be a direct result of brightening darker areas with GI only. Especially look at edges and into the distance. The areas with normally high occlusion of light get overly exposed now.<br><br>Infact your initial screenshot looks the best in this regard. Are you in some way applying the techniques found in the paper on radiosity linked above? I think the parts about Lambert's Cosine Law are an interesting approach. <br><br>I hope you find a smart way of applying GI lighting - Loved your first screeny :) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
