<!DOCTYPE html><html lang="en" ><head ><title >Millisecs() causing an issue</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Millisecs() causing an issue</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Millisecs() causing an issue</a><br><br>
<a name="724259"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Scott Shaver</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> This might not be considered a bug because it is documented correctly but it is wierd.<br><br>millisecs() returns Milliseconds since computer was turned on.<br><br>well I use that function to determine if an amount of time has passed by doing:<br><br>if millisecs()-lastUpdate &gt; frameSpeed then ....<br><br>well for the first time, I had code that was working perfectly and now doesn't because my machine has not been rebooted in a very long time. Millisecs() is now returning a negative number which screws up the code shown above.<br><br>shouldn't millisecs() be returning the current time in milliseconds instead of the number of milliseconds from the time the machine was turned on?<br><br>If not what is the recommended fix? <br><br></td></tr></table><br>
<a name="724260"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> That is not a bug, but common behavior between 24 and 48 days of no reboot (overflow of int)<br><br>What you need to do is to use absolute differences. So use abs(millisecs() - lastUpdate) &gt; frameSpeed<br><br><br>Alternative you can check the millisecs() at boot time and if it is &lt; 0, then do lastUpdate - millisecs() instead of millisecs() - lastUpdate<br><br>EDIT: Reason for the second solution is, that it does not cost any time and due to the existing function pointers in BM, you could easily create to TimeDiff functions which you assign to a global timeDiff function :) <br><br></td></tr></table><br>
<a name="724267"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Scott Shaver</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> great, thanks a bunch <br><br></td></tr></table><br>
<a name="724302"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >marksibly</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> In many cases, the 'abs()' is not necessary.<br><br>As long as lastUpdate an int, stuff like 'elapsed=MilliSecs()-lastUpdate' will work fine.<br><br>But I guess, if in doubt, use abs! <br><br></td></tr></table><br>
<a name="724303"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Pantheon</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> As a small side note, in BlitzBasic using :<br><br>if a &lt; 0 then a = -a<br><br>was faster than using abs(). Im not sure if this is the same for blitzmax but its probaly just because of the overhead due to the function call. Its a preaty insignificant optimization thats not realy worth it. <br><br></td></tr></table><br>
<a name="724318"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BladeRunner</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> You could also just use a masked Millisecs (millisecs() &amp; $7fffffff) and would get rid of the problem. Thats what I do - get this value at the beginning of my mainloop and use it everywhere a timer is set. I think this one-time operation won't cost that much of speed. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
