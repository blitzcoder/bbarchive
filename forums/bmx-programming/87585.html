<!DOCTYPE html><html lang="en" ><head ><title >bad refs:obj=$5d2400 refs=$7ffffae9</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >bad refs:obj=$5d2400 refs=$7ffffae9</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >bad refs:obj=$5d2400 refs=$7ffffae9</a><br><br>
<a name="992926"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >beanage</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> What does this mean? Is it my fault? How can I check out object $5d2400? <br>It just popped in at IDE output console and.. i dont know why.. sounds like an error with refcounting in the gc or something like that.<br><br>Some more app env info: I got blitzmax v1.33 installed. I yet was not able to reproduce the symptom, so I cant really test whether it works on the most recent max version. The occurance *feels* random. I make massive use of circular references, if that plays a role. The warning or error or whatever it is, does not effect the actual appflow (from my pov). I got constant mem usage, logic updates, it .. runs and keeps outputting this...<br><br>bad refs:obj=$5d2400 refs=$7ffffae9<br>bad refs:obj=$5d2400 refs=$7ffffb67<br>bad refs:obj=$5d2400 refs=$7ffff9a8 'see those last 3 halfbytes changing and changing? uua that makes me nervous considering theres no actual persistent relinking of objects going on in the app.<br><br>[edit:] Ok, some browsing the forum I should actually have done before posting this tells me, it has something to do with maxgui, which my app uses too. But.. I mean i create one window and a canvas with it then hide the window and .. it's not that I stress it to the limits .. hopeviously (= "hopefully"+ "obviously") L O L<br><br>[edir2:]NOW it keeps spamming my output with "String:" I DONT HAVE A SINGLE LINE saying <pre class=code>Print "String:"</pre> Guess I'm just gonna go crazy thinking about this .. <br><br></td></tr></table><br>
<a name="992932"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Which version of Maxgui are you using?<br><br>the latest MaxGUI release also assumes that you are using BlitzMax 1.34... <br><br></td></tr></table><br>
<a name="993022"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >beanage</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, I us_ed_ 1.32, until I updated 30 minutes ago.. did run my app in the backround keeping an eye on the output console.. now after ~&lt;20 min this popped in again:<br><br><pre class=code>
bad refs:obj=$5d2400 refs=$7ffff6e5
String:
</pre><br><br>So MaxGUI Version has no effect ..<br><br>This is so ugly not to know where this comes from. I mean, first report of this was like 4 years ago, and its still not cleared. That sucks. <br><br></td></tr></table><br>
<a name="993028"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> The problem is due to a string that is about to be garbage collected but still being referenced by some piece of non BlitzMax code somewhere - probably/possibly/maybe.<br><br>Of interest to someone I'm sure, is collectMem() in blitz_gc.c, which has this section, looking remarkably similar to the afforementioned output :<br><pre class=code>
		if( p-&gt;refs&gt;=0 ){
			printf( "bad refs:obj=$%x refs=$%x\n",(unsigned)p,(unsigned)p-&gt;refs );
			if( (void*)p-&gt;pool==(void*)&amp;bbStringClass ){
				printf( "String:%s\n",bbStringToCString( (BBString*)p ) );
			}
			fflush( stdout );
		}
</pre><br><br>:o) <br><br></td></tr></table><br>
<a name="993037"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >beanage</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yea thats.. I dont know if good to know.. thank you despite Brucey.. first really explaining answer I read, and that code really looks like it'd produce the critical output.<br><br>Now.. the only thing I want to know is, whether this is "dangerous" in any kind. <br><br></td></tr></table><br>
<a name="993065"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Based on what Brucy dug out of the garbage collector I'd go looking for somewhere where you set something to null or a string to "", most likely a string somewhere getting set to "" under some odd condition. Possibly this is causing a de-reference of a string you want (I'm guessing you don't notice since it's probably being set to nothing anyway).<br><br>My out of the blue theory would be that this is a bad thing (since bad memory handling is always a bad thing) but in your instance it might not be fatal (since if I'm correct in my assumption it's involving setting something to null then when you ask for the value of that something and it allocates a new one it will default to null anyway...). But memory is a scary thing to loose control over since that's where computer gremlins live. <br><br></td></tr></table><br>
<a name="993096"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Have you considered trying 1.34?<br><br>It has an entirely different garbage collector as one of the options you can use. (By selecting multithreaded in the compile options) <br><br></td></tr></table><br>
<a name="993103"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >beanage</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Theres no point for me switching to threaded compilatiion atm, except for just testing if the new gc involves the problem.<br><br>Brucey wrote <div class="quote"> The problem is due to a string that is about to be garbage collected but still being referenced by some piece of <i>[b]non BlitzMax code</i>[b] somewhere <br></div>.. so as I understood the problem may not being directly triggered in a very direct manner by my string-involving instructions, may it? <br><br></td></tr></table><br>
<a name="993105"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GW</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ive written some programs before that used to cause this error to come up about once every second. (multiple versions of bmax)<br>In my case it was related creating, using and destroying many objects in a loop. My program had no external dependencies and no strings were used except for writing to the console and there wasn't much of that going on.<br>I should also note that there was never any memory leaks related to error.<br>Never was really sure what caused the problem. <br><br></td></tr></table><br>
<a name="993221"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >beanage</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thank you all for your replies so far.<br><br>The answers involve this:<br>- The output comes from maxgui (Forum so far)<br>- The output is triggered when a badly referenced string is to be gc'ed (Brucey)<br>- The output is generated when masses of objects are created in a loop (GW)<br><br>So best "solution" for this what-is-it? is to ignore it? Ok. Guess I'll have to live with it, until it causes more trouble, and a public fix is out. Not sure whether i really look forward to this moment. <br><br></td></tr></table><br>
<a name="993324"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jsp</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> A few month ago I suffered also from this problem when using 1.33. <br>bad refs:obj=$115a2780 refs=$630069 (no string message...)<br><br>The problem was not present in Bmax 1.30 and earlier, but came with the introduction of the new GC in 1.32.<br><br>Nevertheless I tracked the problem down to a windows api call/structure – changed that and the problem went away.<br><br>When looking where the problem might comes from, it is quite difficult because of the time delay until the gc cleans up.<br>For me it worked quite fast to find the problem after I thought about, by using debugstop instead of debuglogging what my program does.<br>Putting the debugstop at several positions and check a few seconds if the gc comes up with the error then try the next... and voila.<br>Don't know if it helps, but may give it a try. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
