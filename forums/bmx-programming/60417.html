<!DOCTYPE html><html lang="en" ><head ><title >Allowing only a single instance of a program</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Allowing only a single instance of a program</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Allowing only a single instance of a program</a><br><br>
<a name="673564"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >kfprimm</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Does anyone have a tweak to do this? I know how to do this but I don't know which module to look in to make the changes. I also need a way to pass the command line parameters of the second instance to the first instance. <br><br></td></tr></table><br>
<a name="673579"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Robert Cummings</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> No need to tweak. There is mutex code in code archives which merely gives your program a way to identify if it is already running.<br><br>Search for mutex etc, this has been covered a few times. <br><br></td></tr></table><br>
<a name="673604"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >kfprimm</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sweet...now how would I get the parameters from the second instance? <br><br></td></tr></table><br>
<a name="673626"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >kenshin</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Have the second instance write the parameters to a temporary file before quitting.  Then have the first instance read the parameters from the temporary file and delete it.  If that's too messy, then you could also do the same type of thing using an environment variable or the registry.  Just have the second instance dump it's parameters somewhere and then have the first instance read them. <br><br></td></tr></table><br>
<a name="673653"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FlameDuck</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> now how would I get the parameters from the second instance? <br></div>IPC - Inter-Process Communication. Basicly, you send a message from the second instance to the first. I'm sure some Win32 API shark is going to come around soon enough with an implementation for Windows. Or you could look at MSDN if you're feeling particularly adventureous. <br><br></td></tr></table><br>
<a name="673949"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >kfprimm</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> cool, I'll have a look around.<br><br>kenshin,<br>I thought of using that method but I think its too messy. <br><br></td></tr></table><br>
<a name="673963"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Picklesworth</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> I can give you some C++ example code from my web plugin system which does inter-process communication using two DLLs.<br><br>Since it's kind of ugly and unfinished code, the best solution, of course, is to search for WM_COPYDATA on Google.<br>It is a window message which takes a pointer to a variable. It makes this variable accessible to the target window's process and it sends the message to that process.<br><br><br><br>There may be a bit of complexity using Mutexes for this job, though, as the whole inter-process communication thing requires that you have a window handle for the process. (I'm not sure about windowless processes here... maybe someone else knows that).<br><br>Can we get an actual process handle from a mutex, or is it just one single string that tells us some program, somewhere, is running and wrote the same mutex as the one we're looking for?<br><br>Nonetheless, in order to send messages between your program instances, you would need some way for one of the instances of your program to blindly seek out the other one's window handle using FindWindow, some kind of FindProcess thing (does one exist?), or mysterious mutex functionality.<br><br><br>I, for one, have always despised the concept of searching for window titles to find another application. There may be a better way. <br><br></td></tr></table><br>
<a name="673965"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Robert Cummings</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Dudes, its in code archives already. No need for C++ or MSDN.<br><br>I'd link you but I haven't got time to look right now. The parameter I suspect you mention is the hwnd, which is easy to find in blitzmax... good luck <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
