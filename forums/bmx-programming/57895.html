<!DOCTYPE html><html lang="en" ><head ><title >Protecting game assets?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Protecting game assets?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Protecting game assets?</a><br><br>
<a name="643875"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bukky</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> How would one go about protecting their game assets when they launch a commercial game? For instance, is there a way to package my .OGG and .PNG files so that a user could not access or modify them? <br><br></td></tr></table><br>
<a name="643880"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Helios</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Incbin?<br>Pak Files?<br>Encryption? <br><br></td></tr></table><br>
<a name="643894"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bukky</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey Helios,<br><br>Thanks for the speedy reply!<br><br>I will give Pak Files and Incbin a try. <br><br></td></tr></table><br>
<a name="643899"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Helios</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Your welcome. <br><br></td></tr></table><br>
<a name="643941"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >N</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I use pak (well, sortof, it's a proprietary format based on the original Quake 1 pak format) files.  I <i>considered</i> adding encryption to them, but really, what's the point?  Any person dedicated enough could and 99% of the time would find a way to get the data.  Pak files are more of a content management scheme than anything else -- lets me releases patches and stuff more efficiently. <br><br></td></tr></table><br>
<a name="643951"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ozak</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Indeed. The original diablo had it's decryption code located, it's movies stripped and the indices into the packfile reallocated so the huge data file was only 50 megs without movies. So it's really not worth the trouble. You'd better off making a good regcode system :) <br><br></td></tr></table><br>
<a name="643956"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bukky</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thank you all for the info. <br><br>Does anyone have any links for tutorials/utils (I found one util on this forum) for creating pak files and then using them in BlitzMax?<br><br>Also, as a bit of an aside, do any of you guys have any experience with companies such as TryMedia.com? Good? Bad? Alternatives? <br><br></td></tr></table><br>
<a name="643970"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Helios</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well creating pak files is relativly simple, basically what i do is i write out simple header infomation into the top of the pak file with the location/size/..etc of each files data and then i write out all the data of every file, so you end up with a file format sort of like this.<br><br>--------------<br>Header<br>- File 1<br>-- Size: 100<br>-- Location: HeaderSize+0<br>- File 2<br>-- Size: 200<br>-- Location: HeaderSize+100<br>- File 4<br>-- Size: 220<br>-- Location: HeaderSize+300<br>--------------<br><br>--------------<br>Data<br>-- File 1 Data (position would be HeaderSize+0)<br>-- File 2 Data (position would be HeaderSize+100)<br>-- File 3 Data (position would be HeaderSize+200)<br>--------------<br><br>Then when i load the pak file i mearly read in the header and use that infomation to grab the data of the file i want.<br><br>Hope you understood that, Im not exactly great at explaining things. <br><br></td></tr></table><br>
<a name="643982"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Then when i load the pak file i mearly read in the header and use that infomation to grab the data of the file i want. <br></div><br><br>Of course, if you use a common file format like PNG, JPG, OGG, MP3, etc., people can still easily locate these headers and files in the container file as well, and strip them out... Unless you also encrypt them first, but that has downsides too since you need to add unencryption to all your file loading routines... In the end, it's going to be a trade-off between 'security' and speed/flexibility. <br><br></td></tr></table><br>
<a name="643995"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >N</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> As far as structure goes, mine looks like this:<br><img src="http://noelcower.com/crap/ipkStruct.jpg"><br><br>What you do is first read the first four bytes and see if it matches the magic number (which is 'IPAK', but checking a number is easier).  If it does, you proceed to read the first two numbers which are the offset into the file that the directories are stored at and the amount of directories in the pak respectively.<br><br>One you do that, you seek directly to the directory offset and read the directories until you get what you want (which is usually a specific file).<br><br>Directories are laid out as such:<br>- The number of characters in the directory name, which in BlitzMax would be this, basically:<br><pre class=code>
Local length:Int = pak.ReadInt( )
Local bytes:Byte[length]
pak.ReadBytes( bytes, length*2 )
Local name$ = String.FromShorts( bytes, length*2 )
</pre><br>- The offset into the pak from the start of the file the file's data is at<br>- The uncompressed size of the data<br>- The compressed size of the data<br><br>You then check and see if the compressed size is equal to the uncompressed size.  If it is, then the data is not compressed (the tool I wrote to make my pak files checks to see if the compressed version is larger than the uncompressed version just in case).<br><br>Then, simply put, you read the data at the given offset into a buffer as large as comSize.<br><br>If it is compressed, you create another buffer as large as outSize and decompress it using the outSize as the target size.<br><br>In BlitzMax, this would, basically, be:<br><pre class=code>Rem
previously defined:
    - comSize
    - outSize
    - offset
EndRem

Local dbuf@[comSize]
pak.Seek( offset )
pak.ReadBytes( dbuf, comSize )
If comSize &lt;&gt; outSize Then
    Local cbuf@[outSize]
    uncompress( cbuf, outSize, dbuf, comSize ) ' outSize typically will not be changed
    dbuf = cbuf
EndIf
' Do what you wanted to with the data (now in dbuf)</pre><br><br>Obviously, if you were to use a format like this, you could strip compression from your tool and simply use uncompressed data.  All a matter of whether or not you think it's worthwhile to have compression. <br><br></td></tr></table><br>
<a name="644037"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bukky</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks all for the suggestions! I'll try some things out tomorrow. <br><br></td></tr></table><br>
<a name="644151"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >popcade</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> You can try post-packing tool like MoleBox<br><a href="http://www.molebox.com/" target="_blank">http://www.molebox.com/</a><br><br>Anyway I use it for compacting data to avoid obsolete files, not for security,you can still have a llok at it, compatible with Blitz Family. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
