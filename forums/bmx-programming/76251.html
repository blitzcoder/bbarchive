<!DOCTYPE html><html lang="en" ><head ><title >Z in xyzuv[]</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Z in xyzuv[]</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Z in xyzuv[]</a><br><br>
<a name="852495"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Has anybody successfully changed the 'z' in a frame's xyzuv[] array?<br>The following code just makes the image disappear when I change (what I think is) the Z pos.<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
SuperStrict
Function tg_setz(image:TImage , z:Float,frame:Int=0)
	Local myframe:TD3D7ImageFrame=TD3D7ImageFrame(image.frame(frame) )
	myframe.xyzuv[2]=z
	myframe.xyzuv[8]=z
	myframe.xyzuv[14]=z
	myframe.xyzuv[20]=z
End Function
Graphics 800,600
Local red:TImage=LoadImage("red.png")
Local green:TImage=LoadImage("green.png")
Local z1:Float
While Not KeyHit(KEY_ESCAPE)
	If MouseHit(1)
		z1:+0.1
		tg_setz(red,z1)
	EndIf
	If MouseHit(2)
		z1:-0.1
		tg_setz(red,z1)
	EndIf
	Cls
	DrawImage RED,0,0
	DrawImage GREEN,100,100
	Flip
Wend
</textarea><br><br>p.s. I realise I can use different lists for different 'z' values to achieve the same result. <br><br></td></tr></table><br>
<a name="852502"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> You would need to have a perspective projection in the projection matrix in order for it to know how to convert your Z coordinates to screen coordinates, otherwise it will appear to be flat and who knows maybe if it's not set up you could be putting your object outside of the entire visible range. <br><br></td></tr></table><br>
<a name="852535"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> its especially useless as the gl side does not use it at all and you surely don't want to enforce dx7 when opengl is the worlds better chance on "real computers" <br><br></td></tr></table><br>
<a name="852544"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> @ImaginaryHuman, You could be right. I thought it might be the projection matrix as well (e.g. the depth value) but haven't got it to do anything different yet.<br><br>@Dreamora<br><div class="quote"> its especially useless as the gl side does not use it at all and you surely don't want to enforce dx7 when opengl is the worlds better chance on "real computers"  <br></div><br>What makes you think I have any interest in gl or "real computers" for this topic? <br><br></td></tr></table><br>
<a name="852546"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well I assumed you want this for a game, not for personally anti boringness, so others are going to see the result of it as well, right? :)<br><br>For dedicated cards from ATI and NVIDIA, OpenGL is the far better choice (50-100% more performance). For crossplattform its a must choice<br>As OpenGL uses TGLImageFrame you would need to modify both to have a z value in Max2D (and logically add the projection to both drivers)<br><br>thats the main reason I pointed that out.<br>and just to mention that: without further modifications it will not work anyway. the state system and the like of BM are especially targeted its current usage. <br><br></td></tr></table><br>
<a name="852549"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Well I assumed you want this for a game, not for personally anti boringness, so others are going to see the result of it as well, right? :)<br> <br></div> No, wrong. <br><div class="quote"> For dedicated cards from ATI and NVIDIA, OpenGL is the far better choice (50-100% more performance). For crossplattform its a must choice<br>As OpenGL uses TGLImageFrame you would need to modify both to have a z value in Max2D (and logically add the projection to both drivers)<br> <br></div><br>I have no interest in crossplatform in this situation which is why I am using DX.<br><div class="quote"> <br>and just to mention that: without further modifications it will not work anyway. the state system and the like of BM are especially targeted its current usage. <br> <br></div><br>Now that's why I posted. <br>a) If somebody else has done this, how did you do it?<br>b) If further modifications are required... what modifications?<br>c) How does <div class="quote"> the state system and the like of BM are especially targeted its current usage. <br> <br></div> affect the problem and what would need to be done about it. <br><br></td></tr></table><br>
<a name="852552"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well how does it affect it: z is not taken into account on the state settings. projection isn't existing in it. This means that you must ensuer that resets and the like take this information into account as well and reset it to your "start" state for example.<br>Because otherwise the projection is gone etc.<br><br>Don't know if the clip planes from the SetViewport will need work but potentially they do.<br>Different things are not setup in Max2D as it is not meant to have depth so you might struggle over issues that only exist due to the projection.<br><br>And no, so far nobody has done it. Reason is simple: Max2D is now even svn updateable.<br>If you want to have depth, I would suggest writting an own specific driver for it so you don't mess with the base and especially have the control over future changes. i don't know how well the max2d dx implementations are because with true depth potentially would better focus on batching / "single surface" usage for the different images as true depth will remove the need of drawing orders to define "in front" and "behind" <br><br></td></tr></table><br>
<a name="852557"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmmm, just seems odd that D3D7Max2D driver actually passes a Z=0 value. I was hoping it was taken into account but never used. <br><br><div class="quote">  And no, so far nobody has done it.  <br></div><br>I am prepared to believe that but still thought it worth checking. Where do you get your information from that  nobody has done this?<br><br><div class="quote"> Reason is simple: Max2D is now even svn updateable. <br></div><br>Don't understand how the two are related but nevermind.<br><div class="quote"> i don't know how well the max2d dx implementations are because with true depth potentially would better focus on batching / "single surface" usage for the different images as true depth will remove the need of drawing orders to define "in front" and "behind"   <br></div><br>Yes, that is right. <br><br>P.S. In case others are wondering: I am trying to do this just for the fun of it. If it *can* work and is not too clunky and is much quicker than sorting/layering/whatevering then it might be useful. <br><br></td></tr></table><br>
<a name="852560"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, most likely because otherwise someone would have shown its creation or would have reacted to one of the "weekly" "why have we no real depth" threads in the past 2 years I would assume :)<br><br>How they are related: Well if you modify the regular Max2D DX driver, the next update will vanish it.<br><br><br>Actually I don't think that true depth will be faster. More likely to be vice versa sadly. There have been different attempts of batched drivers by BRL themself and different users here (including me) created their own ones as well. The result was always that current hardware is capable of opting the "single quad" approach to work near as performant as batching so the overhead for handling the batching in code makes them even or even slower.<br>the fact that the real depth and projection means automatic "real scaling" updates (not to mix with the virtual scaling value you would have in your code) which add further calculations. no problem if only done once but for particles and the like with size updates this will quite surely degrade the performance.<br>What I mean with that btw: you must scale it up while moving it in the background so it will remain on the same size. <br><br></td></tr></table><br>
<a name="852566"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Well, most likely because otherwise someone would have shown its creation or would have reacted to one of the "weekly" "why have we no real depth" threads in the past 2 years I would assume :)<br> <br></div><br>Must have missed those both by visiting every day and intensive use of the search function.<br><br><br><div class="quote"> How they are related: Well if you modify the regular Max2D DX driver, the next update will vanish it.<br> <br></div> True but then I don't uise svn or change base modules.<br><br><div class="quote"> Actually I don't think that true depth will be faster.  <br></div> etc etc<br>Now that bit *is* interesting.  Thanks for that. <br><br></td></tr></table><br>
<a name="852568"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> OK, its not that often, thats why I wrote it within quotes. But any new user that has used similar technology (TGB, Flash and others) assumes that there is some kind of depth / layer systems and asks about depth.<br><br>There are 2 benefits of an own driver with true depth:<br>1. You can change the depth without changing the drawing order while it changes the visual order<br><br>2. You can use the batching to make static meshes for stuff that does not change -&gt; Tilemaps for example. That should speed it up seriously depending on the way you store it and when you update it etc<br>But thats not that simple and doing it within a slightly modified version of the driver would be the right way to go ... at best on DX9 which is more capable on that end. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
