<!DOCTYPE html><html lang="en" ><head ><title >Images and Pixmaps</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Images and Pixmaps</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Images and Pixmaps</a><br><br>
<a name="848815"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Russell</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> When should one be used over the other, and why (I know pixmaps are quite a bit slower)?<br><br>I'm not exactly sure why we even have both: What's the main difference between them?<br><br>Thanks!<br>Russell <br><br></td></tr></table><br>
<a name="848823"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Pixmaps are in system memory and can be manipulated directly, so they can't be drawn without boshing them across the AGP pipe to the videocard first. Hence the slowdown you referred to.<br><br>Images are in video memory, and cannot be manipulated directly. Drawing them has no additional cost because they're already in video memory where the card needs them to draw them.<br><br>It's horses for courses. If you want to manipulate images, you have to use pixmaps because they're the only option. If you don't, it would pointless to have an overhead you don't need. <br><br></td></tr></table><br>
<a name="848825"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Perturbatio</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> A TImage uses a pixmap internally. <br><br></td></tr></table><br>
<a name="848826"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Russell</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ah, I see. It's too bad that we can't get the address of the buffer in the video card and address it directly...or can we? Would this make an appreciable difference in speed compared to doing the manipulations in system memory and blitting to the video card (as things are now, if I understand correctly)?<br><br>Thanks<br>Russell <br><br></td></tr></table><br>
<a name="848828"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Ah, I see. It's too bad that we can't get the address of the buffer in the video card and address it directly...or can we?  <br></div><br>As far as I'm aware, this physically isn't possible. By which I mean that it absolutely cannot be done, not just that BlitzMax cannot do it. To the best of my knowledge anyway. <br><br></td></tr></table><br>
<a name="848835"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Russell</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm... I thought video cards were mapped to an actual memory range of the system... But now that I think about it, with GPUs, etc being their own processors, it makes sense for them to have their own local addressing system.<br><br>Having grown up on non-Windows systems, such as the Commodore 64 (which has directly addressable video memory), I guess I was confusing the two methods.<br><br>So how do you write new code that does super fast things with video, yet still manage to be general enough to work on 'all' video cards? Does OpenGL and DX somehow just access the GPU functions of the video card in a low level way, or what? Just curious...<br><br>Thanks for the info,<br>Russell<br><br>[Edit] An example of very fast video manipulation is MAME, which can manipulate entire screens of pixels at 30fps quite easily. Is this sort of speed unavailable outside of C/C++/Asm? <br><br></td></tr></table><br>
<a name="848839"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm kind of a bit miffed with Opengl not prividing a buffer address. I mean, it's supposed to be hardware agnostic and have no hardware-specific stuff in the API, but you would think that once you DID set up a hardware-independent-api-driver backbuffer it might at least provide you with some kind of buffer pointer. After all you'd think that OpenGL knows what it is - unless perhaps it isn't allowed to operate at a low-enough level to find out by the o/s? But then surely there is some o/s calls that might tell you.<br><br>As to the pixmap thing.. the OpenGL documentation refers to main-memory-images as `pixmaps`, I don't think it's a DirectX terminology so much (totally guessing here). Basically because you now have two areas of memory - main memory and video memory, and because pretty much everything on the GPU has to have direct access to the memory it uses for textures and such, it has to be video ram only. It usually cannot read or write main memory. So you have to have a way of saying that data is within video ram, ie like a texture, and an alternative way to talk about memory which is outside of the access of the GPU - ie main memory and thus pixmaps (or bitmaps).<br><br>This really all stems from having GPU's which need to access dedicated video ram, and probably in some cases you could just as easily have gained direct access to videoram, but I guess its the way they wanted to design the system.<br><br>A pixmap is in main memory and can be access by the CPU in your program code, so you can manipulate pixels etc. But pixmaps cannot be displayed by the video hardware. You have to transfer the pixmap image data into a texture within video ram, ie an `Image`, before texture mapping can take place to show you the image (or use DrawPixmap).<br><br>Reminds me of the Amiga days where you only had `chipram` which could be displayed by the video hardware plus also could be accessed by the CPU. Aren't Intel integrated cards like that? But anyway.<br><br>You actually can change textures/images in videoram directly but you need to use OpenGL extensions or more recent DX calls. <br><br></td></tr></table><br>
<a name="848846"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Russell</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh well, guess we'll just have to rely on what OGL and DX expose to us...<br><br>[Edit] Now I'm beginning to see the advantage to having 500MB video cards (other than allowing huge/numerous textures and 3D data): No swapping from/to system memory needed!<br><br>Russell <br><br></td></tr></table><br>
<a name="848853"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> It does help if you want big textures. Not so important for 2D though. <br><br></td></tr></table><br>
<a name="848870"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >remz</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Along with everything being said, Pixmap are quite fast when you need direct access to its memory buffer. There is way to draw a pixmap with OpenGL a bit faster than using DrawPixmap which does a YFlip internally thus allocating memory, copying lots of bytes, etc.<br><br>To sum it up: TImage vs TPixmap, it pretty much depends on what you intend to do. <br><br></td></tr></table><br>
<a name="849065"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yah, make your pixmaps be the correct way up and then do glDrawPixels(). Pretty silly converting the entire pixmap and flipping it on the fly. <br><br></td></tr></table><br>
<a name="849105"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >remz</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> You can say that.<br>Here's what I use if anyone's interested.<br>It assumes GL_RGBA but that can be made more flexible easily. Also of interest is that with glpixelzoom(sizex, -sizey) you can draw your pixmap scaled by OpenGL. 1 million times faster than calling ResizePixmap.<br><br><pre class=code>
Function FastGLDrawPixmap(p:TPixmap, x:Int, y:Int)
	SetBlend(SOLIDBLEND)
	glDisable(GL_TEXTURE_2D)
	glpixelzoom(1, -1)
	glRasterPos2i(0, 0)
	glBitmap(0, 0, 0, 0, x, -y, Null)
	glPixelStorei(GL_UNPACK_ROW_LENGTH, p.pitch Shr 2)
	glDrawPixels(p.width, p.height, GL_RGBA, GL_UNSIGNED_BYTE, p.pixels)
	SetBlend(ALPHABLEND)
End Function
</pre> <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
