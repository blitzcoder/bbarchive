<!DOCTYPE html><html lang="en" ><head ><title >Unhandled Exception: Unhandled Memory Exception Er</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Unhandled Exception: Unhandled Memory Exception Er</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Unhandled Exception: Unhandled Memory Exception Er</a><br><br>
<a name="551445"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tom Darby</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hello folks,<br><br>I know that this topic has been covered somewhat in the past (http://blitzmax.com/Community/posts.php?topic=48556), but I wanted to chime in with my own experience on the matter.<br><br>I'm having trouble using FlushMem().  Whenever I try to use it in my main loop, it succeeds -once- and then crashes with "Unhandled Exception: Unhandled Memory Exception Error" (in windows) or an "app unexpectedly quit" (in OS X) error.  Whenever I try to call it "between levels" (that is, I restrict its use to once every minute or so) it works properly for a few times, then my variables start to become corrupted.  (This 'decay' seems to be affected both by number of times I call FlushMem and the total runtime of the app; if I let a single level run for a few minutes, it begins to corrupt my variables without having called FlushMem a second time.)  I do not call FlushMem() from within any functions or methods; I only use it at the root level of my application.<br><br>I'd post code, but my app is currently a jungle of ~5500 lines spread across 20 or so files, and I haven't been able to pin down any real culprit for this behavior.  I've eliminated array-slicing by using the workaround in the above thread, but the problems persist.  <br><br>To give you an idea of how this is working, I have a bare handful of global variables and functions and a single instance of a "universe" user-defined object, which contains all my levels, player data, game objects, graphics initialization routines, loading routines, parsing routines, drawing routines--pretty much everything I do happens within the "universe" object.  I have a number of user-defined types, and I cross-link them fairly heavily.  There are a few cyclic links, but I've taken pains to ensure that these cyclic links are de-referencing before deletion; in any case, failure to do so should result in a memory leak (as opposed to an outright crash.)<br><br>Any ideas as to what may be going on here?  Again, I apologise for not being able to produce example code; as soon as I've narrowed down some kind of culprit, I'll post more...<br><br>Tom <br><br></td></tr></table><br>
<a name="551448"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Are you using strict? (should be done in any case as variable scope work different if not)<br><br>Perhaps you flushmem away local variables that your functions and methods still base on and where they run in null references. Especially as you say that you are manually killing references as well ...<br>With debug enabled, the line where the error appears should be more or less be shown (+- 1 line) and you should be able to pin the error down or at least find a hint where to start your error search. <br><br></td></tr></table><br>
<a name="551456"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Robert</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Tom,<br><br>I don't think that cyclic links are the cause of the problem, but a strongly suggest that you try and remove them.<br><br>These kind of bugs can be very difficult to pinpoint, the only option is usually to disable as much as possible, that re-enable the various parts of the game until the problem shows up again. <br><br></td></tr></table><br>
<a name="551467"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzSupport</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> With debug mode on, is it crashing on the FlushMem line, or highlighting other lines? <br><br></td></tr></table><br>
<a name="555442"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >regaa</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry for digging out this post, however i have the same problem. This do not happen with every app, just with a special one. The app runs fine, but after including this one type the whole app crashes. I don't know if it is wise to post 500 lines of code, from the code i believe the bug must be there. No error during creation of the single objects, no error during update, draw, create functions, just the first call of flushmem in the mainloop leads the programm to an UMEE. The problem occurs first after the 1.10 update.<br><br>I am sure this isn't a thing of nullobject reference. I really don't know how to solv this one. The DebugLog, right after error, is this one:<br><br>- Function Delete<br>  - Local Self:TDX7ImageFrame=$02E65B20<br>     Type TDX7ImageFrame<br>     Field driver:TD3D7Max2DDriver=$003D3D88<br>     Field surface?IDirectDrawSurface7=@$32dc800<br>     Field sinfo:DDSurfaceDesc2=$02E65BB0<br>     Field xyzuv#[]=[...]<br>     Field width=11<br>     Field height=10<br>     Field flags=9<br>     Field seq=2<br><br>Maybe you'll discover some bugs from this DebugLog. I hope so.<br><br>After error the online line which is highlighted is the flushmem() line. <br><br></td></tr></table><br>
<a name="555450"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> regaa / Tom, feel free to email me your programs so I can reproduce the problem here. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
