<!DOCTYPE html><html lang="en" ><head ><title >Monitor Refresh Rate Question</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Monitor Refresh Rate Question</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Monitor Refresh Rate Question</a><br><br>
<a name="928577"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mulawa1</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm struggling to find a way to successfully have a Fullscreen display across a variety of laptops and desktop crts (all Windows at the moment - not ready to go Mac yet!) without screen flicker or tearing. I've read and re-read all the posts here and have learnt a lot!<br><br>But ...<br><br>The main thing I've learnt is that BlitzMax cannot tell you the monitor refresh rate so if you want to match the current desktop setting you'll have to calculate it yourself.<br><br>So my question is ... why does this code not work? I find it returns a wide variety of values although most are near the refresh rate.<br><br>&lt;update&gt;I've just tried this on an old laptop set to 60Hz but my program reports 30!&lt;/update&gt;<br><br><pre class=code>
Strict
Graphics 800,600
Repeat
Cls
DrawText refresh_rate(),10,10
Flip
Delay 1000
Until KeyHit(KEY_ESCAPE)
End

Function refresh_rate()
	Local ms,fps
	Flip(1)
	ms=MilliSecs()
	Flip(1)
	fps=1000/(MilliSecs()-ms)
	Return fps
End Function
</pre><br><br>Peter <br><br></td></tr></table><br>
<a name="928624"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yan</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> <pre class=code>Strict

?Win32
	Import Pub.Win32
	
	Extern "Win32"
		Function ReleaseDC(hWnd, hdc)
	End Extern
	
	Local hWnd = GetDesktopWindow()
	Local hdc = GetDC(hWnd)
	If hdc = Null Then End
	
	Print
	Print "Desktop Refresh Rate = " + GetDeviceCaps(hdc, VREFRESH)
	
	ReleaseDC(hWnd, hdc)
?

End</pre> <br><br></td></tr></table><br>
<a name="928631"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Using millisecs will never give you the true refresh rate for many many reasons.  But if you want a few, here they are:<br><br>A) Your system is multitasking so you can never be sure the same line of code will execute in the same amount of time.<br><br>B) The refresh rate rarely will divide evenly into 1000 milliseconds.  For example, at 60hz, the number of milliseconds per frame is 16.6666~.<br><br>C) Just because the screen refresh rate is 60hz doesn't mean it draws exactly 60 times a second every time.  Your monitor isn't run by an atomic clock. :-)<br><br>In short, there's a lot of little time differences and timer accuracy issues which mean you'll never be able to read the HZ using the millisecond timer.<br><br>Though if you averaged it over a long enough period, I suppose you could get close.  But you'll probably still end up with like 59.9999hz or something. <br><br></td></tr></table><br>
<a name="928729"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Tearing is caused by VSync, you can change this by using Flip 1 or Flip 0. Although the refresh rate is involved in whether the screen will tear or not, tearing can happen on any refresh rate, whether it is 60hz or 85hz.<br><br>Full screen programs will usually use whatever the desktop refresh rate last was for that mode. For example, if your program is 800x600 32-bit colour, set Windows desktop to that exact resolution. Now change the refresh rate to a desired level, and change the desktop back to your normal resolution. I THINK all fullscreen programs (that don't set the rate themselves) will use that refresh rate from now on for that exact mode.<br><br>A more complicated or perhaps better solution is to simply ask your user what he wants. Use the command to find you the list of supported resolutions and refresh rates, and ask the user to pick. Then if he wants to use 75hz he can, 60hz he can etc. <br><br></td></tr></table><br>
<a name="928742"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Otus</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you use GraphicsModes, you should get a mode with a good refresh rate. <br><br></td></tr></table><br>
<a name="928782"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mulawa1</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thank you all for taking the time to reply.<br><br>Yan, that code certainly delivered the answer - thank you!<br><br>sswift, I appreciate all the points you raise but that hardly explains the old laptop that consistently said "30" for "60" !<br><br>Sure I can use GraphicsModes - I came up with the idea of using the highest refresh rate for the resolution I wanted but the catch is it is the adapter reporting here and on one laptop the monitor wasn't up to the refresh rate and tearing resulted.<br><br>On the other hand if I use the default 60 as many have suggested elsewhere I get flickering on the crt that normally uses 75.<br><br>Allowing the user to choose is neat but my work is being used for disabled folk and for folk in care facilities.<br><br>Once again ... many thanks ... I'll try Yan's approach and worry about the Mac when I start working in that environment.<br><br>I'll add to this thread if I encounter any further issues.<br><br>Peter <br><br></td></tr></table><br>
<a name="928835"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> There is a small module by dbug `desktopext` which provides cross-platform access to the desktop's dimensions, client area, bit depth, hz rate, etc. <br><br></td></tr></table><br>
<a name="928895"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Your plan assumes that the desktop refresh rate of the computers is already set up to an appriopriate level. Who ensures that?<br><br>I'm assuming someone that at least knows what he is doing will install your program on the computers. The setup program should ask what default rate to use and store it in a file.<br><br>As for tearing, did you try flip 1 and flip 0? I can't remember which is which but I think one forces VSync which reduces tearing. <br><br></td></tr></table><br>
<a name="928901"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Taron</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ah, how bizarre, I just ran into that for the first time myself. My previous compiles somehow never showed that kind of trouble.<br><br>It appears as though there's some sort of backbuffer trouble. It's very strange, since openGL and directX act as if they have specific modes that crisscross allow or deny backbuffers. (at least by the looks of it?!). More fascinating to me is the idea that I wasn't running into that earlier! I'm compiling with the SVN, if that could make any difference, but it might be that I wasn't using full res earlier?!? <br><br>However, I can claim that I've tried a lot of things and still can't come to a conclusion. Flip 0 ignornes the vblank, but ignoring it or not, that's not the problem as far as I can tell. Some laptops don't like flip 1 with openGL either, still ignoring the vblank.<br><br>Anyway... I wasn't helping, I know!  :oP <br><br></td></tr></table><br>
<a name="928905"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mulawa1</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> IH - thanks for the cross platform heads up - will check that out<br><br>CF - my "plan" is a suite of programs - I want each to be standalone and capable of setting the res itself - I know I could use ini files but in the environment in which I'm working that's not the best approach.<br><br>If the desktop hertz is wrong already then all programs will be flickering and either this doesn't bother the user or someone will fix it!<br><br>I spent a lot of time experimenting with the flip flag - I felt it was being ignored on at least one old machine.<br><br>I'm very happy with Yan's code and have implemented it with complete success so I'm one happy camper at the moment.<br><br>Peter<br><br>P.S. Taron - sorry to hear that you're moving into the area I was in only yesterday! <br><br></td></tr></table><br>
<a name="929041"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MGE</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Bottom line after lengthy research, etc, etc, yada, yada, yada..<br><br>Use Flip(1) all the time, and get used to it. This forces vsync which every game should do. Regardless if your game runs at 15fps or 75fps. The only reason to use Flip(0) is to test how fast your main loop is capable of. <br><br>Other Flip() parameters seem to be there to provide support for jurassic coders who want to code their game at 60fps on any monitor hz, and not have to use delta, tweening, etc. Avoid this line of thinking. <br><br>&gt;&gt; If your game runs faster then monitor refresh with Flip(1) then your GPU driver settings are set to ignore vsync. <br><br>&gt;&gt; If your GPU settings ARE set to vsync, and you use Flip(1) and still get tearing or high frame rates, then reinstall your drivers, something is broke. I've had peeps from day 1, play games with tearing and think it's "normal" then when they see the same games on their system with proper drivers installed and VSYNC is working, it's like night and day. ;)<br><br>Graphics(width,height,mode,hz)<br><br>&gt;&gt; Default for "hz" is 60, so if you ignore this parameter, in full screen mode BlitzMax will attempt to setup a 60hz refresh rate. <br><br>&gt;&gt; If you pass a parameter that is not supported by the driver, the driver will setup a default hz. <br><br>I would recommend passing 0 and letting the internals of the system setup a hz for you. Then in your game, use fixed logic, tweening, delta timing, etc, for your logic/render needs. ;) <br><br></td></tr></table><br>
<a name="929043"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> I pretty much agree with MGE. A lot of people are using Flip -1 thinking that it will provide tear-free flipping, but it doesn't, especially I notieced it on my Mac, I had to change various examples to Flip 1 in order to properly sync with the vertical blank. I would recommend using Flip 1 all the time unless you want maximum/variable framerate in which case use Flip 0. You should be using some kind of dynamic logic timing (fixed rate, delta etc) regardless because the hardware may not be able to keep up with the amount of work you're asking it to do. On a lower end/mid-range machine, if there is too much work to do the framerate will drop even if it's vsync'd and then you have to deal with logic slowing down. <br><br></td></tr></table><br>
<a name="929182"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Taron</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> With my games I'm using Flip 1 for a while now, which is fantastic, particularely under directX, which shows some consistency across most gfxboards. <br>However, with my funny happy trees it has the wild problem that I would have to somehow alter the routines to execute the growing outside of the vsync loop, because they benefit greatly from faster machines, while the vsync would slow it down. No drama, naturally. <br><br>However, I can't yet confirm that the flip choice is responsible for the flickering, since even flip 1 flickers in the case of fullscreen on the laptop! <br><br>I had something extremely esotheric happening when I managed to have no flickers on the laptop, where it appeared like it was drawing empty colored boxes on the screen as opposed to the chosen images. I can't even begin to tell what might cause that?! Particularely because a windowed version nor the flickering fullscreen wouldn't show that. <br><br></td></tr></table><br>
<a name="929208"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's possible that your driver/gfx card simply does not `report` the vertical blank properly/at all. Not all hardware supports that. <br><br></td></tr></table><br>
<a name="929216"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> I agree with MGE, I mean I practically set the standard (after a ton of research couple of years back) ;-p  They key is Flip 1 AND some decent game timing so if Vysnc is forced off in the GPU drivers, your game still runs at a normal speed. <br><br></td></tr></table><br>
<a name="929245"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yan</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah, that 'extensive research' must have really taken it out of you...<br><br><a href="/posts.php?topic=57862#643780" target="_blank"><b><u>http://www.blitzbasic.com/Community/posts.php?topic=57862#643780</u></b></a><br><br><br>;op <br><br></td></tr></table><br>
<a name="929246"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yan</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> oops <br><br></td></tr></table><br>
<a name="929354"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> haha, I did spend a long time reading up about it and running tests and posting test apps online, and then refining my timing method for MBax etc, so it sure feels like a ton of research to me :-) <br><br></td></tr></table><br>
<a name="929472"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MGE</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yo.. if you research anything with "frame rate" , "hz" , "fixed logic" , etc, etc, chance are GA's going to show up. So yah...I would say he's put in the hours. :) <br><br></td></tr></table><br>
<a name="929486"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Taron</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> @ ImaginaryHuman <br>Yep, but only for openGL, funny enough. DirectX reports proper Vblank normally. <br><br>@ the rest<br>I would testify to the flip 1 solution, particularely with using directX. It's very reliable and produces beautifully smooth performance. As far as I can tell, I didn't even have to bother with anything else, especially no delta timing mess. I might have been lucky with my last game, but it feels fine on either machine (8core and laptop). Only the above mentioned remains a problem (openGL troubles on mobiles). <br><br></td></tr></table><br>
<a name="929489"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> Actually I was just making a silly comment for fun so don't wanna make a big deal of it :) <br><br></td></tr></table><br>
<a name="929746"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Taron</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> I had to look for your comment to get what you're saying there, hehe, but I actually mean it in regards to flip 1 and successfully being lazy. I have no idea what happens when a system has vsync turned off, but it led to my first successful smooth running game. (running maxgui)<br><br>I'd still like to know, if anyone had ever run into the wacky phenomenon, where either pixmaps don't seem to be generated, or images somehow can't get their content on the screen. (I should best show it, I know...)<br><br>And, naturally, the backbuffer/flicker weirdness in fullscreen modes. Does anyone know what this is or could be? (especially under directX (7))<br><br>ONE more thing... drawpixmap and grabimage... I found that with openGL and fullscreen a drawn pixmap may not be grabbed as image, but had to be drawn as image( loadimage...drawimage), while the circumstances are horribly ambiguous. If I started off drawing a pixmap to then go into the loop and grab image, it wouldn't get it, while during the loops, miraculously it will. Anything funky with memory dealings? There may well be stuff I havn't understood yet in regards to where an image ends up in memory and where it gets taken from again or how it ends up on the gfx memory and where grabimage actually takes it from?<br><br>Questions over questions... <br><br></td></tr></table><br>
<a name="929821"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MGE</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> I remember someone posting problems with grabimage in OGL. A search of the forum might help. Also "As far as I can tell, I didn't even have to bother with anything else, especially no delta timing mess. " well...that works ok when your game is running on capable hardware, but if running on lower end spec, or when your pc system has quirks, your game would run very choppy, have slow downs, etc, etc. And then if the system has vsync off, well your frame rate would be all over the place. ;) I've been running some recent ideas on a brand new Vaio pc with a nice Nvidia card, window games are choppy as hell, even my low end intel runs games better in window mode. <br><br></td></tr></table><br>
<a name="929837"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Taron: Maybe you are simply failing to Cls and Flip each frame?  Or yeah GrabPixmap doesn't work in OpenGL the same as for DirectX, I posted that on the bug forum a few months back but it has not been fixed.  Guess it's low priority... <br><br></td></tr></table><br>
<a name="929849"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br><br>I'd still like to know, if anyone had ever run into the wacky phenomenon, where either pixmaps don't seem to be generated, or images somehow can't get their content on the screen. (I should best show it, I know...)<br> <br></div><br>checked variables against NULL ? Or did you mean "draws nothing" - the "can't get their content on the screen" is a bit hm undefined.<br><br><br><div class="quote"> <br>And, naturally, the backbuffer/flicker weirdness in fullscreen modes.<br> <br></div><br>Thought there is no real backbuffer-system in Bmax, only the one and only surface you are working with. So what do you mean with "flicker" - tearing? black-screens?...<br><br><div class="quote"> <br>Questions over questions... <br> <br></div><br>questions upon questions...<br>no word by word translation from German to English please ;D<br><br><br>bye MB <br><br></td></tr></table><br>
<a name="929998"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Taron</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> It draws the box of the image in the chosen color with the chosen alpha, but non of the pixel values it should contain.<br><br>Yes there is a backbuffer system in Bmax, in fact that's the most commonly used ( flip, flipping the buffers. You always draw on the backbuffer and then flip it to the front! How far that's not a "real" backbuffer system I can't tell!)<br><br>Thanks for your lecture on the english language. Even after 10 years in L.A. I screw up some phrazes here and there. Try telling someone not to paint the devil on the wall!  ;) <br><br></td></tr></table><br>
<a name="930025"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you are finding that grabpixmap doesn't work in OpenGL, try calling glReadPixels yourself to download a rectangular area of pixels and store it in a pre-created pixmap. <br><br></td></tr></table><br>
<a name="930045"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MGE</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> "Yes there is a backbuffer system in Bmax, in fact that's the most commonly used ( flip, flipping the buffers. You always draw on the backbuffer and then flip it to the front! How far that's not a "real" backbuffer system I can't tell!)"<br><br>Correct. :) <br><br></td></tr></table><br>
<a name="930049"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> But not like in the old days with double buffering or even triple buffering. you only can draw on one buffer at one time (ok, RTT is something very similar but its not included in a normal BMax-installation).<br><br>short: there is no SetBuffer (or SetTarget).<br><br><br><br>Garbage-Grabbing: Try using the method ImaginaryHuman suggests or give GrabImage a chance and grab your pixmap from there (this way it works for me even in OGL).<br><br><br><br>bye MB <br><br></td></tr></table><br>
<a name="930051"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yan</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Actually I was just making a silly comment for fun... <br></div>As was I. :o)<br><br>Still, looking on the bright side. It seems you've pulled. ;o)<br><br><br><div class="quote"> Yo.. if you research anything with "frame rate" , "hz" , "fixed logic" , etc, etc, chance are GA's going to show up. <br></div>Yeah, I know. I was there. ;o)<br><br>I think GA is well used to my light hearted, if oft-sarcastic, leg pulling by now. :o) <br><br></td></tr></table><br>
<a name="930260"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Taron</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#31">[#31]</a></td></tr></table></td></tr><tr ><td class="posttext"> Um, I'm using grabimage and then past the img.pixmap[0] into my pixmap! I noticed that grabpixmap didn't work very early on. Guess I forgot to mention that.<br><br>However, it's not the grabimage that really appears to fail. It's literally the drawimage of the images that goes wrong somehow...<br><br>I also did run into a few weird things with the image.pixmap[0] option. It also seems that creating an image doesn't allocate a pixmap until something is loaded into it, is that correct? <br><br></td></tr></table><br>
<a name="930270"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#32">[#32]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I think GA is well used to my light hearted, if oft-sarcastic, leg pulling by now. :o)  <br></div> so much so my leg is a little loose.<br><br><div class="quote"> paint the devil on the wall <br></div>Heard that in a Megadeth song... <br><br></td></tr></table><br>
<a name="930417"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Defoc8</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#33">[#33]</a></td></tr></table></td></tr><tr ><td class="posttext"> As far as i know flip(1) is simply a request to vsync - driver options<br>can override this + if you dont specify a hz value for<br>refresh you get a default/safe value?... If a user has disabled vsync in<br>there driver options..you may have trouble detecting this - i dont think<br>there are any bmax system commands to test for this?... <br><br></td></tr></table><br>
<a name="930446"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#34">[#34]</a></td></tr></table></td></tr><tr ><td class="posttext"> Taron - did you lockImage your Timage before working on it or its childelements (pixmaps)?<br><br>Maybe that helps.<br><br><br>bye MB <br><br></td></tr></table><br>
<a name="930584"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Taron</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#35">[#35]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmmm, nope, I didn't lock them, but I also don't have any troubles on my machine with them. Could it be that this effects only certain setups?<br><br>I've started to use Loadimage rather than lock and paste in order to get my pixmaps into the timages. Seems to work fine on my machine, but then I don't know if that could act differently on others?! (sorry for repeating myself there.)<br><br>I'll have a check for sure! Thanks! <br><br></td></tr></table><br>
<a name="943777"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tachyon</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#36">[#36]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry for digging up an old thread...<br><br>MGE said:<br><div class="quote"> Use Flip(1) all the time, and get used to it. <br></div><br>When I used Flip(1) one of my CPUs runs at nearly 100% under Vista.<br><br>If I use Flip(-1), its at a much more respectable 4-6%.<br><br>I don't notice a difference between the two otherwise. Should I still use Flip(1)? <br><br></td></tr></table><br>
<a name="943888"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#37">[#37]</a></td></tr></table></td></tr><tr ><td class="posttext"> Flip 1 has to sit in a loop waiting for a vertical blank event to occur, using CPU time. You might be better off using flip 1 in combination with a delay - ie at the start of your frame loop take note of the millisecs(), then when you are done rendering and are about to flip, check how many milliseconds have passed. If there is a significant enough amount of milliseconds left before the frame is likely to flip (16.6ms are available for a 60fps framerate) then do a Delay to let the o/s use up the remaining time - give yourself some room to make sure the flip gets fired ahead of time, but not too early, then do your flip. Cus it sounds to me that if your Flip -1 loop is only using 5% cpu time then you aren't doing a whole lot of processing in your loop and could be giving all that time back to the o/s. <br><br></td></tr></table><br>
<a name="943898"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzSupport</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#38">[#38]</a></td></tr></table></td></tr><tr ><td class="posttext"> I didn't see this thread until it got bumped, but thought I'd rain on the parade a little bit regarding <i>GetDeviceCaps</i> -- from the MSDN docs:<br><br><pre class=code>
VREFRESH - Windows NT only
</pre><br><br>I never found a way to get the refresh rate 'officially' from Windows 9x last time I tried.<br><br>Just depends whether you care about your app working on 98 or not, though... Max doesn't officially support anything older. <br><br></td></tr></table><br>
<a name="944719"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mulawa1</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#39">[#39]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for that James - may explain why my new stuff failed on a Win98 box recently :(<br><br>Peter <br><br></td></tr></table><br>
<a name="986148"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mulawa1</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#40">[#40]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> There is a small module by dbug `desktopext` which provides cross-platform access to the desktop's dimensions, client area, bit depth, hz rate, etc.  <br></div><br><br>Well I've bitten the bullet and finally bought an eMac!<br><br>So now I desperately need a way to retain the refresh rate on a Mac.<br><br>@IH Can you tell me how to follow up on your suggestion?<br><br>@everyone ... or is there now a standard solution to this problem?<br><br>Peter <br><br></td></tr></table><br>
<a name="986149"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mulawa1</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#41">[#41]</a></td></tr></table></td></tr><tr ><td class="posttext"> Found it myself - now to try using a 3rd party module for the first time.<br><br><a href="http://www.chaos-interactive.de/en/desktopextension/" target="_blank">http://www.chaos-interactive.de/en/desktopextension/</a><br><br>Peter <br><br></td></tr></table><br>
<a name="986153"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mulawa1</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#42">[#42]</a></td></tr></table></td></tr><tr ><td class="posttext"> Need some help! I downloaded the above zip file which contains<br><br>desktopext.bmx<br>macscreen.c<br><br>I can see how it works - it even uses the "Import pub.win32" approach for Windows which I am already using.<br><br>BUT I can't see how to make use of what I've downloaded to enable me to find the refresh rate in OS X.<br><br>Peter <br><br></td></tr></table><br>
<a name="986158"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >d-bug</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#43">[#43]</a></td></tr></table></td></tr><tr ><td class="posttext"> You have to copy the complete folder structure to your BlitzMaxPath/mod folder. Then rebuild modules wich means you must have installed XCode on MacOS machines and MinGW on Windows machines first. I recommend to rebuild documentation too, to get the docs for desktopext. If all is going well, add the following code at the beginning of your main-code file:<br><pre class=code>Import chaos.desktopext</pre><br>After that you should be able to access the refresh rate of your desktop with the function DesktopHertz () <br><br></td></tr></table><br>
<a name="986164"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mulawa1</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#44">[#44]</a></td></tr></table></td></tr><tr ><td class="posttext"> So easy when you know how!<br><br>Worked perfectly on my eMac.<br><br>I was surprised when it came up with 89 Hertz but when I checked that is indeed what it is set to.<br><br>Many thanks! You have saved the eyesight of at least one of my Mac players!<br><br>Keep up the good work!<br><br>Peter <br><br></td></tr></table><br>
<a name="986170"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mulawa1</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#45">[#45]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmmm ... I'm beginning to think it's all too hard!<br><br>Here's what I'm trying to do - my game starts in 800x600 but a user can switch to 1024x768 on the fly - both fullscreen.<br><br>Main problem is to get a suitable refresh rate so there is no flicker.<br><br>My idea of getting the user's refresh rate and sticking to it works fine on all the boxes I've tried it on. But with my eMac the refresh rate seems tied to the resolution. eg my usual setting is 1024,768,32,89 but if I then try 800,600,32,89 it's not acceptable - it wants 800,600,32,112<br><br>So back to the drawing board and I try checking what combinations are available and choose the greatest refresh rate. Works fine on the eMac but then falls over on one of my Windows boxes because the adapter offers 800,600,32,120 but the old monitor can't handle 120hz!<br><br>I know there have been many other posts on this issue so I'm looking for the best compromise. My problem is that I only have a small set of test boxes.<br><br>I should also mention that most of my players are not very computer literate.<br><br>Peter <br><br></td></tr></table><br>
<a name="986171"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mulawa1</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#46">[#46]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm tempted to:<br><br>* Use the "keep the user's refresh rate" approach on Windows boxes.<br><br>* Use the "max acceptable refresh rate" approach on Mac boxes.<br><br>Any comments on this idea?<br><br>Peter <br><br></td></tr></table><br>
<a name="986172"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_JIM</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#47">[#47]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sounds like a good idea. You choose what's best for each platform. <br><br></td></tr></table><br>
<a name="986192"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#48">[#48]</a></td></tr></table></td></tr><tr ><td class="posttext"> Each screen `mode` has its own set of supported resolutions. It's based on what the hardware can display/output. So if your graphics card/monitor cannot handle a 1024 x 768 mode at 89Hz it simple won't allow you to open a screen with those settings. It'll use something `close`, like the 112.<br><br>Using Flip 1 the refresh will always be smooth, but it'll also always be synchronized to the display refresh, ie 89 or 112. <br><br></td></tr></table><br>
<a name="986196"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#49">[#49]</a></td></tr></table></td></tr><tr ><td class="posttext"> Why don't you select the greatest refresh rate below a certain threshold? The human eye can't really distinguish changes of refresh rate after about 80Hz, so there is little point in using 120Hz, just because it's available.<br><br>The monitor should tell the card what refresh rates it supports, so it's a bit worrying it selects one too high, though if it's an old monitor I guess it might not plug-and-play well.<br><br>I think you should just buy an LCD ;) <br><br></td></tr></table><br>
<a name="986254"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mulawa1</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#50">[#50]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the thoughts.<br><br>@IH: I'm religiously using flip(1)<br><br>@Czar: Are you suggesting I buy an LCD for each of my many players? :o)<br><br>I was toying with the threshold idea - catch is that on my eMac it seems to insist on 112 if I choose 800x600.<br><br>Another idea I'm playing with is if all else fails used windowed mode - here of course there are no refresh rate issues. My idea is that if confronted by a blank screen or a poor display the user can press the W key. I will then offer this permanently on the Options screen so they don't have to do this each time.<br><br>Peter <br><br></td></tr></table><br>
<a name="986256"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#51">[#51]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's a double-edged sword: if you have a monitor or LCD that doesn't play nice, then the computer may list screenmodes that don't really work.<br><br>Old LCD's may not support anything over 60Hz (and most new ones still won't do anything over 75Hz), while a CRT can drive you absolutely nuts at 60Hz.<br><br>the desktop resolution and refreshrate is pretty much the only combination that's <i>guaranteed</i> to work, with the exception that there may not be enough video memory on a low-end machine if the desktop runs at a high resolution/bitrate. :-?<br><br>No matter what you pick, there's always a chance of failure... <br><br></td></tr></table><br>
<a name="986266"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mulawa1</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#52">[#52]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok ... here's my consolidation of all I've learnt.<br><br>This test program opens in 800x600 fullscreen if it can.<br>It displays what Blitz thinks are the settings with black text on a white screen.<br><br>"F" will toggle between 800x600 and 1024x768<br>"W" will toggle Windowed mode ON/OFF<br><br>Here are the exe's - maybe you could try it for me on your boxes?<br><br>Windows<br><a href="http://mulawa.net/special/wip/monitor_test.exe" target="_blank">http://mulawa.net/special/wip/monitor_test.exe</a><br>Mac OS X<br><a href="http://mulawa.net/special/wip/monitor_test.dmg" target="_blank">http://mulawa.net/special/wip/monitor_test.dmg</a><br><br><pre class=code>
Strict
?Win32
	Import Pub.Win32
	Extern "Win32"
		Function ReleaseDC(hWnd, hdc)
	End Extern
	Global grefresh_rate=0
	Local hWnd = GetDesktopWindow()
	Local hdc = GetDC(hWnd)
	If hdc &lt;&gt; Null Then grefresh_rate=GetDeviceCaps(hdc, VREFRESH)
	ReleaseDC(hWnd, hdc)
?

Global gwindow=False
If graphics_set(800,600)=False Then Notify("Unable to set graphics mode 800x600");End
Global gbig_screen=False

Repeat
	display()
	Flip(1)
	WaitEvent()
	Local ed=EventData()
	Select EventID()
		Case EVENT_APPTERMINATE;End '****
		Case EVENT_KEYDOWN
			Select ed
				Case KEY_ESCAPE;End
				Case KEY_F;gbig_screen=Not gbig_screen;screen_set()
				Case KEY_W;gwindow=Not gwindow;screen_set()
			End Select
	End Select
Forever
End 

?MacOS
' use the maximum acceptable refresh rate
Function graphics_set(w,h)
	Local mode:TGraphicsMode,fmax=0,d
	If gwindow
		Graphics(w,h);Return True'****
	Else
		d=32 ' try depth 32 first
		For mode:TGraphicsMode=EachIn GraphicsModes()
			If mode.width=w And mode.height=h And mode.depth=d
				If mode.hertz&gt;fmax Then fmax=mode.hertz
			End If
		Next
		If fmax=0
			' no luck so try depth 16
			d=16
			For mode:TGraphicsMode=EachIn GraphicsModes()
				If mode.width=w And mode.height=h And mode.depth=d
					If mode.hertz&gt;fmax Then fmax=mode.hertz
				End If
			Next
		End If
		If fmax=0
			Return False'****
		Else
			Graphics(w,h,d,fmax);Return True'****
		End If
	End If
End Function
?Win32
' use the same refresh rate as the desktop if available
Function graphics_set(w,h)
	Local d,f,mode:TGraphicsMode
	If gwindow
		Graphics(w,h);Return True'****
	Else
		If grefresh_rate ' current refresh rate retrieved at start of program
			For mode:TGraphicsMode=EachIn GraphicsModes()
				d=mode.depth;f=mode.hertz
				If mode.width=w And mode.height=h And d=32 And f=grefresh_rate ' try 32 first
					Graphics w,h,d,f; Return True '****
				End If
			Next
			For mode:TGraphicsMode=EachIn GraphicsModes()
				d=mode.depth;f=mode.hertz
				If mode.width=w And mode.height=h  And d=16 And f=grefresh_rate ' now try 16
					Graphics w,h,d,f; Return True '****
				End If
			Next
		Else ' default to depth 16 and 60 Hz
			For mode:TGraphicsMode=EachIn GraphicsModes()
				d=mode.depth
				If mode.width=w And mode.height=h  And d=16
					Graphics w,h,d; Return True '****
				End If
			Next
		End If	
		Return False '****
	End If
End Function
?
	
Function display()
	Local s$
	SetClsColor 255,255,255;Cls;SetColor 0,0,0
	s$="width:"+GraphicsWidth()+" height:"+GraphicsHeight()
	s$=s$+" depth:"+GraphicsDepth()+" freq:"+GraphicsHertz()
	DrawText s$,10,10
End Function

Function screen_set()
	If gbig_screen
		graphics_set(1024,768)
	Else
		graphics_set(800,600)
	End If
End Function
</pre> <br><br></td></tr></table><br>
<a name="986275"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#53">[#53]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> OK ... here's my consolidation of all I've learnt. <br></div><br><br>One other thing to take into consideration: there won't be many (yet), but you're bound to run into *some* computers that won't support either one of these resolutions... you may want to look at the list of available video modes as returned by blitz, and initiate a screen in the next size up as a fallback. (e.g. 1366x768) <br><br></td></tr></table><br>
<a name="986283"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mulawa1</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#54">[#54]</a></td></tr></table></td></tr><tr ><td class="posttext"> Quite true Marc - I've already encountered that and it sometimes ends up with distortion.<br><br>For the moment I think the Windowed mode is the best fallback.<br><br>Peter <br><br></td></tr></table><br>
<a name="986294"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#55">[#55]</a></td></tr></table></td></tr><tr ><td class="posttext"> Choosing screen modes, resolutions, refresh rates and all that is all really tied into how you intend to update your game display - ie your `timing` solution.<br><br>If there only ever was one widely supported resolution with a given specific refresh rate, let's say like VGA 640x480 at 60hz (I think that's VGA right?) ... and everyone was using that mode, and everyone's computers and monitors supported it, you could just say okay, I know how fast the refresh will be and at what resolution, so that's what I will design my game around. Every time you Flip 1, you know your game will be running at 60hz, provided it isn't using more than 100% of the computer's resources. However, those days are long gone for the pc. Perhaps it's still true of the game consoles or handhelds, where you have a small set of supported resolutions and refresh rates, so you can predict it pretty easy, but in the pc world anything goes.<br><br>That means that if you plan to make game software for mac/windows/linux, then you really should consider decoupling your game's logic rate from the graphics update rate. You should expect the graphics must be redrawn and flipped once every display cycle, so if the display is at 60hz you know you have to draw 60 graphics frames per second, and if it's 120, you gotta draw that many in the same amount of time. You have to make your logic dynamic and flexible based on how many `frames per second` must be drawn. So if you design for 60hz and the display happens to be 120, you know you gotta do 2.0 logic updates per frame. But you can't fix it at 2.0 cus you might get other resolutions/refreshes.<br><br>Then if there isn't enough processing power to churn out 1 graphic frame for every refresh cycle, you know frames will be dropped, and then you have to compensate with your timing code. These are common workarounds for todays multi-resolution multi-hz-rate displays.<br><br>When it comes to choosing modes for displays to open, I recommend you use Blitz's list of available modes. They should in most cases be supported by the monitor (right?). Note that sometimes the hz rate is returned as 0 - it is on my Mac, so sometimes you have to guess at a hz rate. Blitz automatically chooses a `close` mode for you.<br><br>What I do is if I want the mode to be close to something, I will go through the list and prioritize display characteristics in the order of width, height, depth and hz rate. I first try to find modes with a width that is at least as big as what I want, then out of those a suitable height, then finally depth and hz. You also could scrap all 16-bit modes first if you really want 32-bit only. This is about the best you can do. Either let the user choose the mode or try to find one that is close. <br><br></td></tr></table><br>
<a name="986306"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mulawa1</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#56">[#56]</a></td></tr></table></td></tr><tr ><td class="posttext"> I appreciate what you're saying but most of it is not applicable to my games - for example my main project is my Jigsaw Engine - all we have to keep up with is how fast the user moves a piece across the screen - not a big ask! So my main concern remains - no tearing and no flicker - both of which seem to be well addressed by the code above.<br><br>Peter<br><a href="http://mulawa.net" target="_blank">http://mulawa.net</a> <br><br></td></tr></table><br>
<a name="986351"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#57">[#57]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> @Czar: Are you suggesting I buy an LCD for each of my many players? :o) <br></div> It's Christmas soon, so yes :D<br><br><div class="quote"> Old LCD's may not support anything over 60Hz  <br></div>Unless I'm mistaken (which is possible as this topic is a bit confusing for me) the big problem is screen flicker and tearing, the former of which is due to the way a CRT works. So it wouldn't matter if an LCD was at 60Hz or not for the purposes of screen flicker. <br><br></td></tr></table><br>
<a name="986406"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#58">[#58]</a></td></tr></table></td></tr><tr ><td class="posttext"> I know -- but where it does matter, is that if you were to *force* an 85Hz refreshrate, you may end up with a 'signal out of range' error on older LCDs. <br><br></td></tr></table><br>
<a name="986425"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#59">[#59]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't know if you CAN `force` modes, Blitz seems to only let you set modes which it can find in its `graphicsmodes` list, and presumably may not list ones which are not supported per the o/s? I know on my Mac it will not list stretched modes, e.g. 1024x768 at a 16:10 aspect ratio. So there is definitely some filtering going on somewhere. <br><br></td></tr></table><br>
<a name="986444"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >theHand</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#60">[#60]</a></td></tr></table></td></tr><tr ><td class="posttext"> It doesn't seem like this can be completely resolved.  I blame ATI (half-kidding).<br>Edit: removed the rest of the stuff I previously wrote, most was pretentious. :(<br>But, it's still a good idea to use GraphicsModeExists() (in a loop), especially if your game will allow the user to switch between different resolution / refresh rate combinations.  d-bug had already done what I was talking about, but for those who want real control over display (unless d-bug will maintain desktopext), you'll most likely have to get your hands dirty with C. <br><br></td></tr></table><br>
<a name="986474"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mulawa1</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#61">[#61]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm happy with my code above - it works on all my problem systems ok - but I'd be even happier if as many of you as possible would try it for me. :o)<br><br>Peter <br><br></td></tr></table><br>
<a name="986582"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >theHand</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#62">[#62]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, it is already done for you!<br>Wow, I feel <u>stupid</u>!  Ha ha ha!<br>CountGraphicsModes()<br>Hee hee, looks like BlitzMax is not the only one that "suffers" from this...I smell proprietism (give me a better word for the state of being proprietary and I'll correct it)...<br><br>Also, mulawa, it reported correctly here.  Good job. <br><br></td></tr></table><br>
<a name="986985"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MGE</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#63">[#63]</a></td></tr></table></td></tr><tr ><td class="posttext"> Never EVER change the computer's monitor refresh rate. That is soooo old school. Now days by either tweening or delta timing, that's how you compensate for fluctuating refresh rates. tsk,tsk. <br><br></td></tr></table><br>
<a name="986991"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#64">[#64]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's not (just) for timing, it's to reduce eye strain on CRTs. <br><br></td></tr></table><br>
<a name="987006"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Muttley</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#65">[#65]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ideally you really shouldn't tie your game to any specific resolution, use the projection matrix to ensure your game displays the same at any resolution.<br><br>When your game starts either start windowed, or start full-screen at the identical resolution, depth and frequency as the user's current desktop settings, and always (I repeat ALWAYS) let the user change the display settings to whatever they prefer. <br><br></td></tr></table><br>
<a name="987177"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#66">[#66]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't see why it's a problem to change the monitor refresh rate. so long as it is returned as a rate in the list of available modes, why not do it if the user wants to. I know on windows there used to be some crappy thing where changing resolutions/rates/modes would sometimes not revert back properly after your app finished - typical windows rubbish ;-D ... but it's certainly not an issue on the Mac, for example. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
