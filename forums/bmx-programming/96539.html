<!DOCTYPE html><html lang="en" ><head ><title >New() and Delete()</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >New() and Delete()</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >New() and Delete()</a><br><br>
<a name="1117540"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hiya all,<br><br>Something I just learned this evening is that you can see if you types are being destroyed and collected.<br>I knew that you could add code into the New() method but you can also add code into the Delete() method too. I didn't know this!<br><br>There is something on my mind though if you try the following code :-<br><pre class=code>
Type TestType
	Field x,y,z
	
	Method New()
		Print "New"
	EndMethod
	
	Method Delete()
		Print "Delete"
	EndMethod
EndType

Local Test:TestType = New TestType

Test.x=10
Print Test.x	'comment this to see Test ISN'T collected????

Test = Null

For Local x:Int = 0 To 1000
	GCCollect()
Next

Print "Finished"
</pre><br><br>Does 'Test' get optimised away if its not used elsewhere?<br>Regardless, I didn't know about the 'Delete' method!! <br><br></td></tr></table><br>
<a name="1117625"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BladeRunner</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> You can't tell for shure when an objectr will be collected by the GC. Therefore you should not put any critical code into delete().<br>The garbage collector will not free every object as soon as possible as it is often "cheaper" to keep the memory in case another object of this type is needed. <br><br></td></tr></table><br>
<a name="1117639"></a>

<a name="1117640"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I understand.<br><br>Setting the GC to manual acts the same too. However, it would be a nice 'feature' to be able to collect manually and accurately, as well as automatically.<br><br>Thanks BladeRunner.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1117645"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >matibee</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> IIRC it's also possible to perform operations during Delete() that can cause the object to not actually be deleted.<br><br>How's that for a mind f*ck ;)<br><br>Steer clear I tells ya.... <br><br></td></tr></table><br>
<a name="1117673"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>How's that for a mind f*ck ;)<br> <br></div><br><br>Well, we wouldn't want that now would we :D <br><br></td></tr></table><br>
<a name="1117858"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Corum</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> [offtopic]<br>  @matibee: what's happened to your website? It's 404ish.<br>  Was trying to download your framework for a test drive.<br>[/offtopic]<br><br>Cheers <br><br></td></tr></table><br>
<a name="1117861"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> I find delete handy from time to time but it should be used only with the knowledge that it isn't instantly called when you're done with something, just later on when the computer is...<br><br>One example I use. MiniB3D requires you to manually collect resources when you're done with them by freeing them (meshes, textures, etc.) I put those free calls into the delete method of the game object that manages the resources. e.g. I have a player object which contains health, gun damage, momentum information for a space ship, and a mesh that is the ship itself. When all references to the player object are released, some time later when the GC gets to it, it will call the delete method on the player, which will free the ship mesh, removing it from the 3D world. I don't just throw away a ship when I'm done with it because it won't be cleared when I want it to, but at the end of the match, while I'm loading a new level I can clear the ships, and load new ones letting the GC handle all the frees of the meshes along with disposing of all the other old data I no longer need from the last level. Of note, prior to this all the ships should be moved off the screen etc. so they don't display if they're not cleared by the time the new level starts (this is quite unlikely but still possible... never trust the GC!). It would be better to manually manage the resources (which I often do as well, a free method that nulls the mesh field after freeing it so that the delete method won't try to free it again...) but it's nice to have a fall back incase you miss something, or to help automate cleanup, etc.<br><br>Again, use with caution, know it's limits and so forth, but it can be a time saver from time to time. <br><br></td></tr></table><br>
<a name="1117890"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Armitage 1982</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I remember two years ago when I start my project, I was using delete() to free up memory with my game objects.<br>It was a mistakes because the Delete() was nearly never called while changing level, creating a huge memory grow (could we say leak). Now I use a Remove() Method I call myself instead.<br><br>I don't worry too much with the memory foot print on recent 2D games considering the worst machine of today comes at least with 256 Mo of free Ram. Now for VRam and mobile handled it's a different story. <br><br></td></tr></table><br>
<a name="1117982"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Does anyone remember the Dx9 memory leak issues?<br><br>Zeke found an issue in the that texture wasn't released which would obviously cause problems. Maybe its because the Delete() method in the Dx9 driver isn't getting called at all? This method is supposed to release the texture memory and also the cpu memory used by itself.<br><br>I wonder....hmmm. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
