<!DOCTYPE html><html lang="en" ><head ><title >changing DPI of an image?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >changing DPI of an image?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >changing DPI of an image?</a><br><br>
<a name="1086191"></a>

<a name="1086195"></a>

<a name="1086196"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gameproducer</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm working on to get my Pixmap to png working (here <a href="http://blitzbasic.com/Community/posts.php?topic=94614" target="_blank">http://blitzbasic.com/Community/posts.php?topic=94614</a> ) and there's one part that's missing:<br><br>Currently I save pixmaps as pngs like here:<br><pre class=code>SavePixmapPNG(img, "../mydeck/processed/" + filename, compression)</pre><br><br>This goes fine, and images have DPI 72. There's plenty of pixels but I'd need to make it better quality for printing (and to get correct print size, with dpi 72 my cards would be heckofa wide :D), thus I'd need to change DPI to 300 or 400. <br><br>Any ideas on changing DPI. Ideally I'd prefer:<br><br>1) Setting DPI while saving the image / Processing DPIs after saving using bmax. (Ideally, user should be able to define the new DPI)<br><br>Or<br><br>2) Buy/get some non-bmax software that does this (but would be good that licence would allow sharing, otherwise it's not much use to me) <br><br>I'd prefer #1. :)<br><br><b>EDIT:</b> Also, should work with PNG files. JPG is a optional bonus.<br><br><font class="tiny">Last edited 2011</font><br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1086214"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Maybe Irfanview? <br><br></td></tr></table><br>
<a name="1086227"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AdamRedwoods</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> DPI = dots per inch.<br><br>so whats the ratio from 72dpi increased to 300dpi?  (4.16666)<br>Then your new size will be the current card size * that ratio.<br><br>Once you have your new size, just use ResizePixmap().<br>If you need a better resize algorithm, then you'll need Photoshop caliber. <br><br></td></tr></table><br>
<a name="1086229"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gameproducer</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> @GfK: checking it out - if it can do batches, easily (so that preferrably user doesn't need to do anything but click once), then it might be ok.<br><br>@Adam:<br>To clarify: I mean DPI for printing. For example, I can have image that is 1000 pixels wide. If image has 100 dpi, then print version would be 10 inches wide (100 pixels per inch). <br><br>with 300 dpi, the pixels would be read by the printer so that the print version would be 3,33 inch wide.<br><br>If I'd do ResizePixmap, then it would mean that I'd get poorer quality since the printed product width is always the same 3 inches or so. In ResizePixmap the card pixels would be 4.16666 times smaller, and then with 72 dpi the print I could get 3 inch wide product.<br><br>Increasing pixmap 4.16666 bigger would give me 12 inch+ wide card. :)<br><br>I got pixels fine (1050 x 1450), I just need to change the DPI for printing purposes.<br><br>(Adam - correct me if I'm wrong, or misunderstood what you meant) <br><br></td></tr></table><br>
<a name="1086233"></a>

<a name="1086234"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AdamRedwoods</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> You're correct.<br><br>card = 1000 pixels width in current pixmap<br>printer = 10 inches wide @ 300dpi<br><br>therefore new width of ResizePixmap @ 300dpi = 3000 pixels<br><br><br>As for quality, ResizePixmap (i believe) uses a bicubic formula, so it will basically blur the image.<br><br>but I don't know of too many software programs that would do any better for enlarging something that size (there is one that uses fractals). You'll have to test it to see if it's an acceptable quality. Sometimes it's ok. Otherwise you'll have to look into using vector images, which leads me back to Brucey's Cairo modules. Vector images are DPI independent.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1086243"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gameproducer</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm quite new to dpi (trying to learn about it this day :D) but I believe it's not so much about increasing pixels... if I just could somehow tell image to be "300 dpi instead of 72", I'd be fine. <br><br>Since... the amount of pixels is fine (1050 x 1450 in my case). What I need is to change DPI info in pic so the printhouse can process it properly.<br><br>[infranview]<br>checked it... too much options for my taste. <br><br></td></tr></table><br>
<a name="1086259"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> You can change the DPI (and leave the pixel dimensions alone) using ImageMagick: <a href="http://www.imagemagick.org" target="_blank">http://www.imagemagick.org</a><br><br>Imagemagick comes with a command line tool, 'convert.exe' that can do many things, including change the DPI:<br><br><div class="quote"> <br>convert.exe input.jpg -density 180 output.jpg<br> <br></div> <br><br></td></tr></table><br>
<a name="1086270"></a>

<a name="1086271"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> [edit] sorry, was thinking of Brucy's FreeImage module... don't know if it supports DPI control<br><br>To clarify, DPI is a print conversion value basically, it doesn't affect the actual image data, just how it is rendered by a printer into physical size. Rescaling an image is VERY different than altering it's DPI.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1086280"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AdamRedwoods</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh, you want to change the DPI value in the image data? You may have to use freeImage-- but if your image was created in 72DPI, then you're only going to have 72DPI worth of information for a 300DPI image... which means you'll have visual "blockiness" unless the printer (or the OS) auto-runs a smoothing algorithm on it for you.<br><br>If your image has enough information, then you'll be fine. Bicubic resizing can help add in information for tiny images, but it's not foolproof.<br><br>You'll need to test each approach to see what is best and what works best for you. <br><br></td></tr></table><br>
<a name="1086349"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yan</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Gord love a duck...<br><br><br>I've run into this whilst pixmap mangling in the past. As it stands, SavePixmapPNG() leaves the DPI info undefined and I got tired of having to adjust manually.<br><br>Simple lash up, using code ripped from BRL's SavePixmapPNG()...<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">Strict

'Import BRL.Pixmap
Import Pub.LibPNG

Extern 
	Const PNG_RESOLUTION_METER = 1
	
	Function png_set_pHYs(png_ptr, info_ptr, res_x, res_y, unit_type)
End Extern

Private

Global png_stream:TStream

Function png_write_fn( png_ptr,buf:Byte Ptr,size )
	Return png_stream.WriteBytes( buf,size )
End Function

Function png_flush_fn( png_ptr )
	png_stream.Flush
End Function

Public

Function SavePixmapPNG(pixmap:TPixmap, url:Object, compression=5, xDPI=96, yDPI=96)
	png_stream:TStream=WriteStream( url )
	If Not png_stream Return
	
	compression=Min( Max( compression,0 ),9 )
	
	Try
		Local png_ptr=png_create_write_struct( "1.2.12",Null,Null,Null )
		Local info_ptr=png_create_info_struct( png_ptr )
	
		png_set_write_fn png_ptr,Null,png_write_fn,png_flush_fn
	
		Local bitdepth,colortype,transform
		
		Select pixmap.format
		Case PF_I8
			colortype=PNG_COLOR_TYPE_GRAY
		Case PF_RGB888
			colortype=PNG_COLOR_TYPE_RGB
		Case PF_BGR888
			colortype=PNG_COLOR_TYPE_RGB
			transform=PNG_TRANSFORM_BGR
		Case PF_RGBA8888
			colortype=PNG_COLOR_TYPE_RGBA
		Case PF_BGRA8888
			colortype=PNG_COLOR_TYPE_RGBA
			transform=PNG_TRANSFORM_BGR
		Default
			colortype=PNG_COLOR_TYPE_RGBA
			pixmap=pixmap.Convert( PF_RGBA8888 )
		End Select
	
		png_set_compression_level png_ptr,compression
		
		' Dots Per Inch -&gt; Dots Per Metre (rounded up)
		png_set_pHYs(png_ptr, info_ptr, (xDPI / 0.0254) + 0.5, (yDPI / 0.0254) + 0.5, PNG_RESOLUTION_METER)

		png_set_IHDR png_ptr,info_ptr,pixmap.width,pixmap.height,8,colortype,PNG_INTERLACE_NONE,PNG_COMPRESSION_TYPE_DEFAULT,PNG_FILTER_TYPE_DEFAULT
		
		Local rows:Byte Ptr[pixmap.height]
		For Local i=0 Until pixmap.height
			rows[i]=pixmap.PixelPtr( 0,i )
		Next
		
		png_set_rows png_ptr,info_ptr,rows
	
		png_write_png png_ptr,info_ptr,transform,Null
	
		png_destroy_write_struct Varptr png_ptr,Varptr info_ptr,Null
		
		png_stream.Close
		png_stream=Null
		
		Return True
		
	Catch ex:String
	
		If ex&lt;&gt;"PNG ERROR" Throw ex
	
	End Try
		
End Function

'------------------------------------------- TEST -------------------------------------------

Local inputPath$ = RequestFile("Select a image for DPI change...", "PNG Files:png;JPG Files:jpg;BMP Files:bmp;TGA Files:tga;All Files:*", False, CurrentDir() + "/")
If inputPath$ = Null Then End

Local outputPath$ = RequestFile("Save PNG as...", "PNG Files:png;All Files:*", True, RealPath(StripExt(inputPath$) + "_300DPI.png"))

Local pixmap:TPixmap = LoadPixmap(inputPath$)
Assert pixmap Else "Oops..."

SavePixmapPNG(pixmap, outputPath$, 9, 300, 300)

End

'------------------------------------------- TEST -------------------------------------------</textarea><br>...Worked a treat. <br><br></td></tr></table><br>
<a name="1086410"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gameproducer</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Holy capoly Yan. That looks amazing. Testing rightaway... <br><br></td></tr></table><br>
<a name="1086411"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gameproducer</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> ...and it works like a charm. Thanks Ian!! <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
