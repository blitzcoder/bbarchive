<!DOCTYPE html><html lang="en" ><head ><title >Move Data in A Bank</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Move Data in A Bank</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Move Data in A Bank</a><br><br>
<a name="635197"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SebHoll</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br><br>I'm performing a lot of modifications on data stored in a bank and I need to move one block of data from the middle part of the bank to the end. I'm doing this at the moment by making another temporary bank, copying the data to move into it, then copying that back to the end of the original bank. It works fine, it's just it is extremely slow when performing it on large files as most systems need to page(file) the additional memory.<br><br>Is there a way I could use MemMove() to quickly move data from one part of a bank to another?<br><br>Thanks<br><br>Seb <br><br></td></tr></table><br>
<a name="635198"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Have you tried using CopyBank with the same bank for source and destination.<br><br>Hmm, looking at the source it calls MemCopy instead of MemMove which is incorrect as overlapping source and destination regions may be involved so yes calling MemMove yourself is pbly your best bet. <br><br></td></tr></table><br>
<a name="635283"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SebHoll</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've tried using CopyBank but the data seems to get corrupted (I think because it overlaps). I'll have a play around with MemMove to see if I have any joy. - Will post if I get anywhere with it. <br><br></td></tr></table><br>
<a name="635289"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SebHoll</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br><br>I've managed to move data within a bank using MemMove. I've made an addition to the Module Tweaks if anyone wants to use it.<br><br>Seb<br><br>-------<br><br>In BlitzMax\mod\brl.mod\bank.mod\bank.bmx:<pre class=code>Rem
bbdoc: Move data within a bank
about:
#MoveBank moves @count bytes from @offset to @dst_offset.
End Rem
Function MoveBank( bank:TBank,offset,dst_offset,count )
	Assert..
	count&gt;=0 And..
	offset&gt;=0 And..
	offset&gt;=0 And..
	offset+count&lt;=bank.Size() And..
	dst_offset+count&lt;=bank.Size() Else "Illegal range for MoveBank"
	MemMove( bank.Buf()+dst_offset,bank.Buf()+offset,count )
End Function</pre> Then just recompile all the modules. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
