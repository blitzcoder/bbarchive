<!DOCTYPE html><html lang="en" ><head ><title >list remove object</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >list remove object</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >list remove object</a><br><br>
<a name="957214"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jur</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Has anyone have encountered problems with command list.Remove(o:object)? Like that it removes a wrong object? In my code I am using this command and it keeps removing the first object from the list instead the wanted one. I cant reproduce this in a simple sample code. The FindLink and RemoveLink approach also does not work, but if I get the link through list looping  than RemoveLink works. <br><br></td></tr></table><br>
<a name="957215"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> No. It always works as expected.<br><br>I would suggest it is probably a bug in your code. <br><br></td></tr></table><br>
<a name="957218"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Same, always worked fine, for me. <br><br></td></tr></table><br>
<a name="957220"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ziggy</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Don't get me wrong but, if I remember correctly, the only changes that have been made to lists in the last years is a new sort algorithm and the inclussion of exceptions when adding null objects. None of them affect the find object method that has been there for about 4 years, so all in all it seems like there's a bug in your code rather than in tlist. Just an impression, no offense intended! <br><br></td></tr></table><br>
<a name="957223"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Have you overriden the object's Compare method in order to customize how the list is sorted? <br><br></td></tr></table><br>
<a name="957224"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Otus</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Maybe a bug in your Compare method?<br><br>Edit: Gabriel beat me. <br><br></td></tr></table><br>
<a name="957315"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jur</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, I have overriden the compare method and that is the cause of the problem indeed. If I comment it out then the problem goes away!  Still, I have no idea what is actually wrong with my compare method (it do the job of comparing) and why it influence remove object at all. I am trying to reproduce the problem in simple code but so far without success.<br>Ok, here is my compare method:<br><br><pre class=code>
Method Compare(otherObject:Object)
	Local OtherProfile:TPlayerProfile = TPlayerProfile (otherObject)
	If Not OtherProfile Then Return 1		
	Return scoreReached - OtherProfile.scoreReached
End Method	
</pre><br><br>I am using two lists "Profiles" and "HiScores", both filled with objects of "TPlayerProfile" type, which contains the Compare method. I am sorting only "HiScores" list.  The problems occurs when I am removing an object from the "Profiles" list. I am using the references to these "TPlayerProfile" objects also in array somewhere else in the code, and one is always stored in a pointer variable.<br><br>Jure <br><br></td></tr></table><br>
<a name="957323"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Otus</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Try this:<br><pre class=code>Method Compare%(otherObject:Object)
	Local OtherProfile:TPlayerProfile = TPlayerProfile (otherObject)
	If Not OtherProfile Then Return Super.Compare(otherObject)
	If scoreReached = OtherProfile.scoreReached Then Return Super.Compare(otherObject)
	Return scoreReached - OtherProfile.scoreReached
End Method</pre><br>(Adding multiple types of objects may still mess sorting.)<br><br>Edit: The problem is that FindLink uses Compare - if it returns 0, the objects are considered the same. You might want to use something like player names instead of Super.Compare when scores are equal, though. <br><br></td></tr></table><br>
<a name="957332"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jur</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> The problem disappeared with the above method! Thank you Otus! But I am not sure if this would not influence hiscore sorting. To be on the safe side, I just made a custom sorting function as an argument for Sort method. <br><br></td></tr></table><br>
<a name="957344"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kurator</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> The Problem is in TList Compare is used for Sorting AND for determining Equality.<br><br>With only implementing sorting logic in your compare you will get this uncontrolled behaviour of TList that it removes entries from your compare method says "Oh, they are equal!" and returning 0.<br><br>But mostly you want to remove a specific instance of an object in your list. TList uses internally also the compare method to find the "right" link to delete...<br><br>Imho it is only sure to return 0 when it is the same instance (Self = Other for the above example) and return only -1 and 1 when you compare values / fields of your instance. It is a very small trade off if you return 1 on equal values - it doesn't affect the sorting, but it keeps you on track with deleting elements from list.<br><br>Personally I would prefer if BMax would use some other kind of determining equalitiy <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
