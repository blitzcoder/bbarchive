<!DOCTYPE html><html lang="en" ><head ><title >reload tImages at runtime</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >reload tImages at runtime</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >reload tImages at runtime</a><br><br>
<a name="860558"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >z4g0</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi!<br>I have a large number of "Global" tImage variables.<br>for example<br><pre class=code>
...
...
...
Global IMG_TitleBG:TImage = LoadImage("Style\" + Style + "\Title.png") 
Global IMG_FormBG:TImage = LoadImage("Style\" + Style + "\shade1.png") 
Global IMG_FormBG1:TImage = LoadImage("Style\" + Style + "\shade2.png") 
...
...
...
</pre><br>and draw it simply..<br><pre class=code>
DrawImage IMG_TitleBG,0,0 
..etc
</pre><br><br>now, I need to reload all these global image, with a new "Style"  path component, in runtime: <br>there's a way to do it not manually for each variable?<br><br>something like that<br><pre class=code>
Global IMG_TitleBG:TImage = LoadImage("Style\" + Style + "\Title.png") 
img[0]:tImage = IMG_titleBG
.....
......
'replace image
img[0]=  LoadImage("Style\" + *NEW*Style + "\Title.png")
 
</pre><br><br>obviously it don't works: changing "img" doesn't affect IMG_TitleBG.<br><br>And i can't add a <br>"IMG_titleBG = img[0]"<br>else I must do it for each global images, coming back at the start point.<br><br><br><br><br>I thought to use an auxiliar tMap (or tList) populated in an alternative "loadImage_2()" function that load and return a tImage var, and also add the ptr of this image in a the tMap.<br><br>But I'm stucked here: then how can I replace the pointed area with a new  loaded image? I think that's not possible :(<br><br>I'm also looking at Reflection, but in docs I only saw it used on Type and Type's istances, not simply Global variables. <br><br></td></tr></table><br>
<a name="860563"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> do NOT initialize the global in the same line as you declare it and it will work!<br><br>-&gt; this<br>Global IMG_TitleBG:TImage = LoadImage("Style\" + Style + "\Title.png") <br><br>must become<br>Global IMG_TitleBG:TImage <br>IMG_TitleBG = LoadImage("Style\" + Style + "\Title.png") <br><br></td></tr></table><br>
<a name="860564"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I would use a Media or Resource Manager to keep track of loaded objects and do a SetLoadPath with LoadAll and/or ReloadAll methods. <br><br></td></tr></table><br>
<a name="860570"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >z4g0</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> -&gt; this<br>Global IMG_TitleBG:TImage = LoadImage("Style\" + Style + "\Title.png")<br><br>must become<br>Global IMG_TitleBG:TImage<br><br>IMG_TitleBG = LoadImage("Style\" + Style + "\Title.png")<br> <br></div><br><br>but in this case still the problem to do a "reload" function where I change all global image manually<br>like<br><pre class=code>
function reloadStyle()
  IMG_TitleBG = LoadImage("Style\" + Style + "\Title.png") 
  IMG_FormBG = LoadImage("Style\" + Style + "\shade1.png") 
  IMG_FormBG1 = LoadImage("Style\" + Style + "\shade2.png") 
  ....
  ....
end function
</pre><br><br>and that is the thing I want, if possible, bypass.<br><br>I want turn it in something like<br><pre class=code>
function reloadStyle()
  '''for each Global images As node of a TList / TMap '''
       node = loadImage(..."+newStyle+"...)
  '''next'''
end function
</pre><br>continuing using global images like now.<br><br><pre class=code>I would use a Media or Resource Manager to keep track of loaded objects and do a SetLoadPath with LoadAll and/or ReloadAll methods.</pre><br>yes, using an auxiliar data structure was the idea... but cointainings what? <br>couse I want cointinue to draw these images using<br><pre class=code>
drawImage IMG_FormBG...
</pre><br>and NOT, for example<br><pre class=code>
drawImage tImage(StyleMngr.valueForKey("IMG_FormBG"))..
</pre><br>or<br>drawImage2("IMG_FormBG")<br>where drawImage2 is a function that return tImage from the data structure of style manager..<br><br>[EDIT]<br>mmm I can add images in tlist/tmap, and, not reload it with a loadImage (that create a new tImage, losing link at the gloabal variable), but "simply" replacing theirs PixMap! <br><br></td></tr></table><br>
<a name="860572"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> You have a Resource type with filepath, Filename, filesize whatever which extends into Image_Resource etc.<br>Your ResoureManager checks the extension of each file in your Media directory (and any sub-directories)  set using a SetMediaPath command and loads the resource using LoadImage, LoadSound or whatever. <br>The returned TImage, TSound pointer is stored in a field of a TResource Instance. The TResource instance is saved in a TMap with the key being the Filename of the resource. <br>When using the resource you simply use the Map Key <br>(e.g. "Myimage") in your own Drawimage.<br><a href="http://www.drizzle.com/~scottb/publish/gpgems1_resourcemgr.htm" target="_blank">  A Generic Handle-Based Resource Manager </a> is quite good but I understood <a href="http://www.gyurchev.com/articles.html" target="_blank"> Can We Handle it? </a> a bit better.<br><br>&lt;edit&gt; Sorry about the first link but it has a '~' in it which seems to naff up the link code. <br><br></td></tr></table><br>
<a name="860573"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> You can not bypass that function. At least not just like that.<br><br>Main problem is that you want the "professional" solution for loading but the noob kiddie solution for using the data (this means you have no sprite class but want to use the regular draw command with a given variable name instead of lookup the name or use a sprite class which handles everything). The combination of that will not really work as you can not evaluate variable names at realtime.<br><br>My suggestion for your problem:<br>Create a Sprite Class or something the like with a draw method.<br>That sprite method holds the name of the element (similar to your current IMG_FormBG) and the TImage handle. Potentially you can as well put scale, position and rotation in if you ever intend to use them for more (like animation).<br>As well give the class the possibility to load an image to replace the current one. lets say ChangeImage(path:string)<br><br>Store these Sprites in a list, the same list you use for all other objects (I would suggest using the Sprites for them as well!). Don't forget to store the TLink within the sprite for fast remove - repositioning within the list.<br><br>For faster lookup on reload and "name based operations" place the sprite as well within a TMap using its name.<br><br>Now drawing is as simple as looping over the list and call the draw method.<br>Altering the image is as simple as lookup the image by name in the tmap and call ChangeImage(path). From the next loop over the list on the new image will be drawn. <br><br></td></tr></table><br>
<a name="860592"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >z4g0</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> thanks :)<br>ATM I'm not using map/list for direct draw 'couse I have a lot of draw call: I thought that the access through tMap fields was too slower than using a global variable for a massive use of tImage...<br><br>if you tell me that's not too slow, I'll bring the global images into tMap nodes: At the moments in my program, except the Istances of the Managers (ie programManager, fileManager etc..), the images of skin are the only Global variables I'm using.. <br><br></td></tr></table><br>
<a name="860593"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> TMap is in the order of log2(n) lookup wise. so you would need to have a large amount of objects to make it "slow" ...<br>Its slower than local global, but not a real problem.<br><br>Though using TSprite or TUIElement (selfwritten classes) still might be (management wise) a better solution on the long run as they only need to do one lookup, when you change the image. afterwards they hold the image reference. This would be the best of both worlds ie a SpriteFactory that creates Sprites by name (lookup in TMap) but uses the images straight by type reference. <br><br></td></tr></table><br>
<a name="860612"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >z4g0</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> cool, I think i'll bring it in tMap's node so...<br><br>tnx ;) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
