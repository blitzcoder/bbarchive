<!DOCTYPE html><html lang="en" ><head ><title >Threading Stalls, GCollector?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Threading Stalls, GCollector?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Threading Stalls, GCollector?</a><br><br>
<a name="1045134"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BLaBZ</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Since I added threading it seems like every time the garbage collector decides to do it's thing the game stalls, is this normal? <br><br></td></tr></table><br>
<a name="1045143"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ziggy</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> You can try to improve the reusability of already created objects, and also a pre-frame adaptative delta-timing usually help making this unoticeable.<br><br>I've used <a href="/codearcs.php?code=2460" target="_blank">this</a> in several games and it works very well, as it calculates automatically the deltatiming factor in a per-frame basis, so if a frame takes longer, the game just 'drops' frames. <br><br></td></tr></table><br>
<a name="1045158"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> The garbage collector seems wonky with multithreading in a lot of ways currently in my experience. Even with delta timing the spikes can get quite nasty and frequent depending on how you're using memory. Personally I've resorted to turning off the garbage collector and do a GCCollect() every 10th of a second or so whenever it's safe (I.e. When no threads are mallocing or doing anything else very memory intensive that is going to cause troubles)<br><br>It's far from a perfect solution but with the current issues (see also create/clear images causes ram to climb and never clear) it's the best I've found at the moment. <br><br></td></tr></table><br>
<a name="1045170"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Building on what Ziggy said, if you do use a good timing system, with a fixed update, you can set your update rate very low (eg: 10 updates per second) and then use tweening to keep the visual updates supersmooth. Obviously, this won't work if you're creating a physics-heavy game which requires a high update rate, but on fairly undemanding casual games, it's more than enough. Because the update frequency is so infrequent, you can empty the garbage collector in your update code (not in your visual update) and the spikes will have less effect. <br><br></td></tr></table><br>
<a name="1045178"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sledge</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> You can try to improve the reusability of already created objects <br></div>This times a billion. I've come around to the idea that it should be a priority of the game(play) loop that it <b>actively avoids</b> creating garbage for the GC to chew on (do that stuff between levels instead). If you're dereferencing objects during gameplay then you're doing it wrong -- don't compensate with an over-engineered timing 'solution'; just <i>stop doing it wrong!</i> ;) <br><br></td></tr></table><br>
<a name="1045179"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sledge</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> DP (Ooh I don't get many of these!) <br><br></td></tr></table><br>
<a name="1045246"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BLaBZ</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Ziggy Omg! Recycling Objects, since I implemented it, my games running twice as fast! Brilliant =D <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
