<!DOCTYPE html><html lang="en" ><head ><title >Please test my rain system</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Please test my rain system</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Please test my rain system</a><br><br>
<a name="556362"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >altitudems</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> i've been playing around with my weather system a bit, and I would like to see what you guys think of it. Any ideas of how to make it better?<br><br>Also, what are some weather/camera effects that you would like to see?<br><br><a href="http://www.altitude-studios.com/blitzmax/raindemo.zip" target="_blank">http://www.altitude-studios.com/blitzmax/raindemo.zip</a> <br><br></td></tr></table><br>
<a name="556365"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FBEpyon</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I like it looks good, wouldn't mind look at the source:P<br><br>also do you have a good open source collision system using arrays I have seen your other one just wanting to know. <br><br></td></tr></table><br>
<a name="556368"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >REDi</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nice one altitudems, looks good, how about randomizing the scale of the splash/ripple anim, might add a bit of variety.<br>Also I quite like the look of double flashes for lightning, seems more realistic to me, maybe you could try that, sometimes one flash and sometimes two.<br><br><div class="quote"> Also, what are some weather/camera effects that you would like to see? <br></div><br><br>You could add some moving cloud shadows when its sunny. (and obviously brighten things up a bit as well) <br><br></td></tr></table><br>
<a name="556400"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzSupport</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Really nice. <br><br></td></tr></table><br>
<a name="556479"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kev</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> very nice, i like the split screen also. <br><br></td></tr></table><br>
<a name="556508"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Altitudem, if this is another part of your 2d engine then it's looks as if it's going to be fantastic.<br>Have you got a worklog so people can keep an eye on any progress? <br><br></td></tr></table><br>
<a name="556524"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FlameDuck</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nice! <br><br></td></tr></table><br>
<a name="556548"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >The r0nin</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I like!  Not so much that it obscures the gameplay elements, but enough that it adds atmosphere.  Probably could use an occasional larger or smaller splash sprite (they all looked the same size to me), but it is top notch. <br><br></td></tr></table><br>
<a name="556602"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >altitudems</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the support guys. The weather system is part of the game engine I am making. When I have the engine fairly far along I will post the source and maybe turn it into a community project. So far things have been going very smoothly. I will keep uploading demos for you guys so that you can see its progress.<br><br>@FBEpyon<br>What sort of collision code are you looking for again? Give me some more info and give you some source.<br><br>@Papa Lazarou<br>Those are some great ideas keep them coming.<br><br>@tonyg<br>If I get time I might start a worklog, but to be honest I would much rather post my progress in the forums. Not everyone reads the worklogs. <br><br></td></tr></table><br>
<a name="556604"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FBEpyon</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Im lookin for Tilemap(Array) collision thats not sticky<br><br>basicly Im looking for collision that if your in a corner you stop, but you can slide against a wall if you are pressing down and left against the wall.. down being the direct you can still move. <br><br></td></tr></table><br>
<a name="556609"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >altitudems</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> @FBEpyon<br>Give me a few minutes and I'll post some source for you. <br><br></td></tr></table><br>
<a name="556629"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >bradford6</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> very nice.<br>1. agree with Papa about the ripple sizes<br>2. lightning/thunder should not make the cam shake. maybe reserve that for an explosion of some sort (bomb, etc)<br>3. possibly create a storm center that has a varying degree of rain. when storm center is further away, delay between lightning and thunder is greater.<br>ZAP--BANG! (louder)<br>ZAP----------------------bang (Softer) <br><br></td></tr></table><br>
<a name="556638"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >altitudems</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> @bradford6<br>You're right the camera shouldn't shake when lightning strikes, but I just thought it added to the effect. Actualy, thunder can create vibrations, so there you go.<br>Storm center sounds like a good idea too.<br><br>@FBEpyon<br>Here is your code:<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">Strict
	
Const MapWidth:Int = 10, MapHeight:Int = 10		'Define map size
Const CellSize:Float = 32								'Define cell size
Global CollisionMap:Int [MapWidth,MapHeight]	'Create map array

Local P1_X:Float, P1_Y:Float					'The player's position
Local P1_AABB:Float [] = [-16.0,0.0,16.0,16.0]	'The player's bounding box


'Create some walls:
CollisionMap[2,2] = 1
CollisionMap[2,3] = 1
CollisionMap[2,4] = 1
CollisionMap[3,2] = 1
CollisionMap[5,5] = 1
CollisionMap[5,6] = 1
CollisionMap[5,7] = 1
CollisionMap[4,5] = 1
CollisionMap[3,5] = 1


Graphics 640,480,0

While Not KeyHit(KEY_ESCAPE)

	P1_X :+ (KeyDown(KEY_RIGHT) - KeyDown(KEY_LEFT)) * 2'Move player along X axis
	P1_Y :+ (KeyDown(KEY_DOWN) - KeyDown(KEY_UP)) * 2	'Move player along Y axis
	
	'Test for collision and seperate objects:
	AABB_To_Map_Collision(P1_X,P1_Y,P1_AABB)
	
	Cls
	
	'Draw Map:
	For Local MapX:Int = 0 To MapWidth - 1
		For Local MapY:Int = 0 To MapHeight - 1
			Local ScreenX:Int = MapX * CellSize
			Local ScreenY:Int = MapY * CellSize
			If CollisionMap[MapX,MapY] &lt;&gt; 0 SetColor 255,0,0 Else SetColor 0,64,0
			DrawRect ScreenX,ScreenY,CellSize,Cellsize
		Next
	Next
	
	'Draw Player:
	SetColor 255,255,255
	DrawRect P1_X+P1_AABB[0],P1_Y+P1_AABB[1],P1_AABB[2],P1_AABB[3]


	Flip
	FlushMem
Wend

Function AABB_To_Map_Collision (_X:Float Var,_Y:Float Var,_AABB:Float [])
	'Convert x/y coordinates to map cell space:
	Local MapCellX:Int = _X / CellSize
	Local MapCellY:Int = _Y / CellSize
	
	Local CollisionDetected:Byte = False
	
	'Loop through each possible collision:
	For Local MapX:Float = MapCellX - 1 To MapCellX + 1
		For Local MapY:Float = MapCellY - 1 To MapCellY + 1
			If MapX &gt;= 0 And MapX &lt;= MapWidth - 1 And MapY &gt;= 0 And MapY &lt;= MapHeight - 1
				If CollisionMap[MapX,MapY] &lt;&gt; 0
					Local Map_AABB:Float [] = [0.0,0.0,CellSize,CellSize]
					'Check for a collision on each axis:
					If (_AABB[0] + _X &gt; Map_AABB[0] + Map_AABB[2] + MapX * CellSize) Continue
					If (_AABB[0] + _AABB[2] + _X &lt; Map_AABB[0] + MapX * CellSize) Continue 
					If (_AABB[1] + _Y &gt; Map_AABB[1] + Map_AABB[3] + MapY * CellSize) Continue 
					If (_AABB[1] + _AABB[3] + _Y &lt; Map_AABB[1] + MapY * CellSize) Continue
					
					'If we get this far we have a collision:
					CollisionDetected = True
					
					'Determine the shortest seperation vector and seperate the object:
					Local vx1:Float,vx2:Float,vx3:Float,vx4:Float
					vx1 = (Map_AABB[0] + MapX * CellSize) - (_AABB[0] + _AABB[2] + _X)
					vx2 = (Map_AABB[0] + Map_AABB[2] + MapX * CellSize) - (_AABB[0] + _X)
					Local vy1:Float,vy2:Float,vy3:Float,vy4:Float
					vy1 = (Map_AABB[1] + MapY * CellSize) - (_AABB[1] + _AABB[3] + _Y)
					vy2 = (Map_AABB[1] + Map_AABB[3] + MapY * CellSize) - (_AABB[1] + _Y)
					If (vy1*-1) &lt; vy2 Then vy3 = vy1 Else vy3 = vy2
					If (vx1*-1) &lt; vx2 Then vx3 = vx1 Else vx3 = vx2
					If vx3 &lt; 0 vx4 = vx3 * -1 Else vx4 = vx3
					If vy3 &lt; 0 vy4 = vy3 * -1 Else vy4 = vy3
					If vx4 &gt; vy4
						_Y :+ vy3
					Else
						_X :+ vx3
					End If
				End If
			End If
		Next
	Next
		
	Return CollisionDetected
End Function

</textarea> <br><br></td></tr></table><br>
<a name="556662"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >bradford6</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> I agree that thunder would shake it a little, i would just reserve the BIG shakes for explosions and such. It is a very cool effect nonetheless! <br><br></td></tr></table><br>
<a name="556963"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FBEpyon</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> @altitudems<br><br>wow thats some insain code, im still rather new to this.. My old collision system works okay, but lost it and was really basic this one is a bit advance can you put in a little more comments..<br><br>if you want email me...<br><br>here is what I have now.<br><br><pre class=code>
Function TESTLINKCOLLISION:Int(COL_X:Int,COL_Y:Int,DIRECTION:Int)

	If DIRECTION = LINK_NORTH
	
		If TILEMAP[(((COL_X+16)+MAP_X)/16),((COL_Y+MAP_Y)/16),LAYER_S] = MASK_SOLID Or TILEMAP[((COL_X+MAP_X)/16),((COL_Y+MAP_Y)/16),LAYER_S] = MASK_SOLID
			LINK_Y = LINK_Y + LINK_SPEED
		EndIf 
	
	ElseIf DIRECTION = LINK_EAST
		
		If TILEMAP[(((COL_X+16)+MAP_X)/16),((COL_Y+MAP_Y)/16),LAYER_S] = MASK_SOLID Or TILEMAP[(((COL_X+16)+MAP_X)/16),(((COL_Y+16)+MAP_Y)/16),LAYER_S] = MASK_SOLID
			LINK_X = LINK_X - LINK_SPEED			
		EndIf
		
	ElseIf DIRECTION = LINK_SOUTH
	
		If TILEMAP[(((COL_X+16)+MAP_X)/16),(((COL_Y+16)+MAP_Y)/16),LAYER_S] = MASK_SOLID Or TILEMAP[((COL_X+MAP_X)/16),(((COL_Y+16)+MAP_Y)/16),LAYER_S] = MASK_SOLID	
			LINK_Y = LINK_Y - LINK_SPEED
		EndIf
		
	ElseIf DIRECTION = LINK_WEST
	
		If TILEMAP[((COL_X+MAP_X)/16),((COL_Y+MAP_Y)/16),LAYER_S] = MASK_SOLID Or TILEMAP[((COL_X+MAP_X)/16),(((COL_Y+16)+MAP_Y)/16),LAYER_S] = MASK_SOLID
			LINK_X = LINK_X + LINK_SPEED			
		EndIf
end function
</pre><br><br>for the time being im using zelda graphics for testing of my engine once i get everything done I will convert to my own graphics for a oringal title..<br><br>I can't get the collision to work right going in two directions :( <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
