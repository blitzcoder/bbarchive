<!DOCTYPE html><html lang="en" ><head ><title >Locking only part of an image</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Locking only part of an image</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Locking only part of an image</a><br><br>
<a name="474287"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Robert</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Currently the LockImage command locks the whole image, which means that when you UnlockImage, it is slow to update for large images (slow enough to be prohibitive for real-time work)<br><br>In some situations large images can be split up into smaller ones, in others however this makes the rest of the code much more complicated.  <br><br>Would it be possible to extend the LockImage command so that, optionally, only part of the image would be locked, thus speeding up the UnlockImage call? <br><br></td></tr></table><br>
<a name="474313"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> To really speed up use pixmaps as locking converts to pixmap and back again.<br><br>images are not really meant for "realtime operations" on them.<br><br>and locking only a part of it is not possible. <br><br></td></tr></table><br>
<a name="474524"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Um.. Instead of using LockImage on the image, which then transfers the image into main memory, performs changes on it there, and then transfers it back ... maybe keep 1 copy of the currently-to-be-seen image in videoram as an Image, and another copy as a pixmap in main memory - when you need to make a change, just update the pixamp and then turn it into an image, which saves on unneeded transfer time. <br><br>Which is what dreamora was saying. <br><br></td></tr></table><br>
<a name="474543"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Robert</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Looking at the Max2D source code, that is effectively what happens anyway.  LockImage simple returns the internal TPixmap object (ie. it does not create a new pixmap), and UnlockImage uses bindTex and uploadText to copy the changes to the image itself. <br><br></td></tr></table><br>
<a name="474588"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mark Tiffany</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Certainly with previous versions of Blitz using DirectX, and I *suspect* now with OpenGL too, the slowness of locking an image has relatively little to do with the size of the image.  Okay, so there's the obvious memcopy, but in DirectX, lockimage could vary in speed depending on when in the frame you did it.<br><br>I could of course be completely wrong, just saying that I'm not convinced reducing the size of the image will necessarily result in faster locking... <br><br></td></tr></table><br>
<a name="474752"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hotcakes</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I would imagine the greatest bottleneck would be sending the new image down the AGP bus. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
