<!DOCTYPE html><html lang="en" ><head ><title >Datestamp</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='Get the number of days since 1.1. Year 1 | Bekomme die Anzahl der Tage seit dem 1.1. Jahr 1, language=bb, category=Algorithms'><meta name='author' content='Diego'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 ><a href=codearcs.php>Code archives</a>/<a href=codearcs.php?cat=6>Algorithms</a>/Datestamp</h1><div class="quote">This code has been declared by its author to be Public Domain code.</div><br><a href="2110.bb">Download source code</a><br><br><table width="100%" cellspacing="0" cellpadding="0"><tr ><td width="100%"><table width=100% cellspacing=0 cellpadding=0><tr ><td class=headleft></td><td class=head><table width=100% cellspacing=0 cellpadding=0><tr ><td >Datestamp by Diego</td><td align="right">2007 </td></tr></table></td><td class=headright></td></tr></table></td></tr><tr ><td class="cell"> Datestamp(Date$) returns the number of days since 1.1. Year 1. If date is not set or an empty string, the current date will be used. Otherwise set date in the format "20 Sep 2007".<br>Tipp: You can find out the number of Days between two events with ABS(Datestamp(Event1$) - Datestamp(Event2$)).<br><br>Datestamp(Date$) gibt die Anzahl der Tage seit dem 1.1. des Jahres 1 zurück. Wenn Date nicht angegeben oder ein leerer String ist, wird das aktuelle Datum verwendet. Andernfalls gebe das Datum im Format "20 Sep 2007" (Monate bitte in Englisch) an.<br>Tipp: Du kannst die Anzahl der Tage zwischen 2 Ereignissen mit folgender Formel erhalten: ABS(Datestamp(Ereignis1$) - Datestamp(Ereignis2$)) </td></tr><tr ><td class="cell"><pre class="code">Function Datestamp(Date$ = "")
If Date$ = "" Then Date$ = CurrentDate()
Day% = Left(Date$, 2)
Year% = Right(Date$, 4)
Select Upper(Mid(Date$, 4, 3))
	Case "JAN"
		Month% = 0
	Case "FEB"
		Month% = 31
	Case "MAR"
		Month% = 59 + IstSchaltjahr(Year%)
	Case "APR"
		Month% = 90 + IstSchaltjahr(Year%)
	Case "MAY"
		Month% = 120 + IstSchaltjahr(Year%)
	Case "JUN"
		Month% = 151 + IstSchaltjahr(Year%)
	Case "JUL"
		Month% = 181 + IstSchaltjahr(Year%)
	Case "AUG"
		Month% = 212 + IstSchaltjahr(Year%)
	Case "SEP"
		Month% = 243 + IstSchaltjahr(Year%)
	Case "OCT"
		Month% = 273 + IstSchaltjahr(Year%)
	Case "NOV"
		Month% = 304 + IstSchaltjahr(Year%)
	Case "DEC"
		Month% = 334 + IstSchaltjahr(Year%)
	End Select
Year% = Year% - 1 ; To get only the days of the past years | Um nur die Tage der Vergangenen Jahre zu bekommen
Return Day% + Month% + Year% * 365 + Int(Floor(Year% / 4)) - Int(Floor(Year% / 100)) + Int(Floor(Year% / 400))
End Function

Function IstSchaltjahr(Year%)
If(Year% Mod 400 = 0) Return True
If(Year% Mod 100 = 0) Return False
If(Year% Mod 4   = 0) Return True
Return False
End Function

; If date is empty, the curent date will be used.
; Wenn das Datum nicht angegeben ist, wird das aktuelle Datum verwendet.
Print Datestamp()
WaitKey</pre></td></tr></table><br><a name="comments">Comments</a><br><br>None.<br><br><a href="codearcs.php" >Code Archives Forum</a><table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
