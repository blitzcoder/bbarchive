<!DOCTYPE html><html lang="en" ><head ><title >RC4 Komp. Algo.</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='De / Encoding Tool, language=bb, category=Algorithms'><meta name='author' content='Panno'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 ><a href=codearcs.php>Code archives</a>/<a href=codearcs.php?cat=6>Algorithms</a>/RC4 Komp. Algo.</h1><div class="quote">This code has been declared by its author to be Public Domain code.</div><br><a href="568.bb">Download source code</a><br><br><table width="100%" cellspacing="0" cellpadding="0"><tr ><td width="100%"><table width=100% cellspacing=0 cellpadding=0><tr ><td class=headleft></td><td class=head><table width=100% cellspacing=0 cellpadding=0><tr ><td >RC4 Komp. Algo. by Panno</td><td align="right">2003 </td></tr></table></td><td class=headright></td></tr></table></td></tr><tr ><td class="cell"> Algorythmus </td></tr><tr ><td class="cell"><pre class="code">Dim sbox(255) 
Dim keyh(255) 
Global key$ 
Global rc4$ 
Global re$ 
Global ec$ 
Global clear$ 
Global rc4k 
Global rc4cryp 
Key$="TEST KEY"  ; your key up to 255 bytes long 


clear$="SAFE YOUR DATA AND CODE WITH THE COOL RC4 ALGORYTMUS - (only private use, payment for commerzial) !" 
rc4init (key$) 
a$= rc4cryp$(clear$) 
Print a$ 
rc4init (key$) 
clear$= rc4enc$(a$) 
Print clear$ 
WaitKey() 
End 








Function  rc4init(key$)     ;__________________-- init sbox and keyh 
   keylen = Len(key$) 
      For i = 0 To 255 
         sbox(i) = i 
         kptr =kptr+1 
         keyh(i) = Asc(Mid$(key$,kptr,1)) 
         If kptr = keylen Then kptr = 0 
      Next 
      For i = 0 To 255 

         j = (j+sbox(i)+keyh(i)) 
         j= j Mod 256 
         swap = sbox(i) 
         sbox(i) = sbox(j) 
         sbox(j) = swap 
      Next 
       
i = rc4k(1) 

End Function 



Function rc4k(init)    ;__________________ 
Local x,y 

If initflag Then 
    x=0 
      y=0 
      Else 

         x =x+1 
         x =x Mod 256 
         y =y+(sbox(x)) 
         y =y Mod 256 
         swap =  sbox(x) 
         sbox(x) = sbox(y) 
         sbox(y) = swap 
         t = sbox(x)+sbox(y) 
         t =t Mod 256 
          
         rc4k =sbox(t) 
         Return rc4k 

End If 
End Function 

Function rc4cryp$(s$) ;___________________ cryp 

slen = Len(s$) 
For r = 1 To slen 
c = Asc(Mid$(s$,r,1)) 
k = rc4k(0) 

re$=re$+(Chr$(c Xor k)) 
Next 
rc4$= re$ 

Return rc4$ 
End Function 

Function rc4enc$ (s$) ;__________________-- decryp 
strl= Len(s$) 
For x = 1 To strl 
c = Asc(Mid$(s$,x,1)) 
k = rc4k(0) 
r$= r$+Chr$(c Xor k) 
Next 
Return r$ 
End Function</pre></td></tr></table><br><a name="comments">Comments</a><br><br>None.<br><br><a href="codearcs.php" >Code Archives Forum</a><table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
