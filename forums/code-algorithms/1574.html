<!DOCTYPE html><html lang="en" ><head ><title >mathematical algorithms</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='some mathematical algorithms, language=bb, category=Algorithms'><meta name='author' content='5t@nKy'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 ><a href=codearcs.php>Code archives</a>/<a href=codearcs.php?cat=6>Algorithms</a>/mathematical algorithms</h1><div class="quote">This code has been declared by its author to be Public Domain code.</div><br><a href="1574.bb">Download source code</a><br><br><table width="100%" cellspacing="0" cellpadding="0"><tr ><td width="100%"><table width=100% cellspacing=0 cellpadding=0><tr ><td class=headleft></td><td class=head><table width=100% cellspacing=0 cellpadding=0><tr ><td >mathematical algorithms by 5t@nKy</td><td align="right">2005 </td></tr></table></td><td class=headright></td></tr></table></td></tr><tr ><td class="cell"> some mathematical algorithms </td></tr><tr ><td class="cell"><pre class="code">Here are some of my collections:

this is the 'heron-algorithm' with which you can get the square root from 'n'

Function Sqr#(n#)
   x0#=1
   repeat
      check#=0.5*(x0#+n#/x0#)
      x0#=x1#
   until check#=x0#
   return x0#
end function

this function is to get the greatest common divisor:

Function gcd(A,B)
   While B &gt; 0
      R=A mod B
      A=B
      B=R
   Wend
   Return A
End Function

this function is to get the least common denominator and based on the gcd function

Function lcd(A,B)
   C=(A*B)/gcd(A,B)
   Return C
End Function

to get the factorial of a number you can use this

Function fac(n)
   check=1
   For i=1 To n
      check=check*1
   Next
   Return check
Emd Function

this function is to get the binomial coefficient, this is to get the number of Pascal's triangle (n choose k)

Function nCk(n,k)
   Return Fac(n)/(Fac(k)*Fac(n-k))
End Function

so that's it!

I hope it's useful and sorry for my bad english^^</pre></td></tr></table><br><a name="comments">Comments</a><br><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Matty</td><td align="right"><font class=tiny>2005</font></td></tr></table></td></tr><tr ><td class="posttext"> Without actually testing it myself I would make the comment that with Heron's Algorithm it would be better to finish the repeat..until loop when abs(check-xo)&lt;some small tolerance value as otherwise it could loop indefinitely for some values. <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Floyd</td><td align="right"><font class=tiny>2005</font></td></tr></table></td></tr><tr ><td class="posttext"> Sometimes you have to be careful with integer arithmetic as well.<br>With large numbers A*B can 'overflow'. Here is an example of the problem and a corrected lcd().<br><pre class=code>
big1 = 100000
big2 = 150000

Print gcd(big1, big2)
Print lcd(big1, big2)
Print lcd2(big1, big2)

WaitKey

Function gcd(A,B)
   While B &gt; 0
      R=A Mod B
      A=B
      B=R
   Wend
   Return A
End Function

Function lcd(A,B)
   C=(A*B)/gcd(A,B)
   Return C
End Function

Function lcd2(A,B)
   Return A * ( B / gcd(A,B) )
End Function</pre> <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TAS</td><td align="right"><font class=tiny>2008</font></td></tr></table></td></tr><tr ><td class="posttext"> Function fac(n)<br>   check=1<br>   For i=1 To n<br>      check=check*1<br>   Next<br>   Return check<br>Emd Function<br><br>;should be<br>Function fac(n)<br>   check=1<br>   For i=1 To n<br>      check=check*n<br>   Next<br>   Return check<br>End Function <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >degac</td><td align="right"><font class=tiny>2008</font></td></tr></table></td></tr><tr ><td class="posttext"> I think there's a type-error in the FAC function<br><pre class=code>
Function fac(n)
   check=1
   For i=1 To n
      check=check*i
   Next
   Return check
End Function

Print "4! = "+fac(4)
Print "3! = "+fac(3)
Print "-1! = "+fac(-1)
Print "-4! = "+fac(-4)

Print "0! = "+fac(0)
</pre> <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warpy</td><td align="right"><font class=tiny>2008</font></td></tr></table></td></tr><tr ><td class="posttext"> That works for me... factorial isn't really defined for negative numbers. <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>2010</font></td></tr></table></td></tr><tr ><td class="posttext"> Lots of bugs in the original code. Some of it wont even compile, for example: "Emd Function"<br><br>Anyway, here's some fixed and optimised versions:<br><pre class=code>
Function Fac%(n%)
	If(Not(n%))Then Return 0
	Local nReturn%=1
	Local nIter%=1
	For nIter%=1 To n%
		nReturn%=nReturn%*nIter%
	Next
	Return nReturn%
End Function

Function nCk%(n%,k%)
	If (k%&gt;0) And (k&lt;n%) Then Return Fac(n%)/(Fac(k%)*Fac(n-k%))
	Return 0
End Function

Function Gcd%(A%,B%)
	Local n%=0
	If (B%&lt;1) Then Return 0
	While (B%)
		n=A% Mod B%
		A%=B%
		B%=n%
	Wend
	Return A%
End Function
</pre><br><br>I'm not sure what "your" Heron's algorithm is trying to do, but as it stands, it doesn't even follow Heron's formula or stops itself from looping to infinity. You have thrown in values like x1# for no reason whatsoever. Thus it fails on pretty much everything.<br><br>Recommend using Heron's ACTUAL algorithm:<br><br>fCurrent#=0.5*(fLast#+(n%/fLast#))<br><br>Using this formula limited by n iterations (It should never need that many, but makes a good prevention of infinite loops) gives a pretty good return.<br>Dunnno whether it's faster or slwoer than Blitz' default Sqr() or even, whether or not it gives as good accuracy.<br><br><pre class=code>
Function Sqrt#(n%)
	Local fCurrent#=n%
	Local fLast#=0.5*(fCurrent#+(n%/fCurrent#))
	Local nIter%=1
	While ((nIter)*(nIter%&lt;n))
		nIter%=nIter%+1
		fCurrent#=0.5*(fLast#+(n%/fLast#))
		fLast#=fCurrent#
	Wend
	Return fLast
End Function
</pre><br><br>Note for future reference: Test your code a bit before submitting it ;) <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Floyd</td><td align="right"><font class=tiny>2010</font></td></tr></table></td></tr><tr ><td class="posttext"> This all needs to be done more carefully.<br><br>First a minor fix, Fac(0) should return 1. That is by definition.<br><br>As with the lcd function the intermediate calculations can easily overflow even if the final result is reasonably small. For example, nCk( n, 2 ) should always be n*(n-1)/2. Thus nCk( 21, 2 ) is 21*20/2 = 210. There is no reason to fool around with huge numbers like Fac(21)/Fac(19) just to get 21*20.<br><br>Also notice the symmetry with nCk( n, k ) = nCk( n, n - k ). We don't need to calculate nCk( 21, 19 ) directly because we know it is the same as nCk( 21, 2 ).<br><br>Anyhow, here's the right way to calculate nCk, which I have renamed nCr to match the way it is usually named on scientific calculators. <br><br>Note for example that nCr( 21, 2 ) returns 210 as it should.<br>The original nCk( 21, 2 ) manages to produce -5.<br><br><pre class=code>
Function nCr( n, r )  ; binomial coefficient "n choose r"
	If r &gt; n/2 Then Return nCr( n, n - r )
	c = 1
	For d = 1 To r
		c = ( c * ( n +1 - d ) ) / d
	Next
	Return c
End Function</pre> <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>2010</font></td></tr></table></td></tr><tr ><td class="posttext"> Thanks, Floyd. <br><br></td></tr></table><br><a href="codearcs.php" >Code Archives Forum</a><table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
