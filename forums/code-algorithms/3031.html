<!DOCTYPE html><html lang="en" ><head ><title >GetWord() &amp; CountWords()</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='Functions for easy and accurate parsing., language=bb, category=Algorithms'><meta name='author' content='misth'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 ><a href=codearcs.php>Code archives</a>/<a href=codearcs.php?cat=6>Algorithms</a>/GetWord() &amp; CountWords()</h1><div class="quote">This code has been declared by its author to be Public Domain code.</div><br><a href="3031.bb">Download source code</a><br><br><table width="100%" cellspacing="0" cellpadding="0"><tr ><td width="100%"><table width=100% cellspacing=0 cellpadding=0><tr ><td class=headleft></td><td class=head><table width=100% cellspacing=0 cellpadding=0><tr ><td >GetWord() &amp; CountWords() by misth</td><td align="right">2013 </td></tr></table></td><td class=headright></td></tr></table></td></tr><tr ><td class="cell"> Get the word from string with index number and separator. Count how many words your input has, split with separator too.<br><br>Original CoolBasic version by KilledWhale </td></tr><tr ><td class="cell"><pre class="code">; ***************
; ** Functions **

; GetWord$()
;  in$ = Input text where you want your word from
;  pos% = Position, or index number which word you want
;  sep$ = Separator. Can be anything. Input text is split with this. (Default = space)
Function GetWord$(in$, pos%, sep$ = " ")
	Local i%, sepPos%
	Local l% = Len(sep) ; Separators length
	
	For i = 2 To pos ; Go through every unwanted words
		sepPos = Instr(in, sep) ; Is separator found?
		If sepPos Then ;  Yes, it is.
			in = Mid(in, sepPos + l) ; Remove unwanted text all the way to first separator
		EndIf
	Next
	
	sepPos = Instr(in, sep) ;  Let's see again if we find separator
	
	If sepPos Then ; If found...
		Return Mid(in, 1, sepPos - 1) ; ...Return text without the next separator
	Else ; If not found...
		Return Mid(in, 1) ; Return the remainder
	EndIf
	
End Function

; CountWords$()
;  in$ = Input text where you want to count the words from
;  sep$ = Separator. Can be anything. Input text is split with this. (Default = space)
Function CountWords%(in$, sep$ = " ")
	Local count% = 0, sepPos%
	
	Repeat
		count = count + 1 ; Increase 'count' for how many words we've found
		sepPos = Instr(in, sep, sepPos + 1) ; Any separators?
		If Not sepPos Then ;  Nope.
			Exit ; Ok, let's just go out
		EndIf
	Forever
	Return count ; Return the word count
End Function


; *************
; ** EXAMPLE **

Local input_$ = "I am a sentence.|You can split me any way you want."
Local i%

; Split our 'input_' with "|" character
Print GetWord(input_, 1, "|")
Print GetWord(input_, 2, "|")
Print " "

; Split our 'input_' by spaces and print every word.
For i=1 To CountWords(input_," ")
	Print GetWord(input_, i, " ")
Next

End ; BYE!

; ****************
; ** THE OUTPUT **

; I am a sentence.
; You can split me any way you want.
;
; I
; am
; a
; sentence.|You
; can
; split
; me
; any
; way
; you
; want.</pre></td></tr></table><br><a name="comments">Comments</a><br><br>None.<br><br><a href="codearcs.php" >Code Archives Forum</a><table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
