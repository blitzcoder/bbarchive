<!DOCTYPE html><html lang="en" ><head ><title >Loading Bar</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='Just a simple Loading bar example, language=bb, category=Algorithms'><meta name='author' content='Krischan'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 ><a href=codearcs.php>Code archives</a>/<a href=codearcs.php?cat=6>Algorithms</a>/Loading Bar</h1><div class="quote">This code has been declared by its author to be Public Domain code.</div><br><a href="2738.bb">Download source code</a><br><br><table width="100%" cellspacing="0" cellpadding="0"><tr ><td width="100%"><table width=100% cellspacing=0 cellpadding=0><tr ><td class=headleft></td><td class=head><table width=100% cellspacing=0 cellpadding=0><tr ><td >Loading Bar by Krischan</td><td align="right">2010 </td></tr></table></td><td class=headright></td></tr></table></td></tr><tr ><td class="cell"> This is a simple Loading bar example showing the progress of two subtasks and the total progress bar from 0...100%. If you have a counter variable where the program is calculating something, ex. i=1...1000 and you know that this part is from 0%...30% of total progress, the correct values in the Function UpdateBar() must be:<br><br>UpdateBar("Taskname",i,1000,0,30) </td></tr><tr ><td class="cell"><pre class="code">Graphics 800,600,32,2

SetBuffer BackBuffer()

Global Screenwidth=GraphicsWidth()
Global Screenheight=GraphicsHeight()
Global title$="Loading Bar Demo"

For i=0 To 300 Step 2
	
	UpdateBar("Task 1",i,300,0,30)
	
Next

For j=0 To 1000 Step 4
	
	UpdateBar("Task 2",j,1000,30,100)
	
Next

Cls

Print "Finished!"

WaitKey

End

Function UpdateBar(info$,current#,max#,startpercent#=0.0,endpercent#=100.0,r1%=128,g1%=0,b1%=0,r2%=0,g2%=192,b2%=0,r3%=255,g3%=255,b3%=255)
	
	Local percent#,milepercent#
	
	Local width%=Screenwidth/2
	Local height%=18
	Local midx%=(Screenwidth/2)
	Local midy%=(Screenheight/2)
	Local sx%=midx-(width/2)
	Local sy%=midy-(height/2)
	Local factor#=width*1.0/100
	
	; program termination always possible
	If KeyHit(1) Then End
	
	; calc percentages
	percent=(current*100.0)/max
	milepercent=((percent*(endpercent-startpercent))/100.0)+startpercent
	
	; upper bar border, red bar background, green progress bar (total)
	DrawBar(sx,sy,width,height,r1,g1,b1)
	DrawBar(sx,sy,Int(milepercent*factor),height,r2,g2,b2)
	Color 0,0,0 : Rect sx,sy,width+1,height,0
	
	; lower bar border, red bar background, green progress bar (current task)
	DrawBar(sx,sy+height+3,width,height,r1,g1,b1)
	DrawBar(sx,sy+height+3,Int(percent*factor),height,r2,g2,b2)
	Color 0,0,0 : Rect sx,sy+height+3,width+1,height,0
	
	Color r3,g3,b3
	
	; text infos
	Text midx,midy-18,title,1,1
	Text midx,midy-1,Int(milepercent)+"%",1,1
	Text midx,midy+height+2,info,1,1
	
	Flip 1
	
End Function

Function DrawBar(x%,y%,width%,height%,r%,g%,b%)
	
	Local i%,c%
	
	For i=0 To height-1
		
		Color r,g,b
		Line x,y+i,x+width,y+i
		
	Next
	
End Function</pre></td></tr></table><br><a name="comments">Comments</a><br><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Matty</td><td align="right"><font class=tiny>2010</font></td></tr></table></td></tr><tr ><td class="posttext"> Just a general comment regarding progress bars - (not specifically related to your code, and just in case anyone does not realise) - it is not a good idea to 'update' the progress bar too often as the cumulative time taken to do the flip command (60Hz for example) can begin to add up so use these sorts of things wisely..for example every 5/10% perhaps... <br><br></td></tr></table><br><a href="codearcs.php" >Code Archives Forum</a><table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
