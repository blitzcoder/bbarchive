<!DOCTYPE html><html lang="en" ><head ><title >Vernam-Cipher | Encryption &amp; Decryption</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='Encrypt &amp;amp; Decrypt Strings with a password, language=bb, category=Algorithms'><meta name='author' content='ozzi789'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 ><a href=codearcs.php>Code archives</a>/<a href=codearcs.php?cat=6>Algorithms</a>/Vernam-Cipher | Encryption &amp; Decryption</h1><div class="quote">This code has been declared by its author to be Public Domain code.</div><br><a href="2914.bb">Download source code</a><br><br><table width="100%" cellspacing="0" cellpadding="0"><tr ><td width="100%"><table width=100% cellspacing=0 cellpadding=0><tr ><td class=headleft></td><td class=head><table width=100% cellspacing=0 cellpadding=0><tr ><td >Vernam-Cipher | Encryption &amp; Decryption by ozzi789</td><td align="right">2012 </td></tr></table></td><td class=headright></td></tr></table></td></tr><tr ><td class="cell"> Those two functions let you encrypt&amp;decrypt strings easly with a provided password.<br><br>It is pretty secure with a strong &amp; long password.<br><br>Only ways to break the encryption is:<br>-Bruteforce (yeah lol)<br>-Frequency analysis of the letters <br><br><br>Note for those who know how Vernam works:<br>My functions repeat the keyword/password if its shorter than the string you are manipulating </td></tr><tr ><td class="cell"><pre class="code">;ozzi789 - 30.01.2012
original_string$="Vernam ist toll"
Print "Original String: "+original_string$

encrypted_string$= vernam_enc(original_string$,"secret1")
Print "Encrypted String: "+encrypted_string$

decrypted_string$=vernam_dec(encrypted_string$,"secret1")
If original_string$=decrypted_string$
	Print "Decrypted String: "+decrypted_string$
Else
	Print "This should not happen :'("
EndIf 


Function vernam_enc$(strng$,key$)
	len_strng=Len(strng$)
	len_key=Len(key$)
	
	key_index=1
	For x=1 To len_strng
		current_strng$=Mid(strng$,x,1)
		current_key$=Mid(key$,key_index,1)
		new_strng$=new_strng$+Chr(Asc(current_strng$)+Asc(current_key$))
		key_index=(x Mod len_key)+1
	Next	
	Return new_strng$
End Function 

Function vernam_dec$(strng$,key$)
	len_strng=Len(strng$)
	len_key=Len(key$)
	
	key_index=1
	For x=1 To len_strng
		current_strng$=Mid(strng$,x,1)
		current_key$=Mid(key$,key_index,1)
		new_strng$=new_strng$+Chr(Asc(current_strng$)-Asc(current_key$))
		key_index=(x Mod len_key)+1
	Next	
	Return new_strng$
End Function</pre></td></tr></table><br><a name="comments">Comments</a><br><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>2012</font></td></tr></table></td></tr><tr ><td class="posttext"> SWEET! I can use this to encrypt my map data even further! Thanks, Ozzi! =D <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ozzi789</td><td align="right"><font class=tiny>2012</font></td></tr></table></td></tr><tr ><td class="posttext"> Glad i could help ! :) <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SystemError51</td><td align="right"><font class=tiny>2012</font></td></tr></table></td></tr><tr ><td class="posttext"> I'll test this for data encryption/decryption in my game project. This is extremely interesting considering what I just read about the Vernam Cipher.<br><br>// EDIT:<br>It's working :) <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >virtlands</td><td align="right"><font class=tiny>2013</font></td></tr></table></td></tr><tr ><td class="posttext"> I love encryption stuff, thanks for posting 'Vernam-Cipher'. <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>2014</font></td></tr></table></td></tr><tr ><td class="posttext"> Can someone show an example or site that has this exact function only in PHP, javascript, jquery, or JSON?<br><br>thanks! <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >virtlands</td><td align="right"><font class=tiny>2014</font></td></tr></table></td></tr><tr ><td class="posttext"> The Vernam Cipher {Crypto Museum}     -- <font class="tiny"> <a href="http://tinyurl.com/kzo37zx" target="_blank">http://tinyurl.com/kzo37zx</a> </font> <br>Inside the world of Ciphers {in Java} -- <font class="tiny"> <a href="http://tinyurl.com/m3wz2dw" target="_blank">http://tinyurl.com/m3wz2dw</a> </font> <br><b>Javascript</b> - simple vernam cipher     -- <font class="tiny"> <a href="http://tinyurl.com/nm47u22" target="_blank">http://tinyurl.com/nm47u22</a> </font> <br>GitHub Gist Vernam Cipher in JS       -- <font class="tiny"> <a href="http://tinyurl.com/nast2jb" target="_blank">http://tinyurl.com/nast2jb</a> </font> <br>Vernam Cipher in C# {CodeProject }    -- <font class="tiny"> <a href="http://tinyurl.com/l3cbyrf" target="_blank">http://tinyurl.com/l3cbyrf</a> </font> <br>Vernam Cipher in Java {dream in code} -- <font class="tiny"> <a href="http://tinyurl.com/n2zzz56" target="_blank">http://tinyurl.com/n2zzz56</a> </font> <br><img src="http://i37.photobucket.com/albums/e73/VirtLands/emoticons/FaceBook%20Emoticons/pacman.png"> <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >zoqfotpik</td><td align="right"><font class=tiny>2014</font></td></tr></table></td></tr><tr ><td class="posttext"> This is essentially a one-time pad and thus is secure.  But he says this:<br><br><div class="quote"> My functions repeat the keyword/password if its shorter than the string you are manipulating <br></div><br><br>If it does that, it is instantly zero security (due to differential cryptanalysis) so shouldn't be used for anything serious with keys shorter than the message.  The problem with sufficiently long keys becomes key exchange. <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>2014</font></td></tr></table></td></tr><tr ><td class="posttext"> Then tell us, oh wise one. How would you fix this script then? <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Matty</td><td align="right"><font class=tiny>2014</font></td></tr></table></td></tr><tr ><td class="posttext"> Use a key as long as the message.... <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dna</td><td align="right"><font class=tiny>2017</font></td></tr></table></td></tr><tr ><td class="posttext"> When you use:<br><pre class=code>VERNAM_DEC$(E$,Left$(K$,Rand(1,Len(K$))))</pre><br>You get a partial answer to the original text. I did it this way to see if this could be a weak spot in the cypher.<br>Is it? <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>2017</font></td></tr></table></td></tr><tr ><td class="posttext"> Not if you do it right.<br><br>~GF <br><br></td></tr></table><br><a href="codearcs.php" >Code Archives Forum</a><table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
