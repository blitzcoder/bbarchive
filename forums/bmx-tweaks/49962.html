<!DOCTYPE html><html lang="en" ><head ><title >Adding depth buffer to max2d stuff</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Adding depth buffer to max2d stuff</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=110" >BlitzMax Module Tweaks</a>/<a href="#bottom" >Adding depth buffer to max2d stuff</a><br><br>
<a name="555355"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shagwana</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Right, hears an idea;<br><br>Imagine if the max2d (opengl &amp; directx) had access to the depth buffer (ie instead of just drawimage image,x,y placement, there would be drawimage image,x,y,[z])<br><br>One of the many effects this could be used for is to auto clip the images being drawn to the screen. For example; Instead of the need to draw everything in order (back of screen to the front of the screen) the programmer could decide what to draw and when - so it could be possible to place an image in between two already draw images.<br><br>As i know very little about the internal setup of direct x and opengl max2d mods, would this be a lot of work to pull off?.<br><br>For the opengl side of things, i figure i would have to;<br><br>1. Ensure that the depth buffer is enabled when the screen is created.<br><br>2. Convert image drawing calls to glTexCoord2f into glTexCoord3f (using a set z value)<br><br>3. Provide the user with some control over how the depth buffer is used. (for example, always draw, when z is equal or less, when z is less ... etc ...)<br><br>Now my question, as im not as clued up on OOP as i should be;<br><br>Now when it comes to doing this, would it be best to create a new mod for max, calling it "Max2.5d" or somehow extend the current set of commands to do it?.<br><br>Another thing, how on earth would i pull this off with directx!?. <br><br></td></tr></table><br>
<a name="555365"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Depth buffer = Max3D? :) <br><br></td></tr></table><br>
<a name="555373"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shagwana</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Not for what i have planned.<br><br>Depth buffer (or as some call it the z-buffer) has existed for ages. All it does is store the depth (into the screen) of each pixel on the screen. <br><br>When a pixel is drawn to the screen, its checked against the depth buffer (for that pixels location). If the pixel is closer (on top) to the camera then whats already there, then its drawn to the screen and alters the depth buffer. If whats already on the screen is closer, then nothing gets drawn.<br><br>All i wish to be able to do is add a z option to all the draw commands - so i can set an image to the correct depth!<br><br><br>The main reason for me doing this, is because its &lt;should&gt; be faster on older hardware then using the stencil buffer. <br><br></td></tr></table><br>
<a name="555378"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> ZBuffer is very old, but volume textures aren't ... don't think they are even supported in DX7 nor OpenGL 1.2 which is what Max2D is <br><br></td></tr></table><br>
<a name="555382"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Pixels that fail the ztest may very well be faster but I would assume ztesting itself will have it's own penalty on older hardware. <br><br></td></tr></table><br>
<a name="555479"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shagwana</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> ZBuffer is very old, but volume textures aren't ... don't think they are even supported in DX7 nor OpenGL 1.2 which is what Max2D is <br></div><br>Its not volume textures im thinking about, its more like textured quads in 3d space without perspective. Depth is not defined for each pixel, but for the whole quad texture (image). <br><br></td></tr></table><br>
<a name="555968"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AntonyWells</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> 2. Convert image drawing calls to glTexCoord2f into glTexCoord3f (using a set z value) <br></div><br><br>That would only set the Texture W Coord to your z value.<br><br>You'd have to change glVertex2f X,Y to glVertex3f x,y,Z;<br><br>And use glClear( GL_DEPTH_BUFFER_BIT) tp clear it when cls'ing.<br><br>also, glEnable(GL_Depth_Buffer) to turn it on.<br><br>You may need to set the depth func, not sure if it's on by default. glDepthFunc GL_LEQUAL  etc. <br><br></td></tr></table><br>
<a name="556075"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shagwana</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, i was thinking some effects could be pulled off with the "glDepthFunc" command - like auto clipping, when on the same depth (GL_LESS). Now this would be of great use to me as im using the stencil to do the same sort of results at i imagine a slower speed. <br><br></td></tr></table><br>
<a name="556086"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DocFritz</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think "Max2.5d" would be a great Idea, and if it's possible it should be implemented. Of course optional, if you don't need the Depth-Buffer, it shouldn't be activated. <br><br></td></tr></table><br>
<a name="560227"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shagwana</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Right, done some testing on this and I have manage to 'hack' it into opengl max2d driver. Tests indicate that on my old hardware (tnt1 p3-500) that there is very little slow down in its use - compared to stencil bueffers!.<br><br>Now, anyone got any idea on how to do this sort of thing in direct-x? <br><br></td></tr></table><br>
<a name="560287"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DocFritz</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Great, when will be the "release" of your Module-Tweak? ^^<br>Concerning DirectX... erm... no idea. Anyone? <br><br></td></tr></table><br>
<a name="571593"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sonic</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> I just created a type called 'graphicscue' which contains a list of 'graphics' (type with x,y,image etc) then I over-rode Object.Compare() for the 'graphics' type so I could Sort according to the Y position.  All images have thier handle set to the bottom so they will be drawn in order.  Simple but works fine (for my point'n'click, Monkey Island style pseudo 3d).  Don't know if that helps! <br><br></td></tr></table><br>
<a name="571595"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is already in BMAX, you just need to change the modules that handle drawing to pass a z-coordinate. At the moment they pass z as 0.<br><br>Have a look at my module tweak for Textured Polys : <a href="http://www.blitzbasic.com/Community/posts.php?topic=51059" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=51059</a><br><br>Here I pass an array xyuv[], just change it to pass xyzuv[], pass the relevant data and voila. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
