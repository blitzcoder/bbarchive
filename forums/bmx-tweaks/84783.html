<!DOCTYPE html><html lang="en" ><head ><title >Modified bbArrayCastFromObject</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Modified bbArrayCastFromObject</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=110" >BlitzMax Module Tweaks</a>/<a href="#bottom" >Modified bbArrayCastFromObject</a><br><br>
<a name="958298"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >N</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> This should help with situations like the one Warpy brought up in <a href="/posts.php?topic=84689" target="_blank">this post</a>.<br><br>Previously, you could not cast from an Object to an Object[] if the array type was String (or if it was an array of arrays, incidentally).  However, both strings and arrays subclass Object, so it's a bit nonsensical that you couldn't cast an object for an array/String[] to an Object[].  So, with one extra line added, you can do that now.  It shouldn't cause any errors with existing code either, unless you relied upon the inability to cast from an Object that's a String[] to an Object[].<br><pre class=code>BBArray *bbArrayCastFromObject( BBObject *o,const char *type ){
	BBArray *arr=(BBArray*)o;
	if( arr==&amp;bbEmptyArray ) return arr;
	if( arr-&gt;clas!=&amp;bbArrayClass ) return (BBArray*)BBNULL;
	if( arr-&gt;type[0]==':' &amp;&amp; type[0]==':' ) return arr;
	if ( (arr-&gt;type[0]=='$' || arr-&gt;type[0]=='[' ) &amp;&amp; strcmp(type,":Object")==0 ) return arr;
	if( strcmp( arr-&gt;type,type ) &amp;&amp; strcmp( arr-&gt;type,":Object" ) ) return &amp;bbEmptyArray;
	return arr;
}</pre><br>This doesn't make casting work between all types of arrays, but at least it resolves one issue that's probably a tiny bit more common than the others. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
