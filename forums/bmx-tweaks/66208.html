<!DOCTYPE html><html lang="en" ><head ><title >Win32 : Proper Unicode support</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Win32 : Proper Unicode support</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=110" >BlitzMax Module Tweaks</a>/<a href="#bottom" >Win32 : Proper Unicode support</a><br><br>
<a name="739818"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> It turns out that MaxGUI on Windows doesn't support Unicode/UTF-8 properly on a lot of the gadgets.<br><br>After having a rummage through the code, MSDN, and with some assistance from Google, I've come up with a possible fix.<br><br>I've tested it with my Localization app, and the native languages appear correctly now in ListBoxes and ComboBoxes -  something they didn't before.<br><br>It'll probably need some more testing, if anyone is interested????, as it only took an hour and a half to hack the code into its present shape - and likely I've missed stuff.<br><br>Rather than post all the changes here, since I had to edit nearly ALL the files in the win32gui folder... I've uploaded the "tweaked" win32gui module <a href="http://brucey.net/programming/blitz/modules/tweaks/win32maxgui.unicode.zip" target="_blank"> HERE</a> (380k).<br><br>Essentially, what I've done is set a pre-processor variable UNICODE, which changes all the string internals to use WCHAR instead of char in calls to the API.<br>Therefore, anywhere which uses a string, or calls cstr(), etc, needed changed to use bbStringToWString() and such like.<br><br>And by George... it seems work...<br><br>;o)<br><br><br>Disclaimer: As stated above, I might have missed something, so beware. If you do find some text not working as expected, please let me know.<br><br><b>Edit</b>: The only thing I don't know about, is what versions of Windows are *not* Unicode friendly? Cuz I doubt this would work too well on those versions. Since I only have access to Win2k, it's not a problem for me. <br><br></td></tr></table><br>
<a name="739835"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Brucey, <a href="/posts.php?topic=64596" target="_blank">see here</a> for a beta of new win32maxgui module which you may have missed that is pure bmx implementation of win32maxgui using unicode.<br><br>Win98 needs a unicows.dll to be loaded for unicode apps, it is not freely distributable, although I think you only need to implement a disclaimer of some sorts to keep Microsoft happy, hence the conservative just implement unicode in the textarea if not win98 approach in the current version of win32maxgui. The next optimization I was going to try for the win32 textarea was cache the contents in rtf, which even less amusing is ascii with stupid long sequences for unicode characters. <br><br></td></tr></table><br>
<a name="739882"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi skid :-)<br><br>I've been watching that thread, but I was thinking it's maybe a bit too cutting edge for what I was playing with. That and my Win32 time is limited to squeezing in between "real" work ;-)<br><br>However, I'll have a go and see how I get on with it.<br><br>I'm happy, however, with the way this gui hack is, since it lets my windows build work in exactly the same way as the GTK and OS X builds. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
