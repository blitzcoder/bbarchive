<!DOCTYPE html><html lang="en" ><head ><title >LUA for BlitzMax v1.0</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >LUA for BlitzMax v1.0</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=110" >BlitzMax Module Tweaks</a>/<a href="#bottom" >LUA for BlitzMax v1.0</a><br><br>
<a name="467585"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TommyBear</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi everyone,<br><br>Until the lua modules become part of the pub modules in BMX, here is place to get the modules and samples<br><br><a href="http://www.tomkatgames.com/publicfiles/luamodules.zip" target="_blank">http://www.tomkatgames.com/publicfiles/luamodules.zip</a><br><a href="http://www.tomkatgames.com/publicfiles/luasamples.zip" target="_blank">http://www.tomkatgames.com/publicfiles/luasamples.zip</a><br><br>Extract the modules into your pub.mod folder<br>Extract the samples into your samples folder<br><br>Lua for BMX is for Win32, MacOS and Linux.  You must do a build of your modules before you try to compile the samples.<br><br>Tommy. <br><br></td></tr></table><br>
<a name="467626"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >flaith</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi, i tried to compile modules and pb :<br><br>Building Modules<br>Compiling:blitz_app.c<br>G:\BlitzMAX\Win32\BlitzMaxBeta101\mod\brl.mod\blitz.mod\blitz_app.c: In function `bbReadStdin':<br>G:\BlitzMAX\Win32\BlitzMaxBeta101\mod\brl.mod\blitz.mod\blitz_app.c:31: error: assignment of read-only location<br>Build Error: failed to compile G:/BlitzMAX/Win32/BlitzMaxBeta101/mod/brl.mod/blitz.mod/blitz_app.c<br>Process complete <br><br></td></tr></table><br>
<a name="467627"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Perturbatio</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> right click your Blitzmax folder, choose properties, make sure Read only is not ticked, if it is, untick it and apply it to all subfolders as well. <br><br></td></tr></table><br>
<a name="467629"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TommyBear</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey flaith did that fix it? <br><br></td></tr></table><br>
<a name="467630"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >flaith</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> already made, and it was not selected :( <br><br></td></tr></table><br>
<a name="467631"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TommyBear</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry what was made?  What was not selected? <br><br></td></tr></table><br>
<a name="467636"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >flaith</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> I checked the BlitzMax directory, read only wasn't ticked <br><br></td></tr></table><br>
<a name="467639"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TommyBear</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Okay so if you remove or rename the lua related module folders do yuo still get this error? <br><br></td></tr></table><br>
<a name="467643"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >flaith</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> i made another synchro from the web server (i changed mod's dir to another name).<br>i made build modules, still the same error !!!<br>what's your gcc version (mine : 3.4.2-20040916-1) ? <br><br></td></tr></table><br>
<a name="467656"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TommyBear</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> My GCC version is 3.2.3.<br><br>If you delete the lua based modules.. ie lua.mod and luascript.mod and compile your modules (with quick compile disabled, don't do a sync) and you still get this error, then it is something else and not the modules that are the problem.<br><br>Maybe you've hit a bug???  hmmmmmmm <br><br></td></tr></table><br>
<a name="467661"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >flaith</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> agreed !<br>Thank you for your answers, i'm going to create a new topic now !!! :) <br><br></td></tr></table><br>
<a name="467663"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TommyBear</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes... I think I might hold off doing a sync on my win32 box :) <br><br></td></tr></table><br>
<a name="467669"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >flaith</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> yes, i seen it, your zlib mod ... back to previous ! <br><br></td></tr></table><br>
<a name="467702"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >flaith</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok it work only after compiling it with a command line under a DOS Window :<br><br><pre class=code>
bmk makemods -r pub.lua
bmk makemods -r pub.luascript
bmk makemods -r pub.zlib
bmk makemods -r pub.zipengine
</pre> <br><br></td></tr></table><br>
<a name="473633"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dirk Krause</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> works fine here on XP.<br><br>Great work! <br><br></td></tr></table><br>
<a name="473675"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Murilo</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry for my noobish ignorance, but what is LUA? I've never heard of it... <br><br></td></tr></table><br>
<a name="473685"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >N</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> www.lua.org<br><br>Lua is a scripting language, basically.  For the full deal, read the About section of their website, or this quote:<br><br><div class="quote"> Lua is a powerful light-weight programming language designed for extending applications. Lua is also frequently used as a general-purpose, stand-alone language. Lua is free software.<br><br>Lua combines simple procedural syntax with powerful data description constructs based on associative arrays and extensible semantics. Lua is dynamically typed, interpreted from bytecodes, and has automatic memory management with garbage collection, making it ideal for configuration, scripting, and rapid prototyping.<br><br>A fundamental concept in the design of Lua is to provide meta-mechanisms for implementing features, instead of providing a host of features directly in the language. For example, although Lua is not a pure object-oriented language, it does provide meta-mechanisms for implementing classes and inheritance. Lua's meta-mechanisms bring an economy of concepts and keep the language small, while allowing the semantics to be extended in unconventional ways. Extensible semantics is a distinguishing feature of Lua.<br><br>Lua is a language engine that you can embed into your application. This means that, besides syntax and semantics, Lua has an API that allows the application to exchange data with Lua programs and also to extend Lua with C functions. In this sense, Lua can be regarded as a language framework for building domain-specific languages.<br><br>Lua is implemented as a small library of C functions, written in ANSI C, and compiles unmodified in all known platforms. The implementation goals are simplicity, efficiency, portability, and low embedding cost. The result is a fast language engine with small footprint, making it ideal in embedded systems too.  <br></div> <br><br></td></tr></table><br>
<a name="473720"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Murilo</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Noel. <br><br></td></tr></table><br>
<a name="473723"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bot Builder</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah, its also used alot when making evolving programs, In other words you declare a fitness goal, and generate random programs, evaluate them against this goal, mate the most successful ones, and repeast :).  It works pretty well.<br><br>Pretty cool, tommybear <br><br></td></tr></table><br>
<a name="474352"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AntonyWells</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey Tommy, just wondering how the ode module is coming along? <br><br></td></tr></table><br>
<a name="474485"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SSS</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> my blitzmax file is locked on readonly??? when i uncheck it it checks back next time i check the properties, does anyone know how to fix this? <br><br></td></tr></table><br>
<a name="474604"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >N</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> Tommy: I'm curious, why did you leave out the lua_rawset(), lua_next(), and lua_error()?  These functions are very important.  Rawset for declaring global functions, next for traversing tables, and error for the obvious.<br><br>Anyhow, I added these myself.  Also, istable() doesn't work properly- you have to recreate the macro in BlitzMax:<br><br><pre class=code>
Function lua_istable:Int(lua_state:Byte Ptr, index:Int)
	Return (lua_type(lua_state,index) = LUA_TTABLE)
End Function
</pre><br><br>Straight port.<br><br>Thanks for the awesome implementation, by the way- I don't use your ScriptEngine class, but it's proven to be an excellent thing to base mine on, concept-wise.  Now my engine has Lua bindings. :) <br><br></td></tr></table><br>
<a name="475479"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Russell</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> So LUA is a language within a language? What types of applications would you use it for?<br><br>Russell <br><br></td></tr></table><br>
<a name="475603"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >bruZard</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> scripting for games? <br><br></td></tr></table><br>
<a name="475638"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TommyBear</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>Tommy: I'm curious, why did you leave out the lua_rawset(), lua_next(), and lua_error()? These functions are very important. Rawset for declaring global functions, next for traversing tables, and error for the obvious.<br><br>Anyhow, I added these myself. Also, istable() doesn't work properly- you have to recreate the macro in BlitzMax:<br><br>Function lua_istable:Int(lua_state:Byte Ptr, index:Int)<br>	Return (lua_type(lua_state,index) = LUA_TTABLE)<br>End Function<br><br> <br><br><br>Straight port.<br><br>Thanks for the awesome implementation, by the way- I don't use your ScriptEngine class, but it's proven to be an excellent thing to base mine on, concept-wise. Now my engine has Lua bindings. :)<br> <br></div><br><br>Lazy/not enough time is the answer! :p  Been very busy at my work and we have a tight schedule for release...  I meant to implement that next but just didn't have the time.  Those are good and needed additions.  So if you want to take the reigns go for it for now, please do so... Just make sure you leave the copyright intact and add your own to it name to it.<br><br>cya!<br><br>Tommy. <br><br></td></tr></table><br>
<a name="475639"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TommyBear</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br> Hey Tommy, just wondering how the ode module is coming along?<br> <br></div><br><br>Oh that little nugget.  When and If I get time soon I'll start looking at it again.  If people want I'll release the source as it stands to somebody else to complete<br><br>Tommy. <br><br></td></tr></table><br>
<a name="486541"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >teamonkey</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just dredging this thread up from the dead.<br><br>Does anyone know how I would go about passing an object to Lua and back?<br><br>I was thinking something like this:<br><pre class=code>
' Call a Lua function and pass it a reference to the calling object
Local ob:MyObject = New MyObject
lua_pushlightuserdata(L, Varptr(ob))

' Lua calles a BMX function and passes it the reference to the object
Local ob:MyObject Ptr = MyObject Ptr(lua_touserdata(L, 1))</pre><br>But naturally that doesn't work :)<br><br>Anyone know the correct way to do it? <br><br></td></tr></table><br>
<a name="486925"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AntonyWells</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah you can team monkey, I pass objects to and from lua scripts without problems.(eventually ;) )<br><br>Basically, you have to think of it procedurely.<br><br>I.e,<br><br>Function Test:MyObj()<br>    return New MyObj<br>end function<br><br>IntHandle = Test()<br><br>get an int handle to the object using a function(there's no direct way of doing this I know of, please lemme know if you find one)<br>and then push it on return.(Don't just return it..when returning to a lua script you're passing the number of pars returned.<br><br>Use, 	luaObject.returnnumbertolua(ls, ObjectINTHandle )<br><br>to pass it to the script.<br><br>LS = the byte ptr you declared in the function.<br><br><pre class=code>
Function MakeCam:Int(ls:Byte Ptr)
	Cam = cCam()
	ListAddLast CamList,Cam
	rifas.returnNumberToLua( ls,cam) 'notice ls declared in function header, it's shared par space I think.
	Return 1 'How many pars you're returning.
End Function
</pre><br><br>for example.<br>--<br><br><div class="quote"> <br>If people want I'll release the source as it stands to somebody else to complete<br> <br></div><br><br>If it's as well wrote as the lua one I'll gladly *try* to finish it off. I may not be as succesfull though :) <br><br></td></tr></table><br>
<a name="486966"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >teamonkey</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ahh, so that's how you use the index handle thing. I could convert objects to handles, but I couldn't figure out how to get them back.<br><br>I now have:<br><pre class=code>
Type GameObject
	Method getSelf:GameObject()
		Return Self
	End Method

	Function getObj:GameObject(obj:GameObject)
		Return obj
	End Function
End Type

obj:GameObject = New GameObject

idx:Int = obj.getSelf()    ' Turns object into a handle

obj2:GameObject = GameObject.getObj(idx) ' Turns handle into an object
</pre><br><br>Thanks Antony. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
