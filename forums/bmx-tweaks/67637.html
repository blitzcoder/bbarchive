<!DOCTYPE html><html lang="en" ><head ><title >New audio stuff IV</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >New audio stuff IV</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=110" >BlitzMax Module Tweaks</a>/<a href="#bottom" >New audio stuff IV</a><br><br>
<a name="755635"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >marksibly</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br><br>PLEASE READ ENTIRE POST!!!!!!<br><br>Ok, final-ish release of the new audio stuff: syncmods for the latest.<br><br>Changes:<br><br>Each audio module (freeaudioaudio, directsoundaudio, openalaudio) now includes an 'auto detect' driver with the same name as the module.<br><br>For example, if you:<br><br>Import BRL.OpenALAudio<br><br>...then an "OpenAL" audio driver becomes available...<br><br>SetAudioDriver "OpenAL".<br><br>This driver attempts to work out the best 'sub driver' to use and should work in 99.99% of situations. If you're really paranoid you can still call AudioDrivers() to return a full list of drivers.<br><br>This should greatly simplify "Select Audio Driver" menus, eg:<br><pre class=code>
Strict

Repeat
	Print "Select Audio Driver:"
	Print "1) FreeAudio"
	Print "2) OpenAL"
?Win32
	Print "3) DirectSound"
?
	Local n
	Select Input( "&gt;" )
	Case 1 n=SetAudioDriver( "FreeAudio" )
	Case 2 n=SetAudioDriver( "OpenAL" )
?Win32
	Case 3 n=SetAudioDriver( "DirectSound" )
?
	End Select
	If n Exit
Forever
</pre><br><br>If SetAudioDriver() fails, the audio driver is now set to "Null", so make sure to check the result.<br><br>If SetAudioDriver() is never executed, the default audio driver is still "FreeAudio".<br><br>The second paramter of LoadSound is now a set of flags with the following values:<br><br>SOUND_LOOP=1<br>SOUND_HARDWARE=2<br><br>SOUND_HARDWARE attempts to place the sound into audio hardware memory, and should be used for frequently played, shortish sounds - not recommended for music.<br><br>This currently only affects DirectSound (which on XP has problems cleanly changing the pitch of software sounds) but is a good future proofing step as OpenAL supports hardware sounds too, and eventually we can add SOUND_3D etc.<br><br>You will still need to call EnableOpenALAudio() if you want to receive the full list of OpenAL drivers back from AudioDrivers(). However, you don't need to do this if you're just using the auto detect driver - ie: SetAudioDriver "OpenAL".<br><br>***** IMPORANT *****<br>Could anyone who was previously getting crashes in OpenALAudio when it was trying to enumerate devices please confirm whether or not 'EnableOpenALAudio' now crashes or not.<br>*******************<br><br>OpenAL appears to work OK on the Mac - but so does FreeAudio so I personally would stick with that for now!<br><br>10.4 has OpenAL preinstalled (yay!), but on 10.3 you will need to install the OpenAL framework:<br><br><a href="http://developer.creative.com/articles/article.asp?cat=1&amp;sbcat=31&amp;top=38&amp;aid=97" target="_blank">http://developer.creative.com/articles/article.asp?cat=1&amp;sbcat=31&amp;top=38&amp;aid=97</a><br><br>OpenAL on Linux doesn't seem to work well at all. I had to rebuild it from scratch to get it working, and even then it has serious lag issues.<br><br>Note that we've been having some problems with syncmods lately. If you're having trouble rebuilding  modules or linking an app due to missing symbols, I recommend reinstalling the 1.24 update over your current BlitzMax and syncing modules again.<br><br>Finally, thanks to REDi for the OpenAL module docs! <br><br></td></tr></table><br>
<a name="755722"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gavin Beard</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> wow, great work mark, thanks alot. sync'd down perfectly :-) <br><br></td></tr></table><br>
<a name="756689"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I thought Vista got rid of DirectSound? <br><br></td></tr></table><br>
<a name="756843"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JazzieB</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> It got rid of the HAL side of DirectSound.  It still exists, but the mixing is now all done in software instead of hardware, and then sent via OpenAL.  Basically, it's now emulated for backwards compatibility sake. <br><br></td></tr></table><br>
<a name="763236"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I just tested my game in Vista (didn't have my dev stuff as it wasn't my PC).<br><br>FreeAudio had the notorious 1-second lag.<br><br>DirectSound didn't play diddly squat. :/<br><br>Must look into this and get it tested again.  Its a bit crap that my dev PC and the PC with Vista on are half a mile apart. <br><br></td></tr></table><br>
<a name="764510"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >The Caffeine Kid</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just released my game (Super Obliteration) and some people have reported that the music doesn't play - just a "ticking" sound.<br><br>The normal sound effects (short sounds) are working but not the tunes, which are 1.x meg ogg files.<br><br>But there is no other way of doing it is there? <br><br></td></tr></table><br>
<a name="771964"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tachyon</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Why does Linux default for "FreeAudio OpenSound System" instead of plain "FreeAudio"? On my Linux system regular "FreeAudio" doesn't even work. This discrepancy breaks my initialization routine between PC/Mac/Linux. <br><br></td></tr></table><br>
<a name="772788"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, I've spent most of today trying to get "dynamic audio" working on linux... using that TSynth example of Skids from a while back.<br><br>After debugging just about everything (yes, really), I tracked down the problem to two areas.<br><br>in <b>freeaudioglue.cpp</b> fa_CreateSound(), to enable it requires the loop param to be set to 0x80000000.<br>Which is fine, except that you cannot then "loop" it at the same time.<br>If loop isn't set to that, the samples data is copied into new memory, and you no longer have access to it - to change it on the fly.<br><br>However, the function that calls fa_CreateSound(), in <b>freeaudioaudio.bmx</b> CreateSound(),  never sets the "loop_flag" to anything other than -1 (if at all).<br><br>For now, I've hacked my version to pass "flags" through, enabling me to use that "dynamic" audio thingy.<br><br>It actually works really well once you get past these problems.<br><br>Is there any chance of some "official" support for dynamic audio? Please :-) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
