<!DOCTYPE html><html lang="en" ><head ><title >pub.lua</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >pub.lua</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=110" >BlitzMax Module Tweaks</a>/<a href="#bottom" >pub.lua</a><br><br>
<a name="704597"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rozek</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hello!<br><br>Since I'm using Lua a lot from within BlitzMax (and currently constructing Lua interfaces for many of the BlitzMax modules), I just wanted to let you know that I've considerably modified and extended the axe.lua module (yielding a "pub.lua" module not to break other code which still uses axe.lua)<br><br>The main idea was to support the official Lua API as completely as possible.<br><br>You are free to use it - and probably replace axe.lua with it if you find that useful.<br><br>As I'm still new to BlitzMax, it's the .bmx file which is available for download only. For the time being, you'll have to build the module yourself (unless somebody instructs me how to deploy the module (cross-platform) over the BlitzMax servers)<br><br>I've tested pub.lua under WinXP and MacOSX, but not Linux (yet)<br><br>The .bmx file is available under<br><br>  <a href="http://www.Andreas-Rozek.de/BlitzMax/lua.bmx" target="_blank">http://www.Andreas-Rozek.de/BlitzMax/lua.bmx</a><br><br>Any feedback (positive or negative) is welcome. <br><br></td></tr></table><br>
<a name="704610"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> LUA was originally pub and then moved to AXE.<br>Reason is, it is not officially supported and only official BRL supported modules should reside within BRL and PUB modservers. Simply reason is: without framework anything from BRL and PUB is automatically imported thus 3rd party definitely shouldn't be in PUB. <br><br></td></tr></table><br>
<a name="704987"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rozek</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oops,<br><br>so I did the worst I could do...Well, anyway, as it's not automatically synchronized, it's probably not dangerous in the moment.<br><br>Should any "experimental" module go to AXE? Or is there another namespace for experimental modules? <br><br></td></tr></table><br>
<a name="705444"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> AXE is skidracers modserver<br>For your own experiments you can simply create a new one.<br>You can have an "unlimited" amount of mod/someFolder.mod/yourmod.mod folders <br><br></td></tr></table><br>
<a name="712681"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Diordna</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> What's better about this one than axe.lua? <br><br></td></tr></table><br>
<a name="717566"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is there any documentation, or perhaps a few simple samples? I'd like to get into scripting, but I don't have a clue where to start. <br><br></td></tr></table><br>
<a name="717578"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, lua core has links to the lua manuals, and lua script engine includes a small example, use program-&gt;document modules if you can't see them in the navbar under help-&gt;modules.<br><br>luascript is kindof out of date, the correct way to initialize the engine is to call luaL_openlibs(state) which will call the other lua_open functions itself. <br><br></td></tr></table><br>
<a name="717597"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I guess I'm not really sure where everything fits in. There's axe.lua ( core ) and there's pub.lua ( core ) and there's also axe.luascript, do I need both Lua and LuaScript, or are they just different implementations of the same functionality?<br><br>I'm ok from the LUA side, it's just figuring out where all the different modules fit in, how they're different, which I need, whether one is more powerful or another is easier to use. <br><br></td></tr></table><br>
<a name="717602"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> pub.lua??? <br><br>axe.luascript is a "friendly" wrapper for axe.lua which is the raw lua library. <br><br></td></tr></table><br>
<a name="717603"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> That'd be the one that Rozek made, as a modification of Noel's modification of.. I get lost after that. It's a modification of Axe.Lua anyway. It's considerably modified and extended apparently. <br><br></td></tr></table><br>
<a name="743390"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rozek</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hello!<br><br>Sorry for the long "silence" - I've been occupied by other activities for quite a while...<br><br>Back to BlitzMAX/MaxGUI and Lua: the main idea of my extensions to the axe.lua interface was to add as many of the missing Lua API calls as possible.<br><br>You now get almost any API call you can find in the official Lua 5.1.1 documentation.<br><br>The very few missing ones have not been implemented due to variable argument lists (I don't know how to describe them in BlitzMAX) and some callback functions. Everything else should be there.<br><br>The link can be found a few posts upwards in this thread. As I don't yet know where to send my code for an official inclusion into the BlitzMAX environment I just publish it privately.<br><br>Concerning examples etc.: I'm currently writing Lua interfaces to a majority of BlitzMAX/MaxGUI functions in order to create a (rather) complete runtime environment for Lua scripts.<br><br>As a result, you may write your applications in Lua and use BlitzMAX/MaxGUI as a multi-platform runtime environment.<br><br>BlitzMAX/MaxGUI interfaces and Lua examples should be ready by the beginning of February 2007. <br><br></td></tr></table><br>
<a name="743988"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> As I don't yet know where to send my code for an official inclusion into the BlitzMAX environment I just publish it privately. <br></div><br><br>Hi Rozek, please send to to me in future any modifications (email in profile) I'll try and update axe.lua with your latest version today.<br><br>Your current project sounds really interesting! <br><br></td></tr></table><br>
<a name="748819"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>Concerning examples etc.: I'm currently writing Lua interfaces to a majority of BlitzMAX/MaxGUI functions in order to create a (rather) complete runtime environment for Lua scripts.<br><br>As a result, you may write your applications in Lua and use BlitzMAX/MaxGUI as a multi-platform runtime environment.<br><br>BlitzMAX/MaxGUI interfaces and Lua examples should be ready by the beginning of February 2007. <br> <br></div><br>This sounds great. It would ( presumably ) give us a good basis to learn how to do the same for own modules? <br><br></td></tr></table><br>
<a name="754058"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Barbapapa</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Any news about Lua? I am missing some official statements. <br><br></td></tr></table><br>
<a name="754099"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oops, axe.lua may have reverted back to earlier version, try another syncmods (windows) for version 1.22 which has additional stuff by Andreas Rozek added. <br><br></td></tr></table><br>
<a name="754123"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Barbapapa</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> ahh, I thought so, cool will do. What about axe.LuaScript, is this depreciated? I lost several hours with axe.Luascript trying to execute a lua file with a simple print statement until I realized that I had written it with a capital P(rint) instead of print ;) bad me... <br><br></td></tr></table><br>
<a name="760037"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rozek</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hello!<br><br>Just to keep you informed: due to several other activities (and an "influenza"), my work on the Lua interfaces has been delayed a bit. But I'm still working on them trying to release the stuff before end of march.<br><br>Sorry for the delay... <br><br></td></tr></table><br>
<a name="760055"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Barbapapa</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Influenza? You too? seems half Germany has been contaminated 8-]<br>What are your future additions to LUA btw? <br><br></td></tr></table><br>
<a name="763547"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rozek</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Indeed, it seems to have begun in the south and then expanded to the north - but it's over now<br><br>Concerning my planned extensions: first, I'll provide LUA interfaces for many (probably most or even all) BlitzMAX functions - letting Lua programmers use the functionality provided by BlitzMAX modules in their programs. The emphasis is on "functions" as I won't provide any interface for any BlitzMAX (user defined) type. This is not really a problem as - luckily - the modules always provide functions which take such an object as their first parameter (very similar to the Lua approach) I'm currently implementing the last number of modules, thus, you may expect a first release within the next week.<br><br>If that approach turns out to be useful and stable, I'll implement Lua "classes" and "objects" as loose counterparts of BlitzMAX types in order to simplify programming.<br><br>My primary intent is to provide a "framework" for cross-platform graphical user interfaces scripted in Lua - with additional file system and networking support. <br><br></td></tr></table><br>
<a name="764674"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sounds great, looking forward to it. <br><br></td></tr></table><br>
<a name="764818"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rozek</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just to keep you informed:<br><br>the interfaces have been coded - I'm testing now. For those, who can't wait for the first "official" release I could provide the current code "as-is" (but keep in mind: I expect numerous errors and might even have to change some of my methods to interface Lua and BlitzMAX)<br><br>However, my first experiments with MaxGUI from Lua already look very promising... <br><br></td></tr></table><br>
<a name="764819"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rozek</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> what I forgot:<br><br>if everything works well, I plan to release the interfaces within a week from now - hopefully together with some Lua "classes", which make scripting a lot easier, and together with several examples. <br><br></td></tr></table><br>
<a name="764828"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rozek</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just to give you a *very* first impression:<br><br>this is the screenshot of a *very first* programming example - together with the code used to produce it.<br><br><img src="http://www.Andreas-Rozek.de/BlitzMax/ForumResources/MaxGUI_00.gif"><br><br><pre class=code>
blitzmax.import(brl.event);
blitzmax.import(brl.eventqueue);
blitzmax.import(brl.maxgui);
blitzmax.import(brl.pixmap);

--------------------------------------------------------------------------------
-- loadGuiFont                    Platform-independent "loadGuiFont" function --
--------------------------------------------------------------------------------

  function loadGuiFont(FontName, FontSize, isBold, isItalic, isUnderlined)
    if (blitzmax.Platform ~= "Win32") then
      FontSize = math.floor(FontSize * 1.32);
    end;
    return brl.maxgui.loadGuiFont(FontName, FontSize, isBold, isItalic, isUnderlined);
  end;

--******************************************************************************
--*                                                                            *
--*                                Main Program                                *
--*                                                                            *
--******************************************************************************

--**** provide a few application-specific definitions ****

  local Title    = "MaxGUI_00";
  local Subtitle = "very first experiments with MaxGUI and Lua";

--**** load some application-specific images ****

  local Icon = loadPixmap("Lua-Logo.png");
--  Icon = maskPixmap(Icon, 212,208,200);    -- does not work
  if (Icon == nil) then error("unable to load 'Lua-Logo.png'"); end;

  local sunkenLine = loadPixmap("sunkenLine.png");
  if (sunkenLine == nil) then error("unable to load 'sunkenLine.png'"); end;

--**** load any application-specific fonts ****

  local TitleFont    = loadGuiFont("Arial", 12, true, true, false);
  local SubtitleFont = loadGuiFont("Arial",  9, true, false,false);
  local TextFont     = loadGuiFont("Arial",  8, false,false,false);
  local BoldFont     = loadGuiFont("Arial",  8, true, false,false);
  if (TitleFont == nil) or (SubtitleFont == nil) or (TextFont == nil) or (BoldFont == nil) then
    error("unable to load all requested fonts");
  end;

--**** setup the application window ****

  local Window = createWindow(Title.." - "..Subtitle, 20,20, 320,240, nil,
    WINDOW_TITLEBAR + WINDOW_RESIZABLE + WINDOW_CLIENTCOORDS); -- + WINDOW_STATUS);
    setMinWindowSize(Window, 320,240);

    local IconView = createPanel(2,4, 32,32, Window);
      setPanelPixmap (IconView, Icon, PANELPIXMAP_CENTER);
      setGadgetLayout(IconView, EDGE_ALIGNED,0,EDGE_ALIGNED,0);
    local TitleLabel = createLabel(Title, 36,2, 282,18, Window, LABEL_RIGHT);
      setGadgetFont  (TitleLabel,TitleFont);
      setGadgetLayout(TitleLabel, 0,EDGE_ALIGNED,EDGE_ALIGNED,0);
    local SubtitleLabel = createLabel(Subtitle, 36,22, 282,16, Window, LABEL_RIGHT);
      setGadgetFont  (SubtitleLabel,SubtitleFont);
      setGadgetLayout(SubtitleLabel, 0,EDGE_ALIGNED,EDGE_ALIGNED,0);
    local UpperSeparator = createPanel(2,40, 316,2, Window);
      setPanelPixmap (UpperSeparator, sunkenLine, PANELPIXMAP_TILE);
      setGadgetLayout(UpperSeparator, EDGE_ALIGNED,EDGE_ALIGNED,EDGE_ALIGNED,0);
    local ClientArea = createTextArea(2,44, 316,174, Window, TEXTAREA_READONLY);
      setGadgetLayout(ClientArea, EDGE_ALIGNED,EDGE_ALIGNED,EDGE_ALIGNED,EDGE_ALIGNED);
      setGadgetColor (ClientArea, 128,128,128, true)
    local LowerSeparator = createPanel(2,220, 316,2, Window);
      setPanelPixmap (LowerSeparator, sunkenLine, PANELPIXMAP_TILE);
      setGadgetLayout(LowerSeparator, EDGE_ALIGNED,EDGE_ALIGNED,0,EDGE_ALIGNED);
    local Statusbar = createLabel("(no special action required)", 2,224, 316,18, Window);
      setGadgetFont  (Statusbar,TextFont);
      setGadgetLayout(Statusbar, EDGE_ALIGNED,EDGE_ALIGNED,0,EDGE_ALIGNED);
--  setStatusText(Window, "(no special action required)");
  showGadget(Window);

--**** handle any incoming events... ****

  while true do
    waitEvent();
    if (EventId() == EVENT_WINDOWCLOSE) then break; end;
  end;
</pre> <br><br></td></tr></table><br>
<a name="764872"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rozek</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just another screenshot - TextAreas seem to work...<br><br><img src="http://www.Andreas-Rozek.de/BlitzMax/ForumResources/MaxGUI_01.gif"> <br><br></td></tr></table><br>
<a name="764918"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Barbapapa</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'll try to describe it in many words: wonderfull! <br><br></td></tr></table><br>
<a name="766809"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rozek</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just to keep you informed:<br><br>here is a very first screenshot of the MaxGUI_01 application shown above - running under MacOSX!<br><br><img src="http://www.andreas-rozek.de/BlitzMax/ForumResources/MaxGUI_01_MacOSX.png"><br><br>It does not yet look nice (the classical font problems together with some ".bmp" display issues) - but I'll work on it in order to let you really write cross-platform Lua programs!<br><br>--EDIT: the snapshot has changed since this posting has been issued, the initial font and BMP probems are thus no longer visible. In fact, the MacOSX version is now the best-looking one!<br><br>Hmmm, now (I think) I'll also have to try all that stuff under Linux ;-) <br><br></td></tr></table><br>
<a name="766915"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rozek</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> Et voilà,<br><br>here it is - the *very* first screenshot of MaxGUI_00 under Linux (unfortunately, MaxGUI_01 just crashes)<br><br><img src="http://www.andreas-rozek.de/BlitzMax/ForumResources/MaxGUI_00_Linux.png"><br><br>From what you can see in the screenshot, the Linux version still needs a lot of fine tuning! (sigh) <br><br></td></tr></table><br>
<a name="766944"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rozek</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> Apart from the screenshots:<br><br>I've meanwhile also added an interface for MiniB3D and am now "objectifying" all interfaces such that you can use "objects" and "methods" under Lua rather than having to deal with the BlitzMax functions (and object "handles") yourself. The resulting (Lua) code will become much smaller and easier to handle.<br><br>Additionally, I'll try to hide some of the cross-platform issues inside these "objects"<br><br>Stay tuned! <br><br></td></tr></table><br>
<a name="768139"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rozek</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just to keep you informed:<br><br>a few days ago, I discovered LogicGUI (a visual form editor for MaxGUI) which writes BlitzMax code in a form, which may easily be converted into Lua. I wrote a (quick-and-dirty) converter which gives you a Lua basis, which may then be extended with proper event handling.<br><br>Here is a screenshot of another little program, which I "hacked together" in a few minutes in the context of another <a href="/posts.php?topic=68656#768133" target="_blank"> Forum thread</a>:<br><br><img src="http://www.andreas-rozek.de/BlitzMax/ForumResources/PixmapAlphaTest.png"><br><br>The corresponding source code as produced by the converter (and after editing the Windows-specific file paths, though):<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
blitzmax.import(brl.event);
blitzmax.import(brl.eventqueue);
blitzmax.import(brl.maxgui);
blitzmax.import(brl.pixmap);

  local MainWindow = createWindow("PixmapAlphaTest - are PNGs &amp; GIFs with Alpha Channel supported?", 364, 36, 320, 210, nil, WINDOW_TITLEBAR + WINDOW_RESIZABLE + WINDOW_CLIENTCOORDS)
      setStatusText(MainWindow, "(no special action required)")
    local BMPView = createPanel(27, 54, 32, 32, MainWindow, Null, "")
    local Pixmap_BMPView = loadPixmap("BlitzMAX-Logo_32x32.bmp")
      setPanelPixmap(BMPView, Pixmap_BMPView, 1)
      setGadgetLayout(BMPView, EDGE_ALIGNED, EDGE_CENTERED, EDGE_ALIGNED, EDGE_CENTERED)
    local UpperSeparator = createPanel(2, 40, 316, 2, MainWindow, PANEL_BORDER, "")
    local Pixmap_UpperSeparator = loadPixmap("sunkenLine.bmp")
      setPanelPixmap(UpperSeparator, Pixmap_UpperSeparator, 0)
    local IconView = createPanel(2, 4, 32, 32, MainWindow, PANEL_ACTIVE, "")
    local Pixmap_IconView = loadPixmap("BlitzMax-Logo_32x32.bmp")
      setPanelPixmap(IconView, Pixmap_IconView, 1)
      setGadgetLayout(IconView, EDGE_ALIGNED, EDGE_CENTERED, EDGE_ALIGNED, EDGE_CENTERED)
    local TitleLabel = createLabel("PixmapAlphaTest", 36, 2, 282, 18, MainWindow, LABEL_RIGHT)
      setGadgetLayout(TitleLabel, EDGE_CENTERED, EDGE_ALIGNED, EDGE_ALIGNED, EDGE_CENTERED)
    local Font_TitleLabel = loadGuiFont("Arial", 12, true, true, false)
      setGadgetFont(TitleLabel, Font_TitleLabel)
    local SubtitleLabel = createLabel("are PNGs &amp; GIFs with Alpha Channel supported?", 36, 22, 282, 16, MainWindow, LABEL_RIGHT)
      setGadgetLayout(SubtitleLabel, EDGE_CENTERED, EDGE_ALIGNED, EDGE_ALIGNED, EDGE_CENTERED)
    local Font_SubtitleLabel = loadGuiFont("Arial", 9, true, false, false)
      setGadgetFont(SubtitleLabel, Font_SubtitleLabel)
    local LowerSeparator = createPanel(2, 185, 316, 2, MainWindow, PANEL_BORDER, "")
    local Pixmap_LowerSeparator = loadPixmap("sunkenLine.png")
      setPanelPixmap(LowerSeparator, Pixmap_LowerSeparator, 0)
      setGadgetLayout(LowerSeparator, EDGE_ALIGNED, EDGE_ALIGNED, EDGE_CENTERED, EDGE_ALIGNED)
    local Statusbar = createLabel("(no special action required)", 2, 189, 316, 18, MainWindow, Null)
      setGadgetLayout(Statusbar, EDGE_ALIGNED, EDGE_ALIGNED, EDGE_CENTERED, EDGE_ALIGNED)
    local Font_Statusbar = loadGuiFont("Arial", 8, false, false, false)
      setGadgetFont(Statusbar, Font_Statusbar)
    local BMPLabel = createLabel("BlitzMax-Logo.bmp - no transparency", 75, 62, 235, 23, MainWindow, Null)
    local Font_BMPLabel = loadGuiFont("Arial", 9, true, false, false)
      setGadgetFont(BMPLabel, Font_BMPLabel)
    local GIFView = createPanel(27, 98, 32, 32, MainWindow, Null, "")
    local Pixmap_GIFView = loadPixmap("BlitzMAX-Logo_32x32.gif")
      setPanelPixmap(GIFView, Pixmap_GIFView, 1)
      setGadgetLayout(GIFView, EDGE_ALIGNED, EDGE_CENTERED, EDGE_ALIGNED, EDGE_CENTERED)
    local GIFLabel = createLabel("BlitzMax-Logo.gif - with transparency", 75, 106, 235, 23, MainWindow, Null)
    local Font_GIFLabel = loadGuiFont("Arial", 9, true, false, false)
      setGadgetFont(GIFLabel, Font_GIFLabel)
    local PNGView = createPanel(27, 142, 32, 32, MainWindow, Null, "")
    local Pixmap_PNGView = loadPixmap("BlitzMAX-Logo_32x32.png")
      setPanelPixmap(PNGView, Pixmap_PNGView, 1)
      setGadgetLayout(PNGView, EDGE_ALIGNED, EDGE_CENTERED, EDGE_ALIGNED, EDGE_CENTERED)
    local PNGLabel = createLabel("BlitzMax-Logo.png - with alpha channel", 75, 150, 235, 23, MainWindow, Null)
    local Font_PNGLabel = loadGuiFont("Arial", 9, true, false, false)
      setGadgetFont(PNGLabel, Font_PNGLabel)

--**** handle any incoming events... ****

  while true do
    waitEvent();
    if (EventId() == WindowClose) then break; end;
  end;
</textarea><br><br>I'll now try to test all MaxGUI gadgets and then release my BlitzMax runtime environment for Lua - together with LogicGUI (which is *not* part of my environment!) and my converter you will then already be able to construct simple Lua applications with a graphical user interface... <br><br></td></tr></table><br>
<a name="769492"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rozek</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just for your information:<br><br>the author's modified version of axe.lua now also contains some documentation (see <a href="/posts.php?topic=68845" target="_blank">this thread</a>) <br><br></td></tr></table><br>
<a name="770923"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#31">[#31]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is there a bare bones example of using Lua from BlitzMax ( rather than BlitzMax from Lua ) around anywhere? I think there used to be a couple of tutorials on the Wiki, but that seems to be down at the moment. I was pretty sure that initial function was to call Lua_Open() but I can't even find a function with that name in this module any more, so I'm thinking my memory might be tricking me. <br><br></td></tr></table><br>
<a name="771119"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rozek</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#32">[#32]</a></td></tr></table></td></tr><tr ><td class="posttext"> Good morning!<br><br>There are just a few minutes left before I'll have to wake up my family - let's see, how much I'll be able to write down:<br><pre class=code>
    local LuaState:byte ptr = luaL_newstate()
</pre><br>creates a new variale which contains the full state of a Lua VM - you could also say, it starts the Lua interpreter.<br><pre class=code>
    luaL_openlibs(LuaState)
</pre><br>opens and initializes the standard Lua libraries - which is what you usually want. You should really be a Lua expert if you plan to do without them.<br><pre class=code>
  lua_register(LuaState, "luaname",  BMXName)
</pre><br>registers a BlitzMax function (called "BMXName") with the name "luaname" under Lua.<br><pre class=code>
  function BMXName:int (LuaState:Byte Ptr)
    ...
    return 0 ' number of values returned to Lua
  end function
</pre><br>This is the frame of a BlitzMax function which may be invoked from within Lua - I don't want to talk about stack handling here right now (no time in the moment)<br><pre class=code>
    lua_pushstring(LuaState, "BMXString")
    lua_setglobal (LuaState, "luaglobal")
</pre><br>defines a global Lua variable (called luaglobal) which contains a string (namely "BMXString") - this is just to give you at least one example of how to use the stack-based Lua API functions.<br><pre class=code>
    local Result:int = luaL_loadString(LuaState,LuaScript)
    if (Result &lt;&gt; 0) then
      ' ERROR!!!
      lua_close(LuaState)                                  ' just to be complete
      end
    end if
</pre><br>loads and compiles a (BlitzMax) string containing a LuaScript. The result (of compilation) is left on the (Lua) stack.<br><pre class=code>
    lua_getfield(LuaState, LUA_GLOBALSINDEX, "debug")       ' get global "debug"
    lua_getfield(LuaState, -1,           "traceback")    ' get "debug.traceback"
    lua_remove  (LuaState, -2)                 ' remove "debug" table from stack

    Result = lua_pcall(LuaState,1,-1,-1)' use "debug.traceback" as error handler
    if (Result &lt;&gt; 0) then
      ' ERROR
      lua_close(LuaState)                                  ' just to be complete
      end
    end if
</pre><br>actually evaluates the previously loaded script. The initially mentioned Lua commands just prepare for proper error messages should the Lua script fail.<br><pre class=code>
    lua_close(LuaState)                                    ' just to be complete
</pre><br>terminates the Lua interpreter and invalidates the Lua state variable.<br><br>Let that be enough for now - I could sit down and write a "Lua from within BlitzMAX" tutorial, but not in the moment (please wait two weeks, I really want to finish my BlitzMax interface for Lua first)<br><br>So far for now (family is waiting) <br><br></td></tr></table><br>
<a name="771229"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ratchet</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#33">[#33]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br>if you're making a BMX-LUA interface you should make it in "Lua-Style". What I mean is: All Lua functions are sorted by catergory. Every category has a own table including the functions. For exsample<br><br><pre class=code>s = string.gsub(str, "^%l", string.upper)
math.abs(-100)</pre><br><br>That's why I love Lua. Everything is logical sorted. Please, do not mess up Lua and store your functions into tables. Something like<br><br><pre class=code>gui.waitevent()</pre><br><br>This would be more clearer. <br><br></td></tr></table><br>
<a name="771490"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rozek</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#34">[#34]</a></td></tr></table></td></tr><tr ><td class="posttext"> ;-)<br><br>This has already done: all BlitzMAX functions are in tables named after their modules, e.g. <br><pre class=code>
  brl.eventqueue.waitEvent();
</pre><br>This makes it easy for BlitzMAX programmers to become familiar with the Lua interface. If you don't like the table prefix, you may "import" a (BlitzMAX module) table, making all its functions global (as shown in the above example)...<br><br>Additionally, I also have Lua "objects", which are loosely modelled after their BlitzMax counterparts and provide object-based access to BlitzMax functions. The GUI part, however, already has automatic layouting capabilities and an interface similar to that of TkLua. <br><br></td></tr></table><br>
<a name="771494"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ratchet</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#35">[#35]</a></td></tr></table></td></tr><tr ><td class="posttext"> *Thumbs up* <br><br></td></tr></table><br>
<a name="771572"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#36">[#36]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks heaps for the tutorial, Rozek. That was more than enough to get me started. I've read the two online books and I've ordered a paper book, but it was just the starting point that was giving me trouble ( I think I was reading a tutorial which covered Lua 4.0 which didn't help ) and I think I'll be fine now that I've got your explanations and examples. <br><br></td></tr></table><br>
<a name="771602"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rozek</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#37">[#37]</a></td></tr></table></td></tr><tr ><td class="posttext"> Gabriel,<br><br>as usual: as soon as one has understood the underlying concept, everything else becomes quite simple (provided that it has been designed in a systematic way)<br><br>Good luck for your work! <br><br></td></tr></table><br>
<a name="776299"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#38">[#38]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Andreas,<br><br>I'm having some problems with Lua_ToInteger when sending a number from Lua to BMax. I get a completely incorrect number ( it's 14344644 or something ) when I send a number. If I use Lua_ToNumber() I get the correct number, and if use Lua_ToString() I get the right number ( albeit, as a string ) but Lua_ToInteger returns the wrong value. Any ideas why?<br><br>EDIT: I'm looking at the source, and perhaps I'm reading it wrong, but it seems that this function in C++ is actually returning a 32bit number, not a 64bit number. Could this be the problem? I tried recompiling it with an int instead but it just returned 0 instead of the correct number, so either there's more to it than that or I'm barking up the wrong tree entirely here. <br><br></td></tr></table><br>
<a name="776347"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rozek</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#39">[#39]</a></td></tr></table></td></tr><tr ><td class="posttext"> Gabriel,<br><br>I'll check that. Right now, I have only 15 minutes left before waking up my family. Thus, I may only be able to work on your problem in a few hours (after having returned from the kindergarden)<br><br>Update: I had a few minutes and found that it is indeed the discrepancy between int and long which causes that problem. I'll correct this in approx. 2 hours<br><br>By the way, I just looked into my code and found, that I always use lua_tonumber and then convert the result into an int within BlitzMAX myself. Main reason for that detour is the possibility of range checking prior to the type conversion...<br><br>However, lua_tointeger (et al.) has to behave properly as well, of course <br><br></td></tr></table><br>
<a name="776598"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#40">[#40]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Andreas. Using Lua_ToNumber and converting to an int seems like a good idea actually. Lua_ToInteger seems to be a relatively recent addition to Lua ( I noticed for example that they have not implemented a matching Lua_IsInteger ) so quite possibly Lua_ToNumber and then a typecast ( referred to as coersion, in Lua, I believe ) to int is the recommended way to go. It works fine for what I'm doing right now anyway. Thanks again. <br><br></td></tr></table><br>
<a name="776764"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rozek</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#41">[#41]</a></td></tr></table></td></tr><tr ><td class="posttext"> Gabriel,<br><br>I've corrected the bug you've found and published the new version of axe.lua (see the corresponding thread, I think it's time to close this one ;-) ) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
