<!DOCTYPE html><html lang="en" ><head ><title >ZipEngine 2.0 for BlitzMax</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >ZipEngine 2.0 for BlitzMax</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=110" >BlitzMax Module Tweaks</a>/<a href="#bottom" >ZipEngine 2.0 for BlitzMax</a><br><br>
<a name="556834"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gman</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> just want to thank TommyBear again for starting this module up. <br><br>all furture info and downloads regarding this module have been moved to the <a href="http://www.gprogs.com/forum" target="_blank">gprogs.com</a> forum. <br><br></td></tr></table><br>
<a name="556893"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just woke up and saw ir... :)<br><br>Thanks a lot.... testing in progress!<br><br>edit: <br>Ok, all seems running well. Especially like the debug info u added... :)<br><br>Some small stuff in case u touch this again:<br>+ give the zip a versionno. "20", so we know what we download<br>+ add a small readme: general info + commandset + changelog <br><br></td></tr></table><br>
<a name="557154"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Red</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> So cool.<br>Bmax mod would be boring wihtout mod coding :) <br><br></td></tr></table><br>
<a name="557278"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >boomboommax</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> can you add the ability to extract a zip to a folder without knowing the files inside? <br><br></td></tr></table><br>
<a name="558461"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tibit</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is it possible to only zip a string? How big does a file have to be for zip to be useful? <br><br></td></tr></table><br>
<a name="558479"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Wave: <br><br>1. <br>Not sure what exactly you want to do?! But sure, you can simply write a textfile with Strings and afterwards compress it.<br><br>2.<br>It depends on your program structure. In general I would advise not to zip hundreds of small files or single strings in seperate files, as the access time to get a file and decompress it can get low with tons of files and you won't gain a benefit from that.<br><br>So what I mostly do is to subdivide my media into main parts. E.g. STATIC DATA, IMAGES, SOUNDS, SAVEGAMES. <br><br></td></tr></table><br>
<a name="558568"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tibit</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> I meant, Can I zip a string in memory and then write it to a file or something else like a network package.<br><br>The smaller the String the faster is shoud take to zip/unzip it so this might be a good idea for file transfers. It would also mean free encryption. <br><br></td></tr></table><br>
<a name="558739"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> It is currently possible to extract a hard disc file to system ram. And to load media from there.<br><br>fileBuffer = zrObject.ExtractFile(f$)<br><br>But I doubt there are commands in for compressing a ram buffer yet.<br><br>Perhaps GMAN could help? :)<br>*takes cover behind a sofa* <br><br></td></tr></table><br>
<a name="558773"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gman</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> @{cYanide} - although i didnt wrap it up, i did add the capability to loop through all the files in the zip.  you should be able to leverage this to do an ExtractAll() type method.  see the unzip example for the looping.  whenever i get to an update of this i will add and extract all.<br><br>@Wave - i will see if i can take a look into this.  it will be a day or two. <br><br></td></tr></table><br>
<a name="558792"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gman</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Wave - turns out that ZLib is exactly what you are looking for.  compressing and decompressing memory.  i whipped up an example for you:<br><pre class=code>
' memcomptest.bmx

Strict
Framework BRL.Basic
Import Pub.ZLib

' compression levels
Const Z_NO_COMPRESSION:Int=         0
Const Z_BEST_SPEED:Int=             1
Const Z_BEST_COMPRESSION:Int=       9
Const Z_DEFAULT_COMPRESSION:Int=   -1

' im not sure how you would guess the size for the buffer.
' i guess you just make it big and hope for the best.
Const BUFFER_LEN:Int=1024

' create a string to compress
Local test:String="this is my string.  it would be really really groovy if i could compress"+Chr(10)+ ..
	" this String And Then decompress it without loss."

' compression test

' allocate a buffer
Local buffer:Byte Ptr=MemAlloc(BUFFER_LEN)
Local bufferlen:Int=BUFFER_LEN

' compress the string
compress2(buffer,bufferlen,test.ToCString(),test.length,Z_BEST_COMPRESSION)
Local compressed:String=String.FromBytes(buffer,bufferlen)

' show the resulting reduction %
Local pct:Int=100-Int((Float(compressed.length)/Float(test.length))*100)

DebugLog("")
DebugLog("---")
DebugLog("original string len: "+test.length)
DebugLog("compressed string len: "+compressed.length)
DebugLog("string was reduced by: "+pct+"%")

' decompression test

' reset the buffer length to maximum
bufferlen=BUFFER_LEN

' uncompress the string
uncompress(buffer,bufferlen,compressed.ToCString(),compressed.length)

Local uncompressed:String=String.FromBytes(buffer,bufferlen)

DebugLog("---")
DebugLog("")
DebugLog("original: "+test)
DebugLog("---")
DebugLog("compressed: "+compressed)
DebugLog("---")
DebugLog("uncomp: "+uncompressed)

' free up the buffer
MemFree(buffer,BUFFER_LEN)
</pre> <br><br></td></tr></table><br>
<a name="558830"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tibit</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Cool! I'll take a closer look at this tonight! <br><br></td></tr></table><br>
<a name="558850"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gman</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> heres a neat thought.  TZLibStream...  based on TStream but compresses and decompresses on the fly as you read and write.  you could then use it wherever streams are used.  not sure about implementation but i think its feasable.  i might take a look into this. <br><br></td></tr></table><br>
<a name="558882"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sounds all very complicated. I don't care as long as it works... :D <br><br></td></tr></table><br>
<a name="559018"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tibit</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Streams are not that complicated really, you can extend the stream class pretty easy I think. Do you have any special use for zip-streams in mind?<br><br>Don't have time to look this through today, tomorrow.. <br><br></td></tr></table><br>
<a name="559062"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gman</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>Streams are not that complicated really, you can extend the stream class pretty easy I think. Do you have any special use for zip-streams in mind?<br> <br></div><br>not for me really, but when you mentioned sending ZLib compressed strings around in a networking package i thought about streams since they are usually the communication path.  having a compression stream would allow transparent comp/decomp of send and receive data. <br><br></td></tr></table><br>
<a name="559068"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hotcakes</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> That would rock gman. <br><br></td></tr></table><br>
<a name="559139"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Would this also be possible:<br>You have some imagehandles in memory and you want to zip them.<br>So instead of writing them onto disc and compress them afterwards. You compress them in memory and only write the zip? <br><br></td></tr></table><br>
<a name="559198"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gman</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Grisu - if you could get the images into a TRamStream or somehow get at the bytes in ram then yes, you could zip something in ram directly to the zip file without having it actually be a physical file.  if its in a TRamStream a simple change to the zipengine would be all thats needed.  it would probably be a good thing to have anyway so i will put that in next time i update. <br><br></td></tr></table><br>
<a name="559239"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> :D <br><br>Call it Zip 3.0 :))))))) <br><br></td></tr></table><br>
<a name="567643"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TommyBear</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> Awesome work gman!  Nice to see the community alive and well.  Sorry I haven't been able to help out lately.  I'm very busy on Tomb Raider 7 at the moment ;) <br><br></td></tr></table><br>
<a name="592629"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> Can someone please make this to work with BMX 1.12???? <br><br></td></tr></table><br>
<a name="593113"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gman</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> updated :) <br><br></td></tr></table><br>
<a name="593504"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Gman! I own you one more virtual pot of coffee... :) <br><br></td></tr></table><br>
<a name="593979"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Lomat</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> gman, any chance you could add this to the BlitzMax Wiki? <br><br></td></tr></table><br>
<a name="594078"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hummelpups</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hehe, cool mod<br><br>IMurDOOM <br><br></td></tr></table><br>
<a name="601556"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> Gman, with bmx1.14 I'm getting new compiling errors... :(<br><br>"Compile Error: Expecting string literal but encountered malformed string literal"<br><br>=&gt; zipengine.bmx - moduleinfo line 5 <br><br>:/<br><br>Also when you use DEBUGMODE, and open many zips after each other. The program crashes without any error message.<br>Else all seems fine? <br><br></td></tr></table><br>
<a name="601643"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rimmsy</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> "Compile Error: Expecting string literal but encountered malformed string literal" <br></div>This usually means there was a ~ in there somewhere which you'll have to replace with ~~ because of a change in the way escape characters work. I think. Not sure about the second error. <br><br></td></tr></table><br>
<a name="601654"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> There is no ~ in the hole source code as far as I can see.<br><br>And the other bug is caused by the new garbage collector, I would bet my green socks on this! <br><br></td></tr></table><br>
<a name="601699"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gman</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> ill try to take a look at this somtime today or tomorrow.   busy on updating the Irrlicht mods ATM. <br><br></td></tr></table><br>
<a name="601727"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> Great! Thank you! <br><br></td></tr></table><br>
<a name="602427"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gman</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#31">[#31]</a></td></tr></table></td></tr><tr ><td class="posttext"> k.  the first issue was quick to resolve.<br><br>@Grisu - can you provide a quick sample to reproduce the crash?<br><br>thx. <br><br></td></tr></table><br>
<a name="602429"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#32">[#32]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is it already updated? (2.02)?!? I would test it again then!<br><br>Example is difficult, but I can e-mail you my project.<br>It isn't that big! (easy source). But data is (280 MB)... :(<br>And it is crashing cause of zip handling! :(<br><br>P.S.: <br>Do you use ICQ? Can I email you around 12 MB?<br>Need to get this fixed before xmas... :) <br><br></td></tr></table><br>
<a name="602454"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gman</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#33">[#33]</a></td></tr></table></td></tr><tr ><td class="posttext"> the current build is available above.  really didnt do anything but fix the first issue and rebuild though...  but, given the philosophy of "fix what you know first", lets see what happens. <br><br></td></tr></table><br>
<a name="602469"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#34">[#34]</a></td></tr></table></td></tr><tr ><td class="posttext"> It rebuilds without an error now!<br><br>Though it still crashes for me. :/ <br><br></td></tr></table><br>
<a name="602960"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#35">[#35]</a></td></tr></table></td></tr><tr ><td class="posttext"> You've got mail... :) <br><br></td></tr></table><br>
<a name="603516"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gman</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#36">[#36]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Grisu - there is a new version for download.  i think i have the issue resolved finally. <br><br></td></tr></table><br>
<a name="604105"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#37">[#37]</a></td></tr></table></td></tr><tr ><td class="posttext"> Issue resolved! :D <br><br></td></tr></table><br>
<a name="606001"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TommyBear</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#38">[#38]</a></td></tr></table></td></tr><tr ><td class="posttext"> Found a bug, the readFileList() function is being called when using the ZipWriter class to create a new zip.  To reproduce this, call OpenZip on a zipWriter instance with a zip that does not exist and it will generate a runtime error with"TZipReader.scanLocalHeader(): unable to read from file"<br><br>A way around this is to comment out readFileList() from OpenZip in zipWriter and AddFile too. <br><br></td></tr></table><br>
<a name="606016"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gman</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#39">[#39]</a></td></tr></table></td></tr><tr ><td class="posttext"> thx for the update TB.  fixed and new version available for download (at the top). <br><br></td></tr></table><br>
<a name="606806"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#40">[#40]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks!<br><br>btw Gman: <br>Is there a way to speed up file seeking in zips?<br><br>As I already know the filenames inside each zip,<br>is there a way to "pre-cache" this info when the app starts up first time? <br><br></td></tr></table><br>
<a name="606893"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gman</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#41">[#41]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>Is there a way to speed up file seeking in zips?<br> <br></div><br>not that i know of.  all the seeking and reading is done through the ZLib functions.  essentially you call a function to position the internal pointer to the file you want to extract, and then you call the extract function.  one thing you could do is track the currently open month or year (however your ZIPs are organzied) and just keep the current one open until the next one is needed.  <br><br>something i could do in ZipEngine is add a way to work with the ZIP files without loading the header info.  the bigger performance would probably be gained though by keeping the current zip open until the next is needed. <br><br></td></tr></table><br>
<a name="606902"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#42">[#42]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yepp, my guess the constant open / closing files is eating up the performance.<br><br>Would be great if you could add commands that would make it possible to access an "open" zip. So I only open / close the files when the year selector changes.<br><br>You see a lot of slowdown if the app runs from cd-rom.<br>So every tweak would be nice. :) <br><br></td></tr></table><br>
<a name="606908"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gman</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#43">[#43]</a></td></tr></table></td></tr><tr ><td class="posttext"> since your zip object is already global, i think its possible now with a little reworking of your function that calls the open/close zip.  see your email :) <br><br></td></tr></table><br>
<a name="607172"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chris C</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#44">[#44]</a></td></tr></table></td></tr><tr ><td class="posttext"> is it possible to directly load an image/texture/sound from a zip/ram stream ? <br><br></td></tr></table><br>
<a name="607272"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#45">[#45]</a></td></tr></table></td></tr><tr ><td class="posttext"> yepp. <br><br>The way it works: <br>1. You extract data from a zip to a stream <br>2. Loadimage etc this stream to be used with bmx<br><br>If I have understood you correctly... <br><br></td></tr></table><br>
<a name="607388"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gman</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#46">[#46]</a></td></tr></table></td></tr><tr ><td class="posttext"> Grisu is correct.  use the ExtractFile() method to get an instance of a TRamStream.  pass this into the LoadImage() function. <br><br></td></tr></table><br>
<a name="607412"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TommyBear</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#47">[#47]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks gman! :) <br><br></td></tr></table><br>
<a name="608070"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gman</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#48">[#48]</a></td></tr></table></td></tr><tr ><td class="posttext"> glad i could help :)  thx for the initial effort TB! <br><br></td></tr></table><br>
<a name="608193"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chris C</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#49">[#49]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> use the ExtractFile() method to get an instance of a TRamStream. pass this into the LoadImage() function. <br></div><br>thats real powerful...<br><br>Things like this real show the potential of max! <br><br></td></tr></table><br>
<a name="610785"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#50">[#50]</a></td></tr></table></td></tr><tr ><td class="posttext"> Btw, is there a way to count how many files are in a certain zip file? <br><br></td></tr></table><br>
<a name="610788"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gman</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#51">[#51]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Grisu - sure is.  getFileCount() method.  should work on instances of both reader and writer. <br><br></td></tr></table><br>
<a name="610857"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Russell</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#52">[#52]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nice!<br><br>Good work, fellas! I hope Mark can incorporate this into the next update, as it seems to be fairly solid (and quite useful).<br><br>Russell<br><br>p.s. Unrelated, but the newest version of the free Blender 3D model/animate/render program just came out, and it has a very impressive list of features. Check it out! www.blender.org <br><br></td></tr></table><br>
<a name="610907"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#53">[#53]</a></td></tr></table></td></tr><tr ><td class="posttext"> GetFileCount() worked. :)<br><br>But I think I have found a small issue with that:<br>The method counts the folders inside a zip as files as well! <br><br></td></tr></table><br>
<a name="626946"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gavin Beard</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#54">[#54]</a></td></tr></table></td></tr><tr ><td class="posttext"> Dont suppose this module does/will work under linux at all? i get an error saying bmax cant find interface pub.zipengine<br><br>EDIT* after successful recompile of mods it works ok, thx <br><br></td></tr></table><br>
<a name="638983"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#55">[#55]</a></td></tr></table></td></tr><tr ><td class="posttext"> Note: Tested with bmx 1.18 and working... <br><br></td></tr></table><br>
<a name="640264"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Regular K</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#56">[#56]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sadly, it isn't working for me :( Nothing has been working for me in 1.18<br><br>I get this error "Can't find interface for module 'pub.zipengine'".<br><br>And if I try to build the module I get "Module does not match commandline module"<br><br>Sounds like I placed the module incorrectly, but its under pub.mod, it worked fine in 1.14. <br><br></td></tr></table><br>
<a name="640277"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#57">[#57]</a></td></tr></table></td></tr><tr ><td class="posttext"> The error "modules does not ..." means that you try to build and run the module like a regular code file which does not work.<br><br>to build it you must use the "Build modules" options. <br><br></td></tr></table><br>
<a name="640282"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Regular K</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#58">[#58]</a></td></tr></table></td></tr><tr ><td class="posttext"> I got it to work after some tinkering (Build Modules would fail while compiling win32listbox so I just removed the MaxGUI modules and then built) <br><br></td></tr></table><br>
<a name="640289"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gman</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#59">[#59]</a></td></tr></table></td></tr><tr ><td class="posttext"> FYI, i put a 1.18 built version out in my forums:<br><br><a href="http://www.gprogs.com/forum/viewtopic.php?pid=72" target="_blank">http://www.gprogs.com/forum/viewtopic.php?pid=72</a> <br><br></td></tr></table><br>
<a name="648354"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Lomat</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#60">[#60]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm having a small issue with the ZipEngine module (blitzmax 1.18). <br><br>When adding files to a zip archive i sometimes get a...<br><br>"TZipReader.scanLocalHeader(): unable to read from file"<br><br>runtime error. I have looked around and it does not relate to any specific file being added to the zip archive. It seems to be almost at random as sometimes the files get added without issue.<br><br>I created a small test script to try to narrow down the issue and i still get the same problem, sometimes i get the error othertimes it completes without issue. However in my test script if i put a delay() into the script then the error is 100% reproduceable.<br><br>Also the getFileCount() method always seems to return 0 when creating a new zip archive.<br><br>With the above issues it seems that the root of the problem is probably with the call to readFileList() in the ZipWriter.AddFile() method, however I dont have the ming stuff installed on my current machine so am unable to modify and rebuild the module myself to investigate further at the moment.<br><br>The test script is as follows...<br><br><pre class=code>
SuperStrict
'
' You need an icons directory with files in.
'
Import PUB.ZipEngine

Local zw:ZipWriter = New ZipWriter
zw.OpenZip(AppDir$ + "/test.zip", False)

Local dh:Int = ReadDir("icons")
Repeat
	Local file:String = NextFile(dh)
	If file = "" Then
		Exit
	End If
	If file[..1] &lt;&gt; "." Then
		Local fileName:String = "icons/" + file
		If FileType(fileName) = 1 Then 
			Print("Adding " + fileName)
			zw.AddFile(fileName)
			Print("zip file count " + zw.getFileCount())
		End If
	End If
	Delay(300)
Forever

zw.CloseZip()
zw = Null
</pre> <br><br></td></tr></table><br>
<a name="681501"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#61">[#61]</a></td></tr></table></td></tr><tr ><td class="posttext"> @GMan: <br>I noticed another small glitch in the module. <br><br>When I create a new zip and display the contents of the zip file via winrar or other professional programs, the time and date of the files is totally messed up. 00.00.1980,00:00 or a random date of 1958! - When extracting the files to the hdd, the time and date stamp is back ok though?<br><br>I can live with that, but if you know how to fix that issue, that would be awesome too. :) <br><br></td></tr></table><br>
<a name="686629"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gman</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#62">[#62]</a></td></tr></table></td></tr><tr ><td class="posttext"> thx for the bug reports.  v2.05 is ready for download.<br><br><a href="http://www.gprogs.com/forum/viewtopic.php?pid=72" target="_blank">http://www.gprogs.com/forum/viewtopic.php?pid=72</a><br><br>i fixed both the added files count problem and the no datetime for added files issues.<br><br>enjoy :) <br><br></td></tr></table><br>
<a name="687086"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#63">[#63]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks! <br><br></td></tr></table><br>
<a name="697723"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#64">[#64]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for putting this together. <br><br></td></tr></table><br>
<a name="716811"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gman</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#65">[#65]</a></td></tr></table></td></tr><tr ><td class="posttext"> v2.06 is ready for download.<br><br>www.gprogs.com/forum/viewtopic.php?pid=72<br><br>i added an AddStream() method to the zipwriter to allow writing a stream to the zip.<br><br>also, please note there is now an RSS feed available in the ZipEngine forum description. <br><br></td></tr></table><br>
<a name="717419"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >North</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#66">[#66]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks a bunch! <br><br></td></tr></table><br>
<a name="717434"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Space_guy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#67">[#67]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sounds very usefull :) ill be using this functionality sometime in the future im sure. <br><br></td></tr></table><br>
<a name="717567"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#68">[#68]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's great, thanks so much for adding this! <br><br></td></tr></table><br>
<a name="717898"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#69">[#69]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks. <br><br>Could you explain what the advantage of AddStream() is? Example? <br><br></td></tr></table><br>
<a name="795157"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#70">[#70]</a></td></tr></table></td></tr><tr ><td class="posttext"> Can you please change the mod folder to gman.mod?  You should not use pub.mod, because the contents will be deleted every time you sync mods. <br><br></td></tr></table><br>
<a name="805151"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#71">[#71]</a></td></tr></table></td></tr><tr ><td class="posttext"> I sync mods every day and still the mod isn't deleted?<br><br>If you mean bmx updates. No need for that as bmx is seldom updated. The bmx 1.24 update is EIGHT MONTHS old. <br><br></td></tr></table><br>
<a name="918927"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >plash</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#72">[#72]</a></td></tr></table></td></tr><tr ><td class="posttext"> If a zip is opened with the append parameter does it overwrite existing files?<br><br>This wont work:<br><pre class=code>If zwriter.OpenZip("assets.zip", True) = True
	'Write stuff to stream (not shown)
	memstream.seek(0) 'Seek back
	zwriter.AddStream(memstream, "config")
End If</pre><br><br>Archive shows up as corrupt, and has *two* 'config' files in it.<br><br>EDIT: memstream is a TBankStream.<br>EDIT2: Closing the zip removed the corrupt error but there are still two files in the zip with the exact same name, is there a way to remove a file from a zip? (I don't see and functions/methods to do so in the module) <br><br></td></tr></table><br>
<a name="919017"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >plash</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#73">[#73]</a></td></tr></table></td></tr><tr ><td class="posttext"> Using APPEND_STATUS_ADDINZIP doesn't work either. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
